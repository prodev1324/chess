!function(t){function o(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,o),i.l=!0,i.exports}var e={};o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},o.p="",o(o.s=0)}([function(t,o,e){"use strict";var r=e(1);self.addEventListener("message",function(t){if(t.data&&t.data.game&&t.data.playAgainstAI){var o=(0,r.AI)(t.data.playAgainstAI.depth,t.data.game,!0);self.postMessage(o)}})},function(t,o,e){!function(o,e){t.exports=e()}("undefined"!=typeof self&&self,function(){return function(t){function o(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,o),i.l=!0,i.exports}var e={};return o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},o.p="",o(o.s=2)}([function(t,o,e){"use strict";function r(t){this.board=[];for(var o=0;o<8;o++){for(var e=[],r=0;r<8;r++)e.push(null);this.board.push(e)}this.turn=[],this.FEN=[],this.FENboard=[],this.threefold=[]}Object.defineProperty(o,"__esModule",{value:!0});var i=e(1);r.prototype.piece=function(t,o,e,r){var n=i.Piece[t](o,e,r,this);this.board[e][o]=n,this.FEN=this.gameToFEN(),this.FENboard=this.boardToFEN()},r.prototype.moveSelected=function(t,o,e,r,i){var n=o.x,a=o.y;if(t){var c={x:t.x,y:t.y};if(this.board[a][n]!==t){for(var u=t.getValidMoves(!i),s=null,l=0;l<u.length;l++){var p=u[l];if(p.x===n&&p.y===a){s=p;break}}if(!s)return!1;var f,h,y,v=s.movePiece;v&&(f=v.from,h=v.to,null===h?this.board[f.y][f.x]=null:(y=this.board[f.y][f.x],this.board[h.y][h.x]=y,y.x=h.x,y.y=h.y,this.board[f.y][f.x]=null));var d=this.board[a][n]?this.board[a][n]:null;v=v?s.movePiece:null,this.turn.push({from:c,to:o,color:t.color,type:t.type,piece:d,movePiece:v}),this.board[a][n]=t,this.board[t.y][t.x]=null,this.board[a][n].x=n,this.board[a][n].y=a,this.FEN=this.gameToFEN(),this.FENboard=this.boardToFEN(),this.threefold.push(this.FENboard),("pawn"===t.type||d)&&(this.threefold=[]),this.threefoldCheck()&&r("D"),this.halfmoveClock()>=50&&r("D"),"pawn"===t.type&&a!==t.y&&("W"===t.color&&0===a||"B"===t.color&&7===a)&&e&&e(t,n,a,t.color);var m="W"===t.color?"B":"W",g=this.checkmate(m);g&&r(g)}return t=null,!0}},r.prototype.promotePawn=function(t,o,e,r,i){this.piece(i,o,e,r)},r.prototype.simulateAndFilter=function(t,o){var e=[],r=this,i=this.board;return t.forEach(function(t,n){var a=t.y,c=t.x,u={x:o.x,y:o.y},s=i[a][c]?{piece:i[a][c],from:{x:c,y:a},to:null}:null;t.movePiece&&(s=t.movePiece),s&&r.simpleMovePiece(s.piece,s.from,s.to),r.simpleMovePiece(o,u,{x:c,y:a});var l=r.warning(o.color);r.simpleMovePiece(o,{x:c,y:a},u),s&&r.simpleMovePiece(s.piece,s.to,s.from),l||e.push(t)}),e},r.prototype.checkmate=function(t){for(var o=0;o<8;o++)for(var e=0;e<8;e++)if(this.board[o][e]&&this.board[o][e].color===t&&this.board[o][e].getValidMoves(!0).length)return!1;return this.warning(t)?t:"D"},r.prototype.simpleMovePiece=function(t,o,e){var r=this.board;e&&(r[e.y][e.x]=t,t.x=e.x,t.y=e.y),o&&(r[o.y][o.x]=null)},r.prototype.simpleMove=function(t){var o=this,e=o.board,r=t.from,i=t.to,n=e[r.y][r.x],a=this.board[i.y][i.x]?this.board[i.y][i.x]:null,c=e[i.y][i.x]?{piece:e[i.y][i.x],from:{x:i.x,y:i.y},to:null}:null;return this.turn.push({from:r,to:{x:i.x,y:i.y},color:t.color,type:n.type,piece:a,movePiece:c}),i.movePiece&&(c=i.movePiece),c&&o.simpleMovePiece(c.piece,c.from,c.to),o.simpleMovePiece(n,r,{x:i.x,y:i.y}),function(){c&&o.simpleMovePiece(c.piece,c.to,c.from),o.simpleMovePiece(n,{x:i.x,y:i.y},r),a&&(e[i.y][i.x]=a),o.turn.pop()}},r.prototype.warning=function(t){var o,e=!1;return this.board.forEach(function(e){e.forEach(function(e){e&&e.color===t&&"king"===e.type&&(o=e)})}),this.board.forEach(function(r){r.forEach(function(r){r&&r.color!==t&&r.getValidMoves().forEach(function(t){t.x===o.x&&t.y===o.y&&(e=!0)})})}),e},r.prototype.threefoldCheck=function(){for(var t=this.threefold,o=t.length,e=0;e<o;e++){for(var r=0,i=e+1;i<o;i++)t[e]===t[i]&&(r+=1);if(r>=2)return!0}return!1},r.prototype.pieceToAN=function(t,o){return"abcdefgh".charAt(t)+(8-o)},r.prototype.boardToFEN=function(){for(var t=this.board,o="",e=0,r=0;r<8;r++){for(var i=0;i<8;i++)t[r][i]?(e&&(o+=e),e=0,o+=t[r][i].FENname):e++;e&&(o+=e),e=0,o+=r<7?"/":""}return o},r.prototype.halfmoveClock=function(){var t=this.turn,o=t.length,e=0;if(0===t.length)return e;for(var r=t[o-1-e];e<=o-1&&"pawn"!==r.type&&!r.piece;)e++,r=t[o-1-e];return e},r.prototype.activeColour=function(){var t=this.turn;return t.length&&"W"===t[t.length-1].color?"b":"w"},r.prototype.castlingTarget=function(){var t,o,e=this.board,r=this.turn,i="";return r.forEach(function(e){t="king"===e.type&&"W"===e.color,o="king"===e.type&&"B"===e.color}),[[7,0],[0,0],[7,7],[0,7]].forEach(function(n){var a=n[0],c=n[1],u=e[c][a];if((7!==c||!t)&&(0!==c||!o)&&u&&"rook"!==!u.type&&!r.some(function(t){return"rook"===t.type&&(t.from.x===a&&t.from.y===c)})){var s=0===a?"q":"k";i+=0===c?s.toUpperCase():s}}),i||(i="-"),i},r.prototype.enPassantTarget=function(){var t=this.turn,o="";if(t.length){var e=t[t.length-1];"W"===e.color&&4===e.to.y&&(o=this.pieceToAN(e.to.x,e.to.y+1)),"B"===e.color&&3===e.to.y&&(o=this.pieceToAN(e.to.x,e.to.y-1))}return o||(o="-"),o},r.prototype.fullmoveCount=function(){var t=1;return this.turn.forEach(function(o){"B"===o.color&&(t+=1)}),t},r.prototype.gameToFEN=function(){var t="";return t+=this.boardToFEN(),t+=" "+this.activeColour(),t+=" "+this.castlingTarget(),t+=" "+this.enPassantTarget(),t+=" "+this.halfmoveClock(),t+=" "+this.fullmoveCount()},r.prototype.initializeGame=function(){for(var t=new r,o=0;o<8;o++)t.piece("pawn",o,6,"W"),t.piece("pawn",o,1,"B");return t.piece("rook",0,0,"B"),t.piece("knight",1,0,"B"),t.piece("bishop",2,0,"B"),t.piece("queen",3,0,"B"),t.piece("king",4,0,"B"),t.piece("bishop",5,0,"B"),t.piece("knight",6,0,"B"),t.piece("rook",7,0,"B"),t.piece("rook",0,7,"W"),t.piece("knight",1,7,"W"),t.piece("bishop",2,7,"W"),t.piece("queen",3,7,"W"),t.piece("king",4,7,"W"),t.piece("bishop",5,7,"W"),t.piece("knight",6,7,"W"),t.piece("rook",7,7,"W"),t},r.prototype.allMoves=function(){for(var t=this.board,o=[],e=this.activeColour().toUpperCase(),r=0;r<8;r++)for(var i=0;i<8;i++)if(t[r][i]&&t[r][i].color===e){var n=t[r][i].getValidMoves(!0);n.forEach(function(e){o.push({color:t[r][i].color,from:{x:i,y:r},to:e,FENname:t[r][i].FENname})})}return o},o.default=r},function(t,o,e){"use strict";function r(t,o,e,r,i,n){if(e&&(this.char=e[r]),this.color=r,this.x=t,this.y=o,this.game=i,this.type=n,n){var a="knight"===n?"n":n.charAt(0);"W"===this.color&&(a=a.toUpperCase()),this.FENname=a}}function i(t,o,e,i){r.call(this,t,o,l.pawn,e,i,"pawn")}function n(t,o,e,i){r.call(this,t,o,l.rook,e,i,"rook")}function a(t,o,e,i){r.call(this,t,o,l.knight,e,i,"knight")}function c(t,o,e,i){r.call(this,t,o,l.bishop,e,i,"bishop")}function u(t,o,e,i){r.call(this,t,o,l.queen,e,i,"queen")}function s(t,o,e,i){r.call(this,t,o,l.king,e,i,"king")}Object.defineProperty(o,"__esModule",{value:!0});var l=o.PIECE_CHARS={pawn:{W:"♙",B:"♟"},rook:{W:"♖",B:"♜"},knight:{W:"♘",B:"♞"},bishop:{W:"♗",B:"♝"},queen:{W:"♕",B:"♛"},king:{W:"♔",B:"♚"}};r.empty=function(){return new r},r.prototype.getValidMoves=function(){return[{x:0,y:0},{x:7,y:7}]},i.prototype=r.empty(),i.prototype.getValidMoves=function(t){var o,e,r=this.game,i=[],n=this.y,a=this.x,c=r.board,u=r.turn,s=u.length,l="W"===this.color?n-1:n+1,p="W"===this.color?n-2:n+2,f=(this.color,[a-1,a+1]);l<8&&l>=0&&!c[l][a]&&(i.push({x:a,y:l}),(1===n||6===n)&&p<8&&p>=0&&!r.board[p][a]&&i.push({x:a,y:p}));for(var h=0;h<2;h++)e=f[h],l<8&&l>=0&&c[l][e]&&c[l][e].color!==this.color&&i.push({x:e,y:l});for(var y=0;y<2;y++)e=f[y],!(o=u[s-1])||"pawn"!==o.type||o.to.x!==e||o.to.y!==n||o.color===this.color||1!==o.from.y&&6!==o.from.y||3!==n&&4!==n||i.push({x:e,y:l,movePiece:{piece:r.board[n][e],from:{x:e,y:n},to:null}});return t?r.simulateAndFilter(i,this):i},r.pawn=function(t,o,e,r){return new i(t,o,e,r)},n.prototype=r.empty(),n.prototype.getValidMoves=function(t){var o=this.game,e=[];[[-1,0],[1,0],[0,1],[0,-1]].forEach(function(t){var r,i,n,a;for(r=1;(i=this.x+t[0]*r,!((n=this.y+t[1]*r)<0||n>7||i<0||i>7))&&(!(a=o.board[n][i])||a.color!==this.color)&&(e.push({x:i,y:n}),!a);r++);},this);return t?o.simulateAndFilter(e,this):e},r.rook=function(t,o,e,r){return new n(t,o,e,r)},a.prototype=r.empty(),a.prototype.getValidMoves=function(t){for(var o,e,r=this.game,i=[],n=[[2,1],[-2,1],[1,2],[-1,2],[2,-1],[-2,-1],[1,-2],[-1,-2]],a=0;a<n.length;a++){var c,u=!1;o=n[a][0],e=n[a][1],this.x+o<8&&this.x+o>=0&&this.y+e<8&&this.y+e>=0&&(c=r.board[this.y+e][this.x+o],u=!c||c.color!==this.color),u&&i.push({x:this.x+o,y:this.y+e})}return t?r.simulateAndFilter(i,this):i},r.knight=function(t,o,e,r){return new a(t,o,e,r)},c.prototype=r.empty(),c.prototype.getValidMoves=function(t){var o=this.game,e=[];[[-1,-1],[1,1],[-1,1],[1,-1]].forEach(function(t){var r,i,n,a;for(r=1;(i=this.x+t[0]*r,!((n=this.y+t[1]*r)<0||n>7||i<0||i>7))&&(!(a=o.board[n][i])||a.color!==this.color)&&(e.push({x:i,y:n}),!a);r++);},this);return t?o.simulateAndFilter(e,this):e},r.bishop=function(t,o,e,r){return new c(t,o,e,r)},u.prototype=r.empty(),u.prototype.getValidMoves=function(t){var o=this.game,e=n.prototype.getValidMoves.call(this),r=c.prototype.getValidMoves.call(this),i=e.concat(r);return t?o.simulateAndFilter(i,this):i},r.queen=function(t,o,e,r){return new u(t,o,e,r)},s.prototype=r.empty(),s.prototype.getValidMoves=function(t){var o=[],e=[[0,1],[0,-1],[1,1],[-1,-1],[1,-1],[-1,1],[-1,0],[1,0]],r=this.x,i=this.y,n=this.game,a=n.turn,c=this;e.forEach(function(t){var e,a=r+t[0],u=i+t[1];a<8&&a>=0&&u<8&&u>=0&&((e=n.board[u][a])&&e.color===c.color||o.push({x:a,y:u}))}),a.some(function(t){return"king"===t.type&&t.color===c.color})||[[0,2,-1],[7,6,1]].forEach(function(t){var e=t[0],u=t[1],s=t[2],l=n.board[i][e];if(l&&"rook"!==!l.type&&!a.some(function(t){return t.from.x===e&&t.from.y===i})){for(var p=r+s;p!==e;p+=s){if(n.board[i][p])return;var f=!0;if(n.board.forEach(function(t){t.forEach(function(t){t&&"king"!==t.type&&t.color!==c.color&&t.getValidMoves().forEach(function(t){t&&t.y===i&&t.x===p&&(f=!1)})})}),!f)return}var h={x:u,y:i,movePiece:{piece:c.game.board[i][e],from:{x:e,y:i},to:{y:i,x:r+s}}};o.push(h)}});return t?n.simulateAndFilter(o,c):o},r.king=function(t,o,e,r){return new s(t,o,e,r)},o.Piece=r,o.Pawn=i,o.Rook=n,o.Knight=a,o.Bishop=c,o.Queen=u,o.King=s},function(t,o,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(o,"__esModule",{value:!0}),o.AI=o.Pieces=o.Game=void 0;var i=e(0),n=r(i),a=e(1),c=function(t){if(t&&t.__esModule)return t;var o={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e]);return o.default=t,o}(a),u=e(3),s=r(u);o.Game=n.default,o.Pieces=c,o.AI=s.default},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e(0),i=function(t){return t&&t.__esModule?t:{default:t}}(r),n=function(t,o,e){for(var r=i.default.prototype.initializeGame(),n=0;n<8;n++)for(var c=0;c<8;c++)if(o.board[n][c]){var u=o.board[n][c];r.piece(u.type,c,n,u.color)}else r.board[n][c]=null;r.turn=o.turn,r.threefold=o.threefold,r.FEN=o.FEN,r.FENboard=o.FENboard;for(var s,l=r.allMoves(),p=-9999,n=0;n<l.length;n++){var f=l[n],h=r.simpleMove(f),y=a(t-1,r,-1e4,1e4,!e);h(),y>=p&&(p=y,s=f)}return s},a=function t(o,e,r,i,n){if(0===o)return-c(e.board);var a=e.allMoves();if(n){for(var u=-9999,s=0;s<a.length;s++){var l=e.simpleMove(a[s]);if(u=Math.max(u,t(o-1,e,r,i,!n)),l(),r=Math.max(r,u),i<=r)return u}return u}for(var p=9999,f=0;f<a.length;f++){var h=e.simpleMove(a[f]);if(p=Math.min(p,t(o-1,e,r,i,!n)),h(),(i=Math.min(i,p))<=r)return p}return p},c=function(t){for(var o=0,e=0;e<8;e++)for(var r=0;r<8;r++)o+=u(t[e][r]);return o},u=function(t){if(null===t)return 0;var o=function(t){return"pawn"===t.type?10:"rook"===t.type?50:"knight"===t.type?30:"bishop"===t.type?30:"queen"===t.type?90:"king"===t.type?900:void 0}(t,t.color);return"W"===t.color?o:-o};o.default=n}])})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd29ya2VyLm1pbi5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgNzEwNDAyYzBkZDQwNjBjNmEwZGQiLCJ3ZWJwYWNrOi8vLy4vanMvd29ya2VyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9yc2ctY2hlc3MvbGliL2luZGV4LmpzIl0sIm5hbWVzIjpbIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJfcnNnQ2hlc3MiLCJzZWxmIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJkYXRhIiwiZ2FtZSIsInBsYXlBZ2FpbnN0QUkiLCJiZXN0TW92ZSIsIkFJIiwiZGVwdGgiLCJwb3N0TWVzc2FnZSIsInJvb3QiLCJmYWN0b3J5IiwiR2FtZSIsInByb21vQ2FsbGJhY2siLCJ0aGlzIiwiYm9hcmQiLCJhcnJheUluIiwiaiIsInB1c2giLCJ0dXJuIiwiRkVOIiwiRkVOYm9hcmQiLCJ0aHJlZWZvbGQiLCJ2YWx1ZSIsIl9waWVjZXMiLCJwaWVjZSIsInR5cGUiLCJ4IiwieSIsImNvbG9yIiwiUGllY2UiLCJnYW1lVG9GRU4iLCJib2FyZFRvRkVOIiwibW92ZVNlbGVjdGVkIiwic2VsZWN0ZWQiLCJ0byIsInByb21vdGlvbkNhbGxiYWNrIiwiY2hlY2ttYXRlQ2FsbGJhY2siLCJzaW11bGF0ZSIsImZyb20iLCJ2YWxpZE1vdmVzIiwiZ2V0VmFsaWRNb3ZlcyIsInZhbGlkTW92ZSIsImxlbmd0aCIsInZtIiwidGFrZSIsInBhc3RlIiwicm9vayIsIm1vdmVQaWVjZSIsInRocmVlZm9sZENoZWNrIiwiaGFsZm1vdmVDbG9jayIsImNoZWNrbWF0ZUNvbG9yIiwiY2hlY2ttYXRlVmFsdWUiLCJjaGVja21hdGUiLCJwcm9tb3RlUGF3biIsInBhd24iLCJzaW11bGF0ZUFuZEZpbHRlciIsIm1vdmVzIiwiZm9yRWFjaCIsIm1vdmUiLCJzaW1wbGVNb3ZlUGllY2UiLCJ3YXJuaW5nIiwic2ltcGxlTW92ZSIsImNhcHR1cmVkUGllY2UiLCJwb3AiLCJraW5nIiwicmVzdWx0IiwieXl5IiwieHh4IiwibW1tIiwiY291bnQiLCJwaWVjZVRvQU4iLCJjaGFyQXQiLCJtaXNzaW5nUGllY2VzIiwiRkVObmFtZSIsImV2IiwiYWN0aXZlQ29sb3VyIiwiY2FzdGxpbmdUYXJnZXQiLCJ3aGl0ZUtpbmdNb3ZlZCIsImJsYWNrS2luZ01vdmVkIiwicG9zc2libGVDYXN0bGluZyIsInByb3BzIiwicm9va1giLCJyb29rWSIsInNvbWUiLCJjYXN0bGluZ1NpZGUiLCJ0b1VwcGVyQ2FzZSIsImVuUGFzc2FudFRhcmdldCIsImZ1bGxtb3ZlQ291bnQiLCJpbml0aWFsaXplR2FtZSIsImRlZmF1bHRHYW1lIiwiYWxsTW92ZXMiLCJkZWZhdWx0IiwiY2hhckJhc2UiLCJjaGFyIiwiUGF3biIsIlBJRUNFX0NIQVJTIiwiUm9vayIsIktuaWdodCIsImtuaWdodCIsIkJpc2hvcCIsImJpc2hvcCIsIlF1ZWVuIiwicXVlZW4iLCJLaW5nIiwiVyIsIkIiLCJlbXB0eSIsImxhc3QiLCJmaWdYIiwiY29sb3JZIiwiY29sb3JZMiIsImZpZ1hBcnJheSIsIl9pIiwiY29lZiIsImluZGV4Iiwib25lIiwidHdvIiwiY29vcmRpbmF0ZXMiLCJib2FyZFBpZWNlIiwiaGVscCIsInJvb2tNb3ZlcyIsImJpc2hvcE1vdmVzIiwiY29uY2F0IiwiY29vcmQiLCJ4eCIsInl5IiwibmV3S2luZ1giLCJkaXIiLCJzYWZlIiwiZXZ2IiwiZXZNb3ZlIiwicm9jaGFkZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJvYmoiLCJQaWVjZXMiLCJ1bmRlZmluZWQiLCJfZ2FtZSIsIl9nYW1lMiIsIm5ld09iaiIsImtleSIsIl9BSSIsIl9BSTIiLCJDaGVzc0FJIiwiZ2FtZVN0YXRlIiwiaXNNYXhpbWlzaW5nUGxheWVyIiwiY3VycmVudENlbGwiLCJiZXN0VmFsdWUiLCJuZXdHYW1lTW92ZSIsInVuZG8iLCJib3JhZFZhbHVlIiwibWluaW1heCIsImFscGhhIiwiYmV0YSIsImV2YWx1YXRlQm9hcmQiLCJNYXRoIiwibWF4IiwiX2Jlc3RWYWx1ZSIsIl91bmRvIiwibWluIiwidG90YWxFdmFsdWF0aW9uIiwiZ2V0UGllY2VWYWx1ZSIsImFic29sdXRlVmFsdWUiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FJLEVBQUFKLEVBQ0FLLEdBQUEsRUFDQUgsV0FVQSxPQU5BSixHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBdkJBLEdBQUFELEtBNEJBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdBRixFQUFBVSxFQUFBLFNBQUFQLEVBQUFRLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFWLEVBQUFRLElBQ0FHLE9BQUFDLGVBQUFaLEVBQUFRLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BWixFQUFBbUIsRUFBQSxTQUFBZixHQUNBLEdBQUFRLEdBQUFSLEtBQUFnQixXQUNBLFdBQTJCLE1BQUFoQixHQUFBLFNBQzNCLFdBQWlDLE1BQUFBLEdBRWpDLE9BREFKLEdBQUFVLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVosRUFBQWEsRUFBQSxTQUFBUSxFQUFBQyxHQUFzRCxNQUFBUixRQUFBUyxVQUFBQyxl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LEdBQUF3QyxHQUlBLE9BQUErSSxJQUdBQyxFQUFBLFNBQUF4SSxHQUNBLFVBQUFBLEVBQ0EsUUFJQSxJQWlCQXlJLEdBakJBLFNBQUF6SSxHQUNBLGVBQUFBLEVBQUFDLEtBQ0EsR0FDSyxTQUFBRCxFQUFBQyxLQUNMLEdBQ0ssV0FBQUQsRUFBQUMsS0FDTCxHQUNLLFdBQUFELEVBQUFDLEtBQ0wsR0FDSyxVQUFBRCxFQUFBQyxLQUNMLEdBQ0ssU0FBQUQsRUFBQUMsS0FDTCxRQURLLElBTUxELElBQUFJLE1BQ0EsYUFBQUosRUFBQUksTUFBQXFJLEtBSUEzTCxHQUFBcUgsUUFBQW1EIiwiZmlsZSI6Indvcmtlci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGk6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bDogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuLyoqKioqKi8gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbi8qKioqKiovIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4vKioqKioqLyBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4vKioqKioqLyBcdFx0XHRcdGdldDogZ2V0dGVyXG4vKioqKioqLyBcdFx0XHR9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbi8qKioqKiovIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuLyoqKioqKi8gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbi8qKioqKiovIFx0XHRyZXR1cm4gZ2V0dGVyO1xuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBfcnNnQ2hlc3MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXG5zZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZSkge1xuICBpZiAoZS5kYXRhICYmIGUuZGF0YS5nYW1lICYmIGUuZGF0YS5wbGF5QWdhaW5zdEFJKSB7XG4gICAgdmFyIGJlc3RNb3ZlID0gKDAsIF9yc2dDaGVzcy5BSSkoZS5kYXRhLnBsYXlBZ2FpbnN0QUkuZGVwdGgsIGUuZGF0YS5nYW1lLCB0cnVlKTtcbiAgICBzZWxmLnBvc3RNZXNzYWdlKGJlc3RNb3ZlKTtcbiAgfVxufSk7IC8vIHNlbGYuaW1wb3J0U2NyaXB0cyhcImdhbWUuanNcIik7XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG4oZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0cnVlKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJyc2ctY2hlc3NcIiwgW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wicnNnLWNoZXNzXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcInJzZy1jaGVzc1wiXSA9IGZhY3RvcnkoKTtcbn0pKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGk6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bDogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuLyoqKioqKi8gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbi8qKioqKiovIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4vKioqKioqLyBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4vKioqKioqLyBcdFx0XHRcdGdldDogZ2V0dGVyXG4vKioqKioqLyBcdFx0XHR9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbi8qKioqKiovIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuLyoqKioqKi8gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbi8qKioqKiovIFx0XHRyZXR1cm4gZ2V0dGVyO1xuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMik7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfcGllY2VzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblxuZnVuY3Rpb24gR2FtZShwcm9tb0NhbGxiYWNrKSB7XG4gIC8vIHRoZSBnYW1lIGJvYXJkXG4gIHRoaXMuYm9hcmQgPSBbXTtcbiAgLy8gZmlsbCB0aGUgYm9hcmRcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICB2YXIgYXJyYXlJbiA9IFtdO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICBhcnJheUluLnB1c2gobnVsbCk7XG4gICAgfVxuICAgIHRoaXMuYm9hcmQucHVzaChhcnJheUluKTtcbiAgfVxuXG4gIC8vIHRoZSBoaXN0b3J5IG9mIGFsbCB0dXJuc1xuICB0aGlzLnR1cm4gPSBbXTtcbiAgLy8gdGhlIGN1cnJlbnQgRkVOIHN0YXR1c1xuICB0aGlzLkZFTiA9IFtdO1xuICAvLyB0aGUgY3VycmVudCBnYW1lIGNvbmZpZ3VyYXRpb24gYXMgRkVOXG4gIHRoaXMuRkVOYm9hcmQgPSBbXTtcbiAgLy8gdGhlIGhpc3Rvcnkgb2YgYWxsIGdhbWUgY29uZmlndXJhdGlvbnMgZGlzcGxheWVkIHVzaW5nIEZFTlxuICB0aGlzLnRocmVlZm9sZCA9IFtdO1xufVxuXG5HYW1lLnByb3RvdHlwZS5waWVjZSA9IGZ1bmN0aW9uICh0eXBlLCB4LCB5LCBjb2xvcikge1xuICB2YXIgcGllY2UgPSBfcGllY2VzLlBpZWNlW3R5cGVdKHgsIHksIGNvbG9yLCB0aGlzKTtcbiAgdGhpcy5ib2FyZFt5XVt4XSA9IHBpZWNlO1xuXG4gIHRoaXMuRkVOID0gdGhpcy5nYW1lVG9GRU4oKTtcbiAgdGhpcy5GRU5ib2FyZCA9IHRoaXMuYm9hcmRUb0ZFTigpO1xufTtcblxuR2FtZS5wcm90b3R5cGUubW92ZVNlbGVjdGVkID0gZnVuY3Rpb24gKHNlbGVjdGVkLCB0bywgcHJvbW90aW9uQ2FsbGJhY2ssIGNoZWNrbWF0ZUNhbGxiYWNrLCBzaW11bGF0ZSkge1xuICB2YXIgeCA9IHRvLng7XG4gIHZhciB5ID0gdG8ueTtcblxuICBpZiAoc2VsZWN0ZWQpIHtcbiAgICB2YXIgZnJvbSA9IHsgeDogc2VsZWN0ZWQueCwgeTogc2VsZWN0ZWQueSB9O1xuXG4gICAgaWYgKHRoaXMuYm9hcmRbeV1beF0gIT09IHNlbGVjdGVkKSB7XG4gICAgICB2YXIgdmFsaWRNb3ZlcyA9IHNlbGVjdGVkLmdldFZhbGlkTW92ZXMoIXNpbXVsYXRlKTtcbiAgICAgIHZhciB2YWxpZE1vdmUgPSBudWxsO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbGlkTW92ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHZtID0gdmFsaWRNb3Zlc1tpXTtcbiAgICAgICAgaWYgKHZtLnggPT09IHggJiYgdm0ueSA9PT0geSkge1xuICAgICAgICAgIHZhbGlkTW92ZSA9IHZtO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghdmFsaWRNb3ZlKSByZXR1cm4gZmFsc2U7XG4gICAgICB2YXIgbW92ZVBpZWNlID0gdmFsaWRNb3ZlLm1vdmVQaWVjZTtcbiAgICAgIHZhciB0YWtlLCBwYXN0ZSwgcm9vaztcbiAgICAgIGlmIChtb3ZlUGllY2UpIHtcbiAgICAgICAgdGFrZSA9IG1vdmVQaWVjZS5mcm9tO1xuICAgICAgICBwYXN0ZSA9IG1vdmVQaWVjZS50bztcbiAgICAgICAgaWYgKHBhc3RlID09PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5ib2FyZFt0YWtlLnldW3Rha2UueF0gPSBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJvb2sgPSB0aGlzLmJvYXJkW3Rha2UueV1bdGFrZS54XTtcbiAgICAgICAgICB0aGlzLmJvYXJkW3Bhc3RlLnldW3Bhc3RlLnhdID0gcm9vaztcbiAgICAgICAgICByb29rLnggPSBwYXN0ZS54O1xuICAgICAgICAgIHJvb2sueSA9IHBhc3RlLnk7XG4gICAgICAgICAgdGhpcy5ib2FyZFt0YWtlLnldW3Rha2UueF0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBwaWVjZSA9IHRoaXMuYm9hcmRbeV1beF0gPyB0aGlzLmJvYXJkW3ldW3hdIDogbnVsbDtcbiAgICAgIG1vdmVQaWVjZSA9IG1vdmVQaWVjZSA/IHZhbGlkTW92ZS5tb3ZlUGllY2UgOiBudWxsO1xuICAgICAgdGhpcy50dXJuLnB1c2goe1xuICAgICAgICBmcm9tOiBmcm9tLFxuICAgICAgICB0bzogdG8sXG4gICAgICAgIGNvbG9yOiBzZWxlY3RlZC5jb2xvcixcbiAgICAgICAgdHlwZTogc2VsZWN0ZWQudHlwZSxcbiAgICAgICAgcGllY2U6IHBpZWNlLFxuICAgICAgICBtb3ZlUGllY2U6IG1vdmVQaWVjZVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuYm9hcmRbeV1beF0gPSBzZWxlY3RlZDtcbiAgICAgIHRoaXMuYm9hcmRbc2VsZWN0ZWQueV1bc2VsZWN0ZWQueF0gPSBudWxsO1xuICAgICAgdGhpcy5ib2FyZFt5XVt4XS54ID0geDtcbiAgICAgIHRoaXMuYm9hcmRbeV1beF0ueSA9IHk7XG5cbiAgICAgIHRoaXMuRkVOID0gdGhpcy5nYW1lVG9GRU4oKTtcbiAgICAgIHRoaXMuRkVOYm9hcmQgPSB0aGlzLmJvYXJkVG9GRU4oKTtcbiAgICAgIC8vIGNoZWNrIGZvciB0aHJlZWZvbGQgcmVwZXRpdGlvblxuXG4gICAgICB0aGlzLnRocmVlZm9sZC5wdXNoKHRoaXMuRkVOYm9hcmQpO1xuICAgICAgaWYgKHNlbGVjdGVkLnR5cGUgPT09ICdwYXduJyB8fCBwaWVjZSkgdGhpcy50aHJlZWZvbGQgPSBbXTtcbiAgICAgIGlmICh0aGlzLnRocmVlZm9sZENoZWNrKCkpIGNoZWNrbWF0ZUNhbGxiYWNrKCdEJyk7XG5cbiAgICAgIC8vIGNoZWNrIGZvciB0aGUgZmlmdHktbW92ZSBydWxlXG4gICAgICBpZiAodGhpcy5oYWxmbW92ZUNsb2NrKCkgPj0gNTApIGNoZWNrbWF0ZUNhbGxiYWNrKCdEJyk7XG5cbiAgICAgIC8vIGNoZWNrIGZvciBwYXduIHByb21vdGlvblxuICAgICAgaWYgKHNlbGVjdGVkLnR5cGUgPT09ICdwYXduJyAmJiB5ICE9PSBzZWxlY3RlZC55KSB7XG4gICAgICAgIGlmIChzZWxlY3RlZC5jb2xvciA9PT0gJ1cnICYmIHkgPT09IDAgfHwgc2VsZWN0ZWQuY29sb3IgPT09ICdCJyAmJiB5ID09PSA3KSB7XG4gICAgICAgICAgaWYgKHByb21vdGlvbkNhbGxiYWNrKSBwcm9tb3Rpb25DYWxsYmFjayhzZWxlY3RlZCwgeCwgeSwgc2VsZWN0ZWQuY29sb3IpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB2YXIgY2hlY2ttYXRlQ29sb3IgPSBzZWxlY3RlZC5jb2xvciA9PT0gJ1cnID8gJ0InIDogJ1cnO1xuICAgICAgdmFyIGNoZWNrbWF0ZVZhbHVlID0gdGhpcy5jaGVja21hdGUoY2hlY2ttYXRlQ29sb3IpO1xuICAgICAgaWYgKGNoZWNrbWF0ZVZhbHVlKSBjaGVja21hdGVDYWxsYmFjayhjaGVja21hdGVWYWx1ZSk7XG5cbiAgICAgIC8vIC8vIFBsYXkgQUlcbiAgICAgIC8vIFdlIGRlY2lkZWQgdG8gcmVtb3ZlIHRoZSBBSSBtb3ZlbWVudHMgZnJvbSBnYW1lLmpzLCBiZWNhdXNlIHRoaXMgc2xvd3MgZG93biB5b3VyIGFwcFxuICAgICAgLy8gYW5kIG1ha2VzIHJlYWxseSBoYXJkIHRvIGltcGxlbWVudCBleHRlcm5hbCBjaGVzcyBzb3VyY2VzIGxpa2U6IHdlYiB3b3JrZXJzLCBiYWNrZW5kcywgY2xvdWQgZnVuY3Rpb25zLCBlY3QuXG4gICAgfVxuICAgIHNlbGVjdGVkID0gbnVsbDtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgICAvLyBlbmRcbiAgfVxufTtcblxuR2FtZS5wcm90b3R5cGUucHJvbW90ZVBhd24gPSBmdW5jdGlvbiAocGF3biwgeCwgeSwgY29sb3IsIHR5cGUpIHtcbiAgdGhpcy5waWVjZSh0eXBlLCB4LCB5LCBjb2xvcik7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5zaW11bGF0ZUFuZEZpbHRlciA9IGZ1bmN0aW9uIChtb3ZlcywgcGllY2UpIHtcbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuXG4gIG1vdmVzLmZvckVhY2goZnVuY3Rpb24gKG1vdmUsIGkpIHtcbiAgICB2YXIgeSA9IG1vdmUueTtcbiAgICB2YXIgeCA9IG1vdmUueDtcbiAgICB2YXIgZnJvbSA9IHsgeDogcGllY2UueCwgeTogcGllY2UueSB9O1xuICAgIHZhciBtb3ZlUGllY2UgPSBib2FyZFt5XVt4XSA/IHtcbiAgICAgIHBpZWNlOiBib2FyZFt5XVt4XSxcbiAgICAgIGZyb206IHsgeDogeCwgeTogeSB9LFxuICAgICAgdG86IG51bGxcbiAgICB9IDogbnVsbDtcblxuICAgIGlmIChtb3ZlLm1vdmVQaWVjZSkgbW92ZVBpZWNlID0gbW92ZS5tb3ZlUGllY2U7XG4gICAgaWYgKG1vdmVQaWVjZSkgc2VsZi5zaW1wbGVNb3ZlUGllY2UobW92ZVBpZWNlLnBpZWNlLCBtb3ZlUGllY2UuZnJvbSwgbW92ZVBpZWNlLnRvKTtcblxuICAgIHNlbGYuc2ltcGxlTW92ZVBpZWNlKHBpZWNlLCBmcm9tLCB7IHg6IHgsIHk6IHkgfSk7XG4gICAgdmFyIHdhcm5pbmcgPSBzZWxmLndhcm5pbmcocGllY2UuY29sb3IpO1xuXG4gICAgLy8gUmV0dXJuIGtpbmdcbiAgICBzZWxmLnNpbXBsZU1vdmVQaWVjZShwaWVjZSwgeyB4OiB4LCB5OiB5IH0sIGZyb20pO1xuXG4gICAgLy8gcmV0dXJuIHRoZSBtb3ZlUGllY2Ugd2l0aCBzaW1wbGVNb3ZlUGllY2UoKSBtZXRob2RcbiAgICBpZiAobW92ZVBpZWNlKSBzZWxmLnNpbXBsZU1vdmVQaWVjZShtb3ZlUGllY2UucGllY2UsIG1vdmVQaWVjZS50bywgbW92ZVBpZWNlLmZyb20pO1xuXG4gICAgaWYgKCF3YXJuaW5nKSB2YWxpZE1vdmVzLnB1c2gobW92ZSk7XG4gIH0pO1xuICByZXR1cm4gdmFsaWRNb3Zlcztcbn07XG5cbkdhbWUucHJvdG90eXBlLmNoZWNrbWF0ZSA9IGZ1bmN0aW9uIChjb2xvcikge1xuICAvLyB1c2luZyBsZXQgd2lsbCBhbGxvdyB1cyB0byBtYWtlIHRoZSBjb2RlIGEgYml0IHNpbXBsZXJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDg7IGorKykge1xuICAgICAgaWYgKHRoaXMuYm9hcmRbaV1bal0gJiYgdGhpcy5ib2FyZFtpXVtqXS5jb2xvciA9PT0gY29sb3IgJiYgdGhpcy5ib2FyZFtpXVtqXS5nZXRWYWxpZE1vdmVzKHRydWUpLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBpZiAodGhpcy53YXJuaW5nKGNvbG9yKSkgcmV0dXJuIGNvbG9yO1xuICByZXR1cm4gJ0QnO1xufTtcblxuR2FtZS5wcm90b3R5cGUuc2ltcGxlTW92ZVBpZWNlID0gZnVuY3Rpb24gKHBpZWNlLCBmcm9tLCB0bykge1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuICBpZiAodG8pIHtcbiAgICBib2FyZFt0by55XVt0by54XSA9IHBpZWNlO1xuICAgIHBpZWNlLnggPSB0by54O1xuICAgIHBpZWNlLnkgPSB0by55O1xuICB9XG4gIGlmIChmcm9tKSBib2FyZFtmcm9tLnldW2Zyb20ueF0gPSBudWxsO1xufTtcblxuR2FtZS5wcm90b3R5cGUuc2ltcGxlTW92ZSA9IGZ1bmN0aW9uIChtb3ZlKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdmFyIGJvYXJkID0gc2VsZi5ib2FyZDtcbiAgdmFyIGZyb20gPSBtb3ZlLmZyb207XG4gIHZhciB0byA9IG1vdmUudG87XG4gIHZhciBwaWVjZSA9IGJvYXJkW2Zyb20ueV1bZnJvbS54XTtcbiAgdmFyIGNhcHR1cmVkUGllY2UgPSB0aGlzLmJvYXJkW3RvLnldW3RvLnhdID8gdGhpcy5ib2FyZFt0by55XVt0by54XSA6IG51bGw7XG4gIHZhciBtb3ZlUGllY2UgPSBib2FyZFt0by55XVt0by54XSA/IHtcbiAgICBwaWVjZTogYm9hcmRbdG8ueV1bdG8ueF0sXG4gICAgZnJvbTogeyB4OiB0by54LCB5OiB0by55IH0sXG4gICAgdG86IG51bGxcbiAgfSA6IG51bGw7XG5cbiAgdGhpcy50dXJuLnB1c2goe1xuICAgIGZyb206IGZyb20sXG4gICAgdG86IHsgeDogdG8ueCwgeTogdG8ueSB9LFxuICAgIGNvbG9yOiBtb3ZlLmNvbG9yLFxuICAgIHR5cGU6IHBpZWNlLnR5cGUsXG4gICAgcGllY2U6IGNhcHR1cmVkUGllY2UsXG4gICAgbW92ZVBpZWNlOiBtb3ZlUGllY2VcbiAgfSk7XG5cbiAgaWYgKHRvLm1vdmVQaWVjZSkgbW92ZVBpZWNlID0gdG8ubW92ZVBpZWNlO1xuICBpZiAobW92ZVBpZWNlKSBzZWxmLnNpbXBsZU1vdmVQaWVjZShtb3ZlUGllY2UucGllY2UsIG1vdmVQaWVjZS5mcm9tLCBtb3ZlUGllY2UudG8pO1xuICBzZWxmLnNpbXBsZU1vdmVQaWVjZShwaWVjZSwgZnJvbSwgeyB4OiB0by54LCB5OiB0by55IH0pO1xuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gcmV0dXJuIHRoZSBjdXJyZW50IG1vdmUgL2V2L1xuICAgIGlmIChtb3ZlUGllY2UpIHNlbGYuc2ltcGxlTW92ZVBpZWNlKG1vdmVQaWVjZS5waWVjZSwgbW92ZVBpZWNlLnRvLCBtb3ZlUGllY2UuZnJvbSk7XG4gICAgc2VsZi5zaW1wbGVNb3ZlUGllY2UocGllY2UsIHsgeDogdG8ueCwgeTogdG8ueSB9LCBmcm9tKTtcbiAgICBpZiAoY2FwdHVyZWRQaWVjZSkgYm9hcmRbdG8ueV1bdG8ueF0gPSBjYXB0dXJlZFBpZWNlO1xuICAgIHNlbGYudHVybi5wb3AoKTtcbiAgfTtcbn07XG5cbkdhbWUucHJvdG90eXBlLndhcm5pbmcgPSBmdW5jdGlvbiAoY29sb3IpIHtcbiAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuICB2YXIga2luZztcblxuICB0aGlzLmJvYXJkLmZvckVhY2goZnVuY3Rpb24gKHl5eSkge1xuICAgIHl5eS5mb3JFYWNoKGZ1bmN0aW9uICh4eHgpIHtcbiAgICAgIGlmICh4eHggJiYgeHh4LmNvbG9yID09PSBjb2xvciAmJiB4eHgudHlwZSA9PT0gJ2tpbmcnKSB7XG4gICAgICAgIGtpbmcgPSB4eHg7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRoaXMuYm9hcmQuZm9yRWFjaChmdW5jdGlvbiAoeXl5KSB7XG4gICAgeXl5LmZvckVhY2goZnVuY3Rpb24gKHh4eCkge1xuICAgICAgaWYgKHh4eCAmJiB4eHguY29sb3IgIT09IGNvbG9yKSB7XG4gICAgICAgIHh4eC5nZXRWYWxpZE1vdmVzKCkuZm9yRWFjaChmdW5jdGlvbiAobW1tKSB7XG4gICAgICAgICAgaWYgKG1tbS54ID09PSBraW5nLnggJiYgbW1tLnkgPT09IGtpbmcueSkgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuR2FtZS5wcm90b3R5cGUudGhyZWVmb2xkQ2hlY2sgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0aHJlZWZvbGQgPSB0aGlzLnRocmVlZm9sZDtcbiAgdmFyIGxlbmd0aCA9IHRocmVlZm9sZC5sZW5ndGg7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIC8vIHVzaW5nIGxldCB3aWxsIGFsbG93IHVzIHRvIG1ha2UgdGhlIGNvZGUgc2ltcGxlclxuICAgIHZhciBjb3VudCA9IDA7XG4gICAgZm9yICh2YXIgaiA9IGkgKyAxOyBqIDwgbGVuZ3RoOyBqKyspIHtcbiAgICAgIGlmICh0aHJlZWZvbGRbaV0gPT09IHRocmVlZm9sZFtqXSkgY291bnQgKz0gMTtcbiAgICB9XG4gICAgaWYgKGNvdW50ID49IDIpIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuR2FtZS5wcm90b3R5cGUucGllY2VUb0FOID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgdmFyIHhDaGFycyA9ICdhYmNkZWZnaCc7XG4gIHJldHVybiB4Q2hhcnMuY2hhckF0KHgpICsgKDggLSB5KTtcbn07XG5cbi8vIFN1cHBvcnQgRkVOIGZ1bmN0aW9ucyBpbiB0aGUgQVBJXG5HYW1lLnByb3RvdHlwZS5ib2FyZFRvRkVOID0gZnVuY3Rpb24gKCkge1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuXG4gIC8vIENvbnZlcnQgdGhlIGJvYXJkIGNvbmZpZ3VyYXRpb24gaW50byBGRU5cbiAgdmFyIEZFTmJvYXJkID0gJyc7XG4gIHZhciBtaXNzaW5nUGllY2VzID0gMDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDg7IGorKykge1xuICAgICAgaWYgKGJvYXJkW2ldW2pdKSB7XG4gICAgICAgIGlmIChtaXNzaW5nUGllY2VzKSBGRU5ib2FyZCArPSBtaXNzaW5nUGllY2VzO1xuICAgICAgICBtaXNzaW5nUGllY2VzID0gMDtcbiAgICAgICAgRkVOYm9hcmQgKz0gYm9hcmRbaV1bal0uRkVObmFtZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1pc3NpbmdQaWVjZXMrKztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1pc3NpbmdQaWVjZXMpIEZFTmJvYXJkICs9IG1pc3NpbmdQaWVjZXM7XG4gICAgbWlzc2luZ1BpZWNlcyA9IDA7XG4gICAgRkVOYm9hcmQgKz0gaSA8IDcgPyAnLycgOiAnJztcbiAgfVxuXG4gIHJldHVybiBGRU5ib2FyZDtcbn07XG5cbkdhbWUucHJvdG90eXBlLmhhbGZtb3ZlQ2xvY2sgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0dXJuID0gdGhpcy50dXJuO1xuICB2YXIgbGVuZ3RoID0gdHVybi5sZW5ndGg7XG4gIHZhciBjb3VudCA9IDA7XG4gIGlmICh0dXJuLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGNvdW50O1xuXG4gIHZhciBldiA9IHR1cm5bbGVuZ3RoIC0gMSAtIGNvdW50XTtcbiAgd2hpbGUgKGNvdW50IDw9IGxlbmd0aCAtIDEgJiYgZXYudHlwZSAhPT0gJ3Bhd24nICYmICFldi5waWVjZSkge1xuICAgIGNvdW50Kys7XG4gICAgZXYgPSB0dXJuW2xlbmd0aCAtIDEgLSBjb3VudF07XG4gIH1cblxuICByZXR1cm4gY291bnQ7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5hY3RpdmVDb2xvdXIgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0dXJuID0gdGhpcy50dXJuO1xuICB2YXIgYWN0aXZlQ29sb3IgPSB0dXJuLmxlbmd0aCAmJiB0dXJuW3R1cm4ubGVuZ3RoIC0gMV0uY29sb3IgPT09ICdXJyA/ICdiJyA6ICd3JztcblxuICByZXR1cm4gYWN0aXZlQ29sb3I7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5jYXN0bGluZ1RhcmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGJvYXJkID0gdGhpcy5ib2FyZDtcbiAgdmFyIHR1cm4gPSB0aGlzLnR1cm47XG4gIHZhciBwb3NzaWJsZUNhc3RsaW5nID0gJyc7XG5cbiAgdmFyIHdoaXRlS2luZ01vdmVkO1xuICB2YXIgYmxhY2tLaW5nTW92ZWQ7XG4gIHR1cm4uZm9yRWFjaChmdW5jdGlvbiAodHVybikge1xuICAgIHdoaXRlS2luZ01vdmVkID0gdHVybi50eXBlID09PSAna2luZycgJiYgdHVybi5jb2xvciA9PT0gJ1cnO1xuICAgIGJsYWNrS2luZ01vdmVkID0gdHVybi50eXBlID09PSAna2luZycgJiYgdHVybi5jb2xvciA9PT0gJ0InO1xuICB9KTtcblxuICBbWzcsIDBdLCBbMCwgMF0sIFs3LCA3XSwgWzAsIDddXS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHZhciByb29rWCA9IHByb3BzWzBdO1xuICAgIHZhciByb29rWSA9IHByb3BzWzFdO1xuICAgIHZhciByb29rID0gYm9hcmRbcm9va1ldW3Jvb2tYXTtcblxuICAgIGlmIChyb29rWSA9PT0gNyAmJiB3aGl0ZUtpbmdNb3ZlZCkgcmV0dXJuO1xuICAgIGlmIChyb29rWSA9PT0gMCAmJiBibGFja0tpbmdNb3ZlZCkgcmV0dXJuO1xuXG4gICAgLy8gQ2hlY2sgcm9vayBvbiBwb3NpdGlvblxuICAgIGlmICghcm9vayB8fCAhcm9vay50eXBlID09PSAncm9vaycpIHJldHVybjtcblxuICAgIC8vIENoZWNrIHJvb2sgaGFzbid0IG1vdmVkXG4gICAgaWYgKHR1cm4uc29tZShmdW5jdGlvbiAoZXYpIHtcbiAgICAgIGlmIChldi50eXBlICE9PSAncm9vaycpIHJldHVybiBmYWxzZTtcbiAgICAgIHJldHVybiBldi5mcm9tLnggPT09IHJvb2tYICYmIGV2LmZyb20ueSA9PT0gcm9va1k7XG4gICAgfSkpIHJldHVybjtcblxuICAgIHZhciBjYXN0bGluZ1NpZGUgPSByb29rWCA9PT0gMCA/ICdxJyA6ICdrJztcbiAgICBwb3NzaWJsZUNhc3RsaW5nICs9IHJvb2tZID09PSAwID8gY2FzdGxpbmdTaWRlLnRvVXBwZXJDYXNlKCkgOiBjYXN0bGluZ1NpZGU7XG4gIH0pO1xuXG4gIGlmICghcG9zc2libGVDYXN0bGluZykgcG9zc2libGVDYXN0bGluZyA9ICctJztcbiAgcmV0dXJuIHBvc3NpYmxlQ2FzdGxpbmc7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5lblBhc3NhbnRUYXJnZXQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0dXJuID0gdGhpcy50dXJuO1xuICB2YXIgZW5QYXNzYW50VGFyZ2V0ID0gJyc7XG5cbiAgaWYgKHR1cm4ubGVuZ3RoKSB7XG4gICAgdmFyIGV2ID0gdHVyblt0dXJuLmxlbmd0aCAtIDFdO1xuICAgIGlmIChldi5jb2xvciA9PT0gJ1cnICYmIGV2LnRvLnkgPT09IDQpIHtcbiAgICAgIGVuUGFzc2FudFRhcmdldCA9IHRoaXMucGllY2VUb0FOKGV2LnRvLngsIGV2LnRvLnkgKyAxKTtcbiAgICB9XG5cbiAgICBpZiAoZXYuY29sb3IgPT09ICdCJyAmJiBldi50by55ID09PSAzKSB7XG4gICAgICBlblBhc3NhbnRUYXJnZXQgPSB0aGlzLnBpZWNlVG9BTihldi50by54LCBldi50by55IC0gMSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFlblBhc3NhbnRUYXJnZXQpIGVuUGFzc2FudFRhcmdldCA9ICctJztcbiAgcmV0dXJuIGVuUGFzc2FudFRhcmdldDtcbn07XG5cbkdhbWUucHJvdG90eXBlLmZ1bGxtb3ZlQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBjb3VudCA9IDE7XG4gIHRoaXMudHVybi5mb3JFYWNoKGZ1bmN0aW9uIChldikge1xuICAgIGlmIChldi5jb2xvciA9PT0gJ0InKSBjb3VudCArPSAxO1xuICB9KTtcblxuICByZXR1cm4gY291bnQ7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5nYW1lVG9GRU4gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBGRU4gPSAnJztcblxuICAvLyBDaGVjayB0aGUgYm9hcmQgY29uZmlndXJhdGlvblxuICBGRU4gKz0gdGhpcy5ib2FyZFRvRkVOKCk7XG5cbiAgLy8gRmluZCB0aGUgYWN0aXZlIGNvbG91clxuICBGRU4gKz0gJyAnICsgdGhpcy5hY3RpdmVDb2xvdXIoKTtcblxuICAvLyBDaGVjayBjYXN0bGluZyBhdmFpbGFiaWxpdHlcbiAgRkVOICs9ICcgJyArIHRoaXMuY2FzdGxpbmdUYXJnZXQoKTtcblxuICAvLyBDaGVjayB0aGUgRW4tcGFzc2FudCB0YXJnZXRcbiAgRkVOICs9ICcgJyArIHRoaXMuZW5QYXNzYW50VGFyZ2V0KCk7XG5cbiAgLy8gQWRkIHRoZSBoYWxmbW92ZSBjbG9ja1xuICBGRU4gKz0gJyAnICsgdGhpcy5oYWxmbW92ZUNsb2NrKCk7XG5cbiAgLy8gQWRkIHRoZSBmdWxsbW92ZSBudW1iZXJcbiAgRkVOICs9ICcgJyArIHRoaXMuZnVsbG1vdmVDb3VudCgpO1xuXG4gIC8qXHJcbiAgICBNb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBGRU4gbm90YXRpb246XHJcbiAgICBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Gb3JzeXRoJUUyJTgwJTkzRWR3YXJkc19Ob3RhdGlvblxyXG4gICAgaHR0cHM6Ly9jaGVzc3Byb2dyYW1taW5nLndpa2lzcGFjZXMuY29tL0ZvcnN5dGgtRWR3YXJkcytOb3RhdGlvblxyXG4gICovXG5cbiAgcmV0dXJuIEZFTjtcbn07XG5cbi8vIFNldCB1cCBkZWZhdWx0IGdhbWUgY29uZmlndXJhdGlvblxuR2FtZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBkZWZhdWx0R2FtZSA9IG5ldyBHYW1lKCk7XG5cbiAgLy8gUGF3bnM6XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgZGVmYXVsdEdhbWUucGllY2UoJ3Bhd24nLCBpLCA2LCAnVycpO1xuICAgIGRlZmF1bHRHYW1lLnBpZWNlKCdwYXduJywgaSwgMSwgJ0InKTtcbiAgfVxuXG4gIC8vIEJsYWNrIGZpZ3M6XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdyb29rJywgMCwgMCwgJ0InKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2tuaWdodCcsIDEsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdiaXNob3AnLCAyLCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgncXVlZW4nLCAzLCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna2luZycsIDQsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdiaXNob3AnLCA1LCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna25pZ2h0JywgNiwgMCwgJ0InKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ3Jvb2snLCA3LCAwLCAnQicpO1xuXG4gIC8vIFdoaXRlIGZpZ3M6XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdyb29rJywgMCwgNywgJ1cnKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2tuaWdodCcsIDEsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdiaXNob3AnLCAyLCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgncXVlZW4nLCAzLCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna2luZycsIDQsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdiaXNob3AnLCA1LCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna25pZ2h0JywgNiwgNywgJ1cnKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ3Jvb2snLCA3LCA3LCAnVycpO1xuXG4gIHJldHVybiBkZWZhdWx0R2FtZTtcbn07XG5cbkdhbWUucHJvdG90eXBlLmFsbE1vdmVzID0gZnVuY3Rpb24gKCkge1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuICB2YXIgYWxsTW92ZXMgPSBbXTtcbiAgdmFyIGFjdGl2ZUNvbG91ciA9IHRoaXMuYWN0aXZlQ29sb3VyKCkudG9VcHBlckNhc2UoKTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICBpZiAoYm9hcmRbaV1bal0gJiYgYm9hcmRbaV1bal0uY29sb3IgPT09IGFjdGl2ZUNvbG91cikge1xuICAgICAgICB2YXIgdmFsaWRNb3ZlcyA9IGJvYXJkW2ldW2pdLmdldFZhbGlkTW92ZXModHJ1ZSk7XG4gICAgICAgIHZhbGlkTW92ZXMuZm9yRWFjaChmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICBhbGxNb3Zlcy5wdXNoKHtcbiAgICAgICAgICAgIGNvbG9yOiBib2FyZFtpXVtqXS5jb2xvcixcbiAgICAgICAgICAgIGZyb206IHsgeDogaiwgeTogaSB9LFxuICAgICAgICAgICAgdG86IGV2LFxuICAgICAgICAgICAgRkVObmFtZTogYm9hcmRbaV1bal0uRkVObmFtZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gYWxsTW92ZXM7XG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSBHYW1lO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8vXG4vLyBSU0cgQ2hlc3Ncbi8vIExpY2Vuc2VkIHVuZGVyIEFwYWNoZSAyLjAgTElDRU5TRVxuXG52YXIgUElFQ0VfQ0hBUlMgPSBleHBvcnRzLlBJRUNFX0NIQVJTID0ge1xuICBwYXduOiB7IFc6ICfimZknLCBCOiAn4pmfJyB9LFxuICByb29rOiB7IFc6ICfimZYnLCBCOiAn4pmcJyB9LFxuICBrbmlnaHQ6IHsgVzogJ+KZmCcsIEI6ICfimZ4nIH0sXG4gIGJpc2hvcDogeyBXOiAn4pmXJywgQjogJ+KZnScgfSxcbiAgcXVlZW46IHsgVzogJ+KZlScsIEI6ICfimZsnIH0sXG4gIGtpbmc6IHsgVzogJ+KZlCcsIEI6ICfimZonIH1cbn07XG5cbmZ1bmN0aW9uIFBpZWNlKHgsIHksIGNoYXJCYXNlLCBjb2xvciwgZ2FtZSwgdHlwZSkge1xuICBpZiAoY2hhckJhc2UpIHRoaXMuY2hhciA9IGNoYXJCYXNlW2NvbG9yXTtcbiAgdGhpcy5jb2xvciA9IGNvbG9yO1xuICB0aGlzLnggPSB4O1xuICB0aGlzLnkgPSB5O1xuICB0aGlzLmdhbWUgPSBnYW1lO1xuICB0aGlzLnR5cGUgPSB0eXBlO1xuICBpZiAodHlwZSkge1xuICAgIHZhciBGRU5uYW1lID0gdHlwZSA9PT0gJ2tuaWdodCcgPyAnbicgOiB0eXBlLmNoYXJBdCgwKTtcbiAgICBpZiAodGhpcy5jb2xvciA9PT0gJ1cnKSBGRU5uYW1lID0gRkVObmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgIHRoaXMuRkVObmFtZSA9IEZFTm5hbWU7XG4gIH1cbn1cblxuUGllY2UuZW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBuZXcgUGllY2UoKTtcbn07XG5cblBpZWNlLnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gW3sgeDogMCwgeTogMCB9LCB7IHg6IDcsIHk6IDcgfV07XG59O1xuXG5mdW5jdGlvbiBQYXduKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMucGF3biwgY29sb3IsIGdhbWUsICdwYXduJyk7XG59XG5cblBhd24ucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcblBhd24ucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoc2ltdWxhdGUpIHtcbiAgdmFyIGdhbWUgPSB0aGlzLmdhbWU7XG4gIHZhciBtb3ZlcyA9IFtdO1xuICAvKiBlc2xpbnQtZGlzYWJsZSAqL1xuICB2YXIgeSA9IHRoaXMueSxcbiAgICAgIHggPSB0aGlzLng7XG4gIHZhciBib2FyZCA9IGdhbWUuYm9hcmQsXG4gICAgICB0dXJuID0gZ2FtZS50dXJuLFxuICAgICAgbGVuZ3RoID0gdHVybi5sZW5ndGg7XG4gIHZhciBsYXN0LCB0dXJuVG8sIHR1cm5Gcm9tLCBmaWdYLCBwYXNzYW50TGFzdCwgcGFzc2FudEZpZztcbiAgdmFyIGNvbG9yWSA9IHRoaXMuY29sb3IgPT09ICdXJyA/IHkgLSAxIDogeSArIDE7XG4gIHZhciBjb2xvclkyID0gdGhpcy5jb2xvciA9PT0gJ1cnID8geSAtIDIgOiB5ICsgMjtcbiAgdmFyIHBhc3NhbnRZMiA9IHRoaXMuY29sb3IgPT09ICdXJyA/IDMgOiA0O1xuICB2YXIgZmlnWEFycmF5ID0gW3ggLSAxLCB4ICsgMV07XG4gIC8qIGVzbGludC1lbmFibGUgKi9cblxuICBpZiAoY29sb3JZIDwgOCAmJiBjb2xvclkgPj0gMCAmJiAhYm9hcmRbY29sb3JZXVt4XSkge1xuICAgIG1vdmVzLnB1c2goeyB4OiB4LCB5OiBjb2xvclkgfSk7XG4gICAgaWYgKCh5ID09PSAxIHx8IHkgPT09IDYpICYmIGNvbG9yWTIgPCA4ICYmIGNvbG9yWTIgPj0gMCAmJiAhZ2FtZS5ib2FyZFtjb2xvclkyXVt4XSkge1xuICAgICAgbW92ZXMucHVzaCh7IHg6IHgsIHk6IGNvbG9yWTIgfSk7XG4gICAgfVxuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCAyOyBpKyspIHtcbiAgICBmaWdYID0gZmlnWEFycmF5W2ldO1xuICAgIGlmIChjb2xvclkgPCA4ICYmIGNvbG9yWSA+PSAwICYmIGJvYXJkW2NvbG9yWV1bZmlnWF0gJiYgYm9hcmRbY29sb3JZXVtmaWdYXS5jb2xvciAhPT0gdGhpcy5jb2xvcikgbW92ZXMucHVzaCh7IHg6IGZpZ1gsIHk6IGNvbG9yWSB9KTtcbiAgfVxuXG4gIC8vIENoZWNrIGZvciBlbi1wYXNzYW50XG4gIGZvciAodmFyIF9pID0gMDsgX2kgPCAyOyBfaSsrKSB7XG4gICAgZmlnWCA9IGZpZ1hBcnJheVtfaV07XG4gICAgbGFzdCA9IHR1cm5bbGVuZ3RoIC0gMV07XG5cbiAgICBpZiAobGFzdCAmJiBsYXN0LnR5cGUgPT09ICdwYXduJyAmJiBsYXN0LnRvLnggPT09IGZpZ1ggJiYgbGFzdC50by55ID09PSB5ICYmIGxhc3QuY29sb3IgIT09IHRoaXMuY29sb3IgJiYgKGxhc3QuZnJvbS55ID09PSAxIHx8IGxhc3QuZnJvbS55ID09PSA2KSAmJiAoeSA9PT0gMyB8fCB5ID09PSA0KSkge1xuICAgICAgbW92ZXMucHVzaCh7XG4gICAgICAgIHg6IGZpZ1gsXG4gICAgICAgIHk6IGNvbG9yWSxcbiAgICAgICAgbW92ZVBpZWNlOiB7XG4gICAgICAgICAgcGllY2U6IGdhbWUuYm9hcmRbeV1bZmlnWF0sXG4gICAgICAgICAgZnJvbToge1xuICAgICAgICAgICAgeDogZmlnWCxcbiAgICAgICAgICAgIHk6IHlcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRvOiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHZhciB2YWxpZE1vdmVzID0gW107XG4gIGlmIChzaW11bGF0ZSkge1xuICAgIHZhbGlkTW92ZXMgPSBnYW1lLnNpbXVsYXRlQW5kRmlsdGVyKG1vdmVzLCB0aGlzKTtcbiAgfSBlbHNlIHtcbiAgICB2YWxpZE1vdmVzID0gbW92ZXM7XG4gIH1cblxuICByZXR1cm4gdmFsaWRNb3Zlcztcbn07XG5cblBpZWNlLnBhd24gPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBQYXduKHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbi8vIC8vXG5cbmZ1bmN0aW9uIFJvb2soeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5yb29rLCBjb2xvciwgZ2FtZSwgJ3Jvb2snKTtcbn1cblxuUm9vay5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuUm9vay5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIG1vdmVzID0gW107XG5cbiAgW1stMSwgMF0sIFsxLCAwXSwgWzAsIDFdLCBbMCwgLTFdXS5mb3JFYWNoKGZ1bmN0aW9uIChjb2VmKSB7XG4gICAgdmFyIGluZGV4LCB4LCB5LCBwaWVjZTtcbiAgICBmb3IgKGluZGV4ID0gMTs7IGluZGV4KyspIHtcbiAgICAgIHggPSB0aGlzLnggKyBjb2VmWzBdICogaW5kZXg7XG4gICAgICB5ID0gdGhpcy55ICsgY29lZlsxXSAqIGluZGV4O1xuICAgICAgaWYgKHkgPCAwIHx8IHkgPiA3IHx8IHggPCAwIHx8IHggPiA3KSBicmVhaztcblxuICAgICAgcGllY2UgPSBnYW1lLmJvYXJkW3ldW3hdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSB0aGlzLmNvbG9yKSBicmVhaztcblxuICAgICAgbW92ZXMucHVzaCh7IHg6IHgsIHk6IHkgfSk7XG4gICAgICBpZiAocGllY2UpIGJyZWFrO1xuICAgIH1cbiAgfSwgdGhpcyk7XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2Uucm9vayA9IGZ1bmN0aW9uICh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICByZXR1cm4gbmV3IFJvb2soeCwgeSwgY29sb3IsIGdhbWUpO1xufTtcblxuLy8gLy9cblxuZnVuY3Rpb24gS25pZ2h0KHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMua25pZ2h0LCBjb2xvciwgZ2FtZSwgJ2tuaWdodCcpO1xufVxuXG5LbmlnaHQucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcbktuaWdodC5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIG1vdmVzID0gW107XG5cbiAgdmFyIGNvb3JkaW5hdGVzID0gW1syLCAxXSwgWy0yLCAxXSwgWzEsIDJdLCBbLTEsIDJdLCBbMiwgLTFdLCBbLTIsIC0xXSwgWzEsIC0yXSwgWy0xLCAtMl1dO1xuXG4gIHZhciBvbmUsIHR3bztcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb29yZGluYXRlcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBoZWxwID0gZmFsc2U7XG4gICAgdmFyIGJvYXJkUGllY2U7XG4gICAgb25lID0gY29vcmRpbmF0ZXNbaV1bMF07XG4gICAgdHdvID0gY29vcmRpbmF0ZXNbaV1bMV07XG5cbiAgICBpZiAodGhpcy54ICsgb25lIDwgOCAmJiB0aGlzLnggKyBvbmUgPj0gMCAmJiB0aGlzLnkgKyB0d28gPCA4ICYmIHRoaXMueSArIHR3byA+PSAwKSB7XG4gICAgICBib2FyZFBpZWNlID0gZ2FtZS5ib2FyZFt0aGlzLnkgKyB0d29dW3RoaXMueCArIG9uZV07XG4gICAgICBoZWxwID0gYm9hcmRQaWVjZSA/IGJvYXJkUGllY2UuY29sb3IgIT09IHRoaXMuY29sb3IgOiB0cnVlO1xuICAgIH1cblxuICAgIGlmIChoZWxwKSB7XG4gICAgICBtb3Zlcy5wdXNoKHsgeDogdGhpcy54ICsgb25lLCB5OiB0aGlzLnkgKyB0d28gfSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2Uua25pZ2h0ID0gZnVuY3Rpb24gKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIHJldHVybiBuZXcgS25pZ2h0KHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbi8vIC8vXG5cbmZ1bmN0aW9uIEJpc2hvcCh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICBQaWVjZS5jYWxsKHRoaXMsIHgsIHksIFBJRUNFX0NIQVJTLmJpc2hvcCwgY29sb3IsIGdhbWUsICdiaXNob3AnKTtcbn1cblxuQmlzaG9wLnByb3RvdHlwZSA9IFBpZWNlLmVtcHR5KCk7XG5CaXNob3AucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoc2ltdWxhdGUpIHtcbiAgdmFyIGdhbWUgPSB0aGlzLmdhbWU7XG4gIHZhciBtb3ZlcyA9IFtdO1xuXG4gIFtbLTEsIC0xXSwgWzEsIDFdLCBbLTEsIDFdLCBbMSwgLTFdXS5mb3JFYWNoKGZ1bmN0aW9uIChjb2VmKSB7XG4gICAgdmFyIGluZGV4LCB4LCB5LCBwaWVjZTtcbiAgICBmb3IgKGluZGV4ID0gMTs7IGluZGV4KyspIHtcbiAgICAgIHggPSB0aGlzLnggKyBjb2VmWzBdICogaW5kZXg7XG4gICAgICB5ID0gdGhpcy55ICsgY29lZlsxXSAqIGluZGV4O1xuICAgICAgaWYgKHkgPCAwIHx8IHkgPiA3IHx8IHggPCAwIHx8IHggPiA3KSBicmVhaztcblxuICAgICAgcGllY2UgPSBnYW1lLmJvYXJkW3ldW3hdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSB0aGlzLmNvbG9yKSBicmVhaztcblxuICAgICAgbW92ZXMucHVzaCh7IHg6IHgsIHk6IHkgfSk7XG4gICAgICBpZiAocGllY2UpIGJyZWFrO1xuICAgIH1cbiAgfSwgdGhpcyk7XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2UuYmlzaG9wID0gZnVuY3Rpb24gKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIHJldHVybiBuZXcgQmlzaG9wKHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbi8vIC8vXG5cbmZ1bmN0aW9uIFF1ZWVuKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMucXVlZW4sIGNvbG9yLCBnYW1lLCAncXVlZW4nKTtcbn1cblxuUXVlZW4ucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcblF1ZWVuLnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzID0gZnVuY3Rpb24gKHNpbXVsYXRlKSB7XG4gIHZhciBnYW1lID0gdGhpcy5nYW1lO1xuICB2YXIgcm9va01vdmVzID0gUm9vay5wcm90b3R5cGUuZ2V0VmFsaWRNb3Zlcy5jYWxsKHRoaXMpO1xuICB2YXIgYmlzaG9wTW92ZXMgPSBCaXNob3AucHJvdG90eXBlLmdldFZhbGlkTW92ZXMuY2FsbCh0aGlzKTtcbiAgdmFyIG1vdmVzID0gcm9va01vdmVzLmNvbmNhdChiaXNob3BNb3Zlcyk7XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2UucXVlZW4gPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBRdWVlbih4LCB5LCBjb2xvciwgZ2FtZSk7XG59O1xuXG4vLyAvL1xuXG5mdW5jdGlvbiBLaW5nKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMua2luZywgY29sb3IsIGdhbWUsICdraW5nJyk7XG59XG5cbktpbmcucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcbktpbmcucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoc2ltdWxhdGUpIHtcbiAgdmFyIG1vdmVzID0gW107XG4gIHZhciBjb29yZGluYXRlcyA9IFtbMCwgMV0sIFswLCAtMV0sIFsxLCAxXSwgWy0xLCAtMV0sIFsxLCAtMV0sIFstMSwgMV0sIFstMSwgMF0sIFsxLCAwXV07XG4gIHZhciB4ID0gdGhpcy54O1xuICB2YXIgeSA9IHRoaXMueTtcbiAgdmFyIGdhbWUgPSB0aGlzLmdhbWU7XG4gIHZhciB0dXJuID0gZ2FtZS50dXJuO1xuICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgY29vcmRpbmF0ZXMuZm9yRWFjaChmdW5jdGlvbiAoY29vcmQpIHtcbiAgICB2YXIgcGllY2U7XG4gICAgdmFyIHh4ID0geCArIGNvb3JkWzBdO1xuICAgIHZhciB5eSA9IHkgKyBjb29yZFsxXTtcblxuICAgIGlmICh4eCA8IDggJiYgeHggPj0gMCAmJiB5eSA8IDggJiYgeXkgPj0gMCkge1xuICAgICAgcGllY2UgPSBnYW1lLmJvYXJkW3l5XVt4eF07XG4gICAgICBpZiAoIXBpZWNlIHx8IHBpZWNlLmNvbG9yICE9PSBzZWxmLmNvbG9yKSB7XG4gICAgICAgIG1vdmVzLnB1c2goeyB4OiB4eCwgeTogeXkgfSk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICAvLyBDaGVjayBraW5nIGhhc24ndCBtb3ZlZFxuICB2YXIga2luZ01vdmVkID0gdHVybi5zb21lKGZ1bmN0aW9uICh0dXJuKSB7XG4gICAgcmV0dXJuIHR1cm4udHlwZSA9PT0gJ2tpbmcnICYmIHR1cm4uY29sb3IgPT09IHNlbGYuY29sb3I7XG4gIH0pO1xuXG4gIGlmICgha2luZ01vdmVkKSB7XG4gICAgW1swLCAyLCAtMV0sIFs3LCA2LCArMV1dLmZvckVhY2goZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgICB2YXIgcm9va1ggPSBwcm9wc1swXTtcbiAgICAgIHZhciBuZXdLaW5nWCA9IHByb3BzWzFdO1xuICAgICAgdmFyIGRpciA9IHByb3BzWzJdO1xuICAgICAgdmFyIHJvb2sgPSBnYW1lLmJvYXJkW3ldW3Jvb2tYXTtcblxuICAgICAgLy8gQ2hlY2sgcm9vayBvbiBwb3NpdGlvblxuICAgICAgaWYgKCFyb29rIHx8ICFyb29rLnR5cGUgPT09ICdyb29rJykgcmV0dXJuO1xuXG4gICAgICAvLyBDaGVjayByb29rIGhhc24ndCBtb3ZlZFxuICAgICAgaWYgKHR1cm4uc29tZShmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgcmV0dXJuIGV2LmZyb20ueCA9PT0gcm9va1ggJiYgZXYuZnJvbS55ID09PSB5O1xuICAgICAgfSkpIHJldHVybjtcblxuICAgICAgLy8gQ2hlY2sgc3F1YXJlcyBlbXB0eSBhbmQgc2FmZVxuICAgICAgZm9yICh2YXIgeHggPSB4ICsgZGlyOyB4eCAhPT0gcm9va1g7IHh4ICs9IGRpcikge1xuICAgICAgICBpZiAoZ2FtZS5ib2FyZFt5XVt4eF0pIHJldHVybjtcbiAgICAgICAgdmFyIHNhZmUgPSB0cnVlO1xuICAgICAgICBnYW1lLmJvYXJkLmZvckVhY2goZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgZXYuZm9yRWFjaChmdW5jdGlvbiAoZXZ2KSB7XG4gICAgICAgICAgICBpZiAoZXZ2ICYmIGV2di50eXBlICE9PSAna2luZycgJiYgZXZ2LmNvbG9yICE9PSBzZWxmLmNvbG9yKSB7XG4gICAgICAgICAgICAgIGV2di5nZXRWYWxpZE1vdmVzKCkuZm9yRWFjaChmdW5jdGlvbiAoZXZNb3ZlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV2TW92ZSAmJiBldk1vdmUueSA9PT0geSAmJiBldk1vdmUueCA9PT0geHgpIHNhZmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXNhZmUpIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHJvY2hhZGUgPSB7XG4gICAgICAgIHg6IG5ld0tpbmdYLFxuICAgICAgICB5OiB5LFxuICAgICAgICBtb3ZlUGllY2U6IHtcbiAgICAgICAgICBwaWVjZTogc2VsZi5nYW1lLmJvYXJkW3ldW3Jvb2tYXSxcbiAgICAgICAgICBmcm9tOiB7XG4gICAgICAgICAgICB4OiByb29rWCwgeTogeVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdG86IHtcbiAgICAgICAgICAgIHk6IHksIHg6IHggKyBkaXJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIG1vdmVzLnB1c2gocm9jaGFkZSk7XG4gICAgfSk7XG4gIH1cblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3Zlcywgc2VsZik7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5raW5nID0gZnVuY3Rpb24gKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIHJldHVybiBuZXcgS2luZyh4LCB5LCBjb2xvciwgZ2FtZSk7XG59O1xuXG5leHBvcnRzLlBpZWNlID0gUGllY2U7XG5leHBvcnRzLlBhd24gPSBQYXduO1xuZXhwb3J0cy5Sb29rID0gUm9vaztcbmV4cG9ydHMuS25pZ2h0ID0gS25pZ2h0O1xuZXhwb3J0cy5CaXNob3AgPSBCaXNob3A7XG5leHBvcnRzLlF1ZWVuID0gUXVlZW47XG5leHBvcnRzLktpbmcgPSBLaW5nO1xuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuQUkgPSBleHBvcnRzLlBpZWNlcyA9IGV4cG9ydHMuR2FtZSA9IHVuZGVmaW5lZDtcblxudmFyIF9nYW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxudmFyIF9nYW1lMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dhbWUpO1xuXG52YXIgX3BpZWNlcyA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cbnZhciBQaWVjZXMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfcGllY2VzKTtcblxudmFyIF9BSSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cbnZhciBfQUkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQUkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfVxuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vLyBBbmQgZXhwb3J0Li4uXG5leHBvcnRzLkdhbWUgPSBfZ2FtZTIuZGVmYXVsdDtcbmV4cG9ydHMuUGllY2VzID0gUGllY2VzO1xuZXhwb3J0cy5BSSA9IF9BSTIuZGVmYXVsdDsgLy8gTGV0J3MgaW1wb3J0Li4uXG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2dhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgX2dhbWUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2FtZSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBDaGVzc0FJID0gZnVuY3Rpb24gQ2hlc3NBSShkZXB0aCwgZ2FtZVN0YXRlLCBpc01heGltaXNpbmdQbGF5ZXIpIHtcbiAgLy8gQ2xvbmUgdGhlIGdhbWVTdGF0ZSB0byBhY2Nlc3MgYWxsIGdhbWUgYXNzb2NpYXRlZCBtZXRob2RzLlxuICAvLyBUaGlzIHVzdWFsbHkgZG9lc24ndCBtYWtlIHNlbnNlLCBidXQgc29tZXRpbWVzIHlvdSBjYW5ub3QgcG9zdCBmdW5jdGlvbnMgdG8gYSBiYWNrZW5kIG9yIGEgd2ViLXdvcmtlclxuICAvLyBhbmQgdGhhdCdzIHdoeSB3ZSdyZSB0b3VjaGluZyB0aGUgZ2FtZSBtZXRob2RzIGZyb20gbmV3IGdhbWUgY29uZmlndXJhdGlvbiBpbnRlYWQgZnJvbSB0aGUgcGFzc2VkIGFyZ3VtZW50LlxuICAvLyBTbyBpZiB5b3UgcGFzcyB7Ym9hcmQ6IFtteUJvYXJkXSwgdHVybjpbbXlUdXJuXSwuLi59IGZvciB0aGUgZ2FtZSBhcmd1bWVudCBpdCB3aWxsIGFjdHVhbGx5IHdvcmshXG4gIC8vIEFscmVhZHkgZGVzY3JpYmVkIGhlcmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9SU0ctR3JvdXAvQ2hlc3MvaXNzdWVzLzgjaXNzdWVjb21tZW50LTM4MTI0NTc5NFxuICB2YXIgZ2FtZSA9IF9nYW1lMi5kZWZhdWx0LnByb3RvdHlwZS5pbml0aWFsaXplR2FtZSgpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHtcbiAgICAgIGlmIChnYW1lU3RhdGUuYm9hcmRbaV1bal0pIHtcbiAgICAgICAgdmFyIGN1cnJlbnRDZWxsID0gZ2FtZVN0YXRlLmJvYXJkW2ldW2pdO1xuICAgICAgICBnYW1lLnBpZWNlKGN1cnJlbnRDZWxsLnR5cGUsIGosIGksIGN1cnJlbnRDZWxsLmNvbG9yKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdhbWUuYm9hcmRbaV1bal0gPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdhbWUudHVybiA9IGdhbWVTdGF0ZS50dXJuO1xuICBnYW1lLnRocmVlZm9sZCA9IGdhbWVTdGF0ZS50aHJlZWZvbGQ7XG4gIGdhbWUuRkVOID0gZ2FtZVN0YXRlLkZFTjtcbiAgZ2FtZS5GRU5ib2FyZCA9IGdhbWVTdGF0ZS5GRU5ib2FyZDtcblxuICAvLyBTdGFydCBsb29waW5nIGFuZCBzaW11bGF0aW5nIGFsbCB2YWxpZCBtb3Zlc1xuICB2YXIgYWxsTW92ZXMgPSBnYW1lLmFsbE1vdmVzKCk7XG4gIHZhciBiZXN0VmFsdWUgPSAtOTk5OTtcbiAgdmFyIGJlc3RNb3ZlO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsTW92ZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbmV3R2FtZU1vdmUgPSBhbGxNb3Zlc1tpXTtcbiAgICB2YXIgdW5kbyA9IGdhbWUuc2ltcGxlTW92ZShuZXdHYW1lTW92ZSk7XG4gICAgdmFyIGJvcmFkVmFsdWUgPSBtaW5pbWF4KGRlcHRoIC0gMSwgZ2FtZSwgLTEwMDAwLCAxMDAwMCwgIWlzTWF4aW1pc2luZ1BsYXllcik7XG4gICAgdW5kbygpO1xuICAgIGlmIChib3JhZFZhbHVlID49IGJlc3RWYWx1ZSkge1xuICAgICAgYmVzdFZhbHVlID0gYm9yYWRWYWx1ZTtcbiAgICAgIGJlc3RNb3ZlID0gbmV3R2FtZU1vdmU7XG4gICAgfVxuICB9XG4gIHJldHVybiBiZXN0TW92ZTtcbn07IC8vXG4vLyBSU0cgQ2hlc3Ncbi8vIExpY2Vuc2VkIHVuZGVyIEFwYWNoZSAyLjAgTElDRU5TRVxuXG52YXIgbWluaW1heCA9IGZ1bmN0aW9uIG1pbmltYXgoZGVwdGgsIGdhbWUsIGFscGhhLCBiZXRhLCBpc01heGltaXNpbmdQbGF5ZXIpIHtcbiAgaWYgKGRlcHRoID09PSAwKSB7XG4gICAgcmV0dXJuIC1ldmFsdWF0ZUJvYXJkKGdhbWUuYm9hcmQpO1xuICB9XG5cbiAgdmFyIGFsbE1vdmVzID0gZ2FtZS5hbGxNb3ZlcygpO1xuICBpZiAoaXNNYXhpbWlzaW5nUGxheWVyKSB7XG4gICAgdmFyIGJlc3RWYWx1ZSA9IC05OTk5O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsTW92ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciB1bmRvID0gZ2FtZS5zaW1wbGVNb3ZlKGFsbE1vdmVzW2ldKTtcbiAgICAgIGJlc3RWYWx1ZSA9IE1hdGgubWF4KGJlc3RWYWx1ZSwgbWluaW1heChkZXB0aCAtIDEsIGdhbWUsIGFscGhhLCBiZXRhLCAhaXNNYXhpbWlzaW5nUGxheWVyKSk7XG4gICAgICB1bmRvKCk7XG4gICAgICBhbHBoYSA9IE1hdGgubWF4KGFscGhhLCBiZXN0VmFsdWUpO1xuICAgICAgaWYgKGJldGEgPD0gYWxwaGEpIHtcbiAgICAgICAgcmV0dXJuIGJlc3RWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJlc3RWYWx1ZTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgX2Jlc3RWYWx1ZSA9IDk5OTk7XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFsbE1vdmVzLmxlbmd0aDsgX2krKykge1xuICAgICAgdmFyIF91bmRvID0gZ2FtZS5zaW1wbGVNb3ZlKGFsbE1vdmVzW19pXSk7XG4gICAgICBfYmVzdFZhbHVlID0gTWF0aC5taW4oX2Jlc3RWYWx1ZSwgbWluaW1heChkZXB0aCAtIDEsIGdhbWUsIGFscGhhLCBiZXRhLCAhaXNNYXhpbWlzaW5nUGxheWVyKSk7XG4gICAgICBfdW5kbygpO1xuICAgICAgYmV0YSA9IE1hdGgubWluKGJldGEsIF9iZXN0VmFsdWUpO1xuICAgICAgaWYgKGJldGEgPD0gYWxwaGEpIHtcbiAgICAgICAgcmV0dXJuIF9iZXN0VmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBfYmVzdFZhbHVlO1xuICB9XG59O1xuXG52YXIgZXZhbHVhdGVCb2FyZCA9IGZ1bmN0aW9uIGV2YWx1YXRlQm9hcmQoYm9hcmQpIHtcbiAgdmFyIHRvdGFsRXZhbHVhdGlvbiA9IDA7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHtcbiAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgY3VycmVudCBldmFsdWF0aW9uXG4gICAgICB0b3RhbEV2YWx1YXRpb24gPSB0b3RhbEV2YWx1YXRpb24gKyBnZXRQaWVjZVZhbHVlKGJvYXJkW2ldW2pdKTtcbiAgICB9XG4gIH1cbiAgLy8gcmV0dXJuIHRoZSB0b3RhbCBldmFsdWF0aW9uXG4gIHJldHVybiB0b3RhbEV2YWx1YXRpb247XG59O1xuXG52YXIgZ2V0UGllY2VWYWx1ZSA9IGZ1bmN0aW9uIGdldFBpZWNlVmFsdWUocGllY2UpIHtcbiAgaWYgKHBpZWNlID09PSBudWxsKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cblxuICAvLyBnZXQgdmFsdWUgZm9yIGV2ZXJ5IHBpZWNlIG9uIHRoZSBib2FyZFxuICB2YXIgZ2V0QWJzb2x1dGVWYWx1ZSA9IGZ1bmN0aW9uIGdldEFic29sdXRlVmFsdWUocGllY2UpIHtcbiAgICBpZiAocGllY2UudHlwZSA9PT0gJ3Bhd24nKSB7XG4gICAgICByZXR1cm4gMTA7XG4gICAgfSBlbHNlIGlmIChwaWVjZS50eXBlID09PSAncm9vaycpIHtcbiAgICAgIHJldHVybiA1MDtcbiAgICB9IGVsc2UgaWYgKHBpZWNlLnR5cGUgPT09ICdrbmlnaHQnKSB7XG4gICAgICByZXR1cm4gMzA7XG4gICAgfSBlbHNlIGlmIChwaWVjZS50eXBlID09PSAnYmlzaG9wJykge1xuICAgICAgcmV0dXJuIDMwO1xuICAgIH0gZWxzZSBpZiAocGllY2UudHlwZSA9PT0gJ3F1ZWVuJykge1xuICAgICAgcmV0dXJuIDkwO1xuICAgIH0gZWxzZSBpZiAocGllY2UudHlwZSA9PT0gJ2tpbmcnKSB7XG4gICAgICByZXR1cm4gOTAwO1xuICAgIH1cbiAgfTtcblxuICAvLyBjYWxjdWxhdGUgdGhlIGFic29sdXRlIHZhbHVlIGFuZCByZXR1cm4gaXRcbiAgdmFyIGFic29sdXRlVmFsdWUgPSBnZXRBYnNvbHV0ZVZhbHVlKHBpZWNlLCBwaWVjZS5jb2xvciA9PT0gJ1cnKTtcbiAgcmV0dXJuIHBpZWNlLmNvbG9yID09PSAnVycgPyBhYnNvbHV0ZVZhbHVlIDogLWFic29sdXRlVmFsdWU7XG59O1xuXG4vLyBleHBvcnQgdGhlIGFsZ29yaXRobVxuZXhwb3J0cy5kZWZhdWx0ID0gQ2hlc3NBSTtcblxuLy8gV3JpdHRlbiBieSBSYWRpIENob1xuLy8gUlNHIENoZXNzIC0gYnkgUlNHIEdyb3VwXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd29ya2VyLm1pbi5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDcxMDQwMmMwZGQ0MDYwYzZhMGRkIiwiLy8gc2VsZi5pbXBvcnRTY3JpcHRzKFwiZ2FtZS5qc1wiKTtcclxuaW1wb3J0IHsgQUkgfSBmcm9tICdyc2ctY2hlc3MnXHJcblxyXG5zZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZSkge1xyXG4gIGlmIChlLmRhdGEgJiYgZS5kYXRhLmdhbWUgJiYgZS5kYXRhLnBsYXlBZ2FpbnN0QUkpIHtcclxuICAgIHZhciBiZXN0TW92ZSA9IEFJKGUuZGF0YS5wbGF5QWdhaW5zdEFJLmRlcHRoLCBlLmRhdGEuZ2FtZSwgdHJ1ZSlcclxuICAgIHNlbGYucG9zdE1lc3NhZ2UoYmVzdE1vdmUpXHJcbiAgfVxyXG59KVxyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9qcy93b3JrZXIuanMiLCIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShcInJzZy1jaGVzc1wiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJyc2ctY2hlc3NcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wicnNnLWNoZXNzXCJdID0gZmFjdG9yeSgpO1xufSkodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAyKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9waWVjZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXG5mdW5jdGlvbiBHYW1lKHByb21vQ2FsbGJhY2spIHtcbiAgLy8gdGhlIGdhbWUgYm9hcmRcbiAgdGhpcy5ib2FyZCA9IFtdO1xuICAvLyBmaWxsIHRoZSBib2FyZFxuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIHZhciBhcnJheUluID0gW107XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHtcbiAgICAgIGFycmF5SW4ucHVzaChudWxsKTtcbiAgICB9XG4gICAgdGhpcy5ib2FyZC5wdXNoKGFycmF5SW4pO1xuICB9XG5cbiAgLy8gdGhlIGhpc3Rvcnkgb2YgYWxsIHR1cm5zXG4gIHRoaXMudHVybiA9IFtdO1xuICAvLyB0aGUgY3VycmVudCBGRU4gc3RhdHVzXG4gIHRoaXMuRkVOID0gW107XG4gIC8vIHRoZSBjdXJyZW50IGdhbWUgY29uZmlndXJhdGlvbiBhcyBGRU5cbiAgdGhpcy5GRU5ib2FyZCA9IFtdO1xuICAvLyB0aGUgaGlzdG9yeSBvZiBhbGwgZ2FtZSBjb25maWd1cmF0aW9ucyBkaXNwbGF5ZWQgdXNpbmcgRkVOXG4gIHRoaXMudGhyZWVmb2xkID0gW107XG59XG5cbkdhbWUucHJvdG90eXBlLnBpZWNlID0gZnVuY3Rpb24gKHR5cGUsIHgsIHksIGNvbG9yKSB7XG4gIHZhciBwaWVjZSA9IF9waWVjZXMuUGllY2VbdHlwZV0oeCwgeSwgY29sb3IsIHRoaXMpO1xuICB0aGlzLmJvYXJkW3ldW3hdID0gcGllY2U7XG5cbiAgdGhpcy5GRU4gPSB0aGlzLmdhbWVUb0ZFTigpO1xuICB0aGlzLkZFTmJvYXJkID0gdGhpcy5ib2FyZFRvRkVOKCk7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5tb3ZlU2VsZWN0ZWQgPSBmdW5jdGlvbiAoc2VsZWN0ZWQsIHRvLCBwcm9tb3Rpb25DYWxsYmFjaywgY2hlY2ttYXRlQ2FsbGJhY2ssIHNpbXVsYXRlKSB7XG4gIHZhciB4ID0gdG8ueDtcbiAgdmFyIHkgPSB0by55O1xuXG4gIGlmIChzZWxlY3RlZCkge1xuICAgIHZhciBmcm9tID0geyB4OiBzZWxlY3RlZC54LCB5OiBzZWxlY3RlZC55IH07XG5cbiAgICBpZiAodGhpcy5ib2FyZFt5XVt4XSAhPT0gc2VsZWN0ZWQpIHtcbiAgICAgIHZhciB2YWxpZE1vdmVzID0gc2VsZWN0ZWQuZ2V0VmFsaWRNb3Zlcyghc2ltdWxhdGUpO1xuICAgICAgdmFyIHZhbGlkTW92ZSA9IG51bGw7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsaWRNb3Zlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgdm0gPSB2YWxpZE1vdmVzW2ldO1xuICAgICAgICBpZiAodm0ueCA9PT0geCAmJiB2bS55ID09PSB5KSB7XG4gICAgICAgICAgdmFsaWRNb3ZlID0gdm07XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCF2YWxpZE1vdmUpIHJldHVybiBmYWxzZTtcbiAgICAgIHZhciBtb3ZlUGllY2UgPSB2YWxpZE1vdmUubW92ZVBpZWNlO1xuICAgICAgdmFyIHRha2UsIHBhc3RlLCByb29rO1xuICAgICAgaWYgKG1vdmVQaWVjZSkge1xuICAgICAgICB0YWtlID0gbW92ZVBpZWNlLmZyb207XG4gICAgICAgIHBhc3RlID0gbW92ZVBpZWNlLnRvO1xuICAgICAgICBpZiAocGFzdGUgPT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLmJvYXJkW3Rha2UueV1bdGFrZS54XSA9IG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcm9vayA9IHRoaXMuYm9hcmRbdGFrZS55XVt0YWtlLnhdO1xuICAgICAgICAgIHRoaXMuYm9hcmRbcGFzdGUueV1bcGFzdGUueF0gPSByb29rO1xuICAgICAgICAgIHJvb2sueCA9IHBhc3RlLng7XG4gICAgICAgICAgcm9vay55ID0gcGFzdGUueTtcbiAgICAgICAgICB0aGlzLmJvYXJkW3Rha2UueV1bdGFrZS54XSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIHBpZWNlID0gdGhpcy5ib2FyZFt5XVt4XSA/IHRoaXMuYm9hcmRbeV1beF0gOiBudWxsO1xuICAgICAgbW92ZVBpZWNlID0gbW92ZVBpZWNlID8gdmFsaWRNb3ZlLm1vdmVQaWVjZSA6IG51bGw7XG4gICAgICB0aGlzLnR1cm4ucHVzaCh7XG4gICAgICAgIGZyb206IGZyb20sXG4gICAgICAgIHRvOiB0byxcbiAgICAgICAgY29sb3I6IHNlbGVjdGVkLmNvbG9yLFxuICAgICAgICB0eXBlOiBzZWxlY3RlZC50eXBlLFxuICAgICAgICBwaWVjZTogcGllY2UsXG4gICAgICAgIG1vdmVQaWVjZTogbW92ZVBpZWNlXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5ib2FyZFt5XVt4XSA9IHNlbGVjdGVkO1xuICAgICAgdGhpcy5ib2FyZFtzZWxlY3RlZC55XVtzZWxlY3RlZC54XSA9IG51bGw7XG4gICAgICB0aGlzLmJvYXJkW3ldW3hdLnggPSB4O1xuICAgICAgdGhpcy5ib2FyZFt5XVt4XS55ID0geTtcblxuICAgICAgdGhpcy5GRU4gPSB0aGlzLmdhbWVUb0ZFTigpO1xuICAgICAgdGhpcy5GRU5ib2FyZCA9IHRoaXMuYm9hcmRUb0ZFTigpO1xuICAgICAgLy8gY2hlY2sgZm9yIHRocmVlZm9sZCByZXBldGl0aW9uXG5cbiAgICAgIHRoaXMudGhyZWVmb2xkLnB1c2godGhpcy5GRU5ib2FyZCk7XG4gICAgICBpZiAoc2VsZWN0ZWQudHlwZSA9PT0gJ3Bhd24nIHx8IHBpZWNlKSB0aGlzLnRocmVlZm9sZCA9IFtdO1xuICAgICAgaWYgKHRoaXMudGhyZWVmb2xkQ2hlY2soKSkgY2hlY2ttYXRlQ2FsbGJhY2soJ0QnKTtcblxuICAgICAgLy8gY2hlY2sgZm9yIHRoZSBmaWZ0eS1tb3ZlIHJ1bGVcbiAgICAgIGlmICh0aGlzLmhhbGZtb3ZlQ2xvY2soKSA+PSA1MCkgY2hlY2ttYXRlQ2FsbGJhY2soJ0QnKTtcblxuICAgICAgLy8gY2hlY2sgZm9yIHBhd24gcHJvbW90aW9uXG4gICAgICBpZiAoc2VsZWN0ZWQudHlwZSA9PT0gJ3Bhd24nICYmIHkgIT09IHNlbGVjdGVkLnkpIHtcbiAgICAgICAgaWYgKHNlbGVjdGVkLmNvbG9yID09PSAnVycgJiYgeSA9PT0gMCB8fCBzZWxlY3RlZC5jb2xvciA9PT0gJ0InICYmIHkgPT09IDcpIHtcbiAgICAgICAgICBpZiAocHJvbW90aW9uQ2FsbGJhY2spIHByb21vdGlvbkNhbGxiYWNrKHNlbGVjdGVkLCB4LCB5LCBzZWxlY3RlZC5jb2xvcik7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHZhciBjaGVja21hdGVDb2xvciA9IHNlbGVjdGVkLmNvbG9yID09PSAnVycgPyAnQicgOiAnVyc7XG4gICAgICB2YXIgY2hlY2ttYXRlVmFsdWUgPSB0aGlzLmNoZWNrbWF0ZShjaGVja21hdGVDb2xvcik7XG4gICAgICBpZiAoY2hlY2ttYXRlVmFsdWUpIGNoZWNrbWF0ZUNhbGxiYWNrKGNoZWNrbWF0ZVZhbHVlKTtcblxuICAgICAgLy8gLy8gUGxheSBBSVxuICAgICAgLy8gV2UgZGVjaWRlZCB0byByZW1vdmUgdGhlIEFJIG1vdmVtZW50cyBmcm9tIGdhbWUuanMsIGJlY2F1c2UgdGhpcyBzbG93cyBkb3duIHlvdXIgYXBwXG4gICAgICAvLyBhbmQgbWFrZXMgcmVhbGx5IGhhcmQgdG8gaW1wbGVtZW50IGV4dGVybmFsIGNoZXNzIHNvdXJjZXMgbGlrZTogd2ViIHdvcmtlcnMsIGJhY2tlbmRzLCBjbG91ZCBmdW5jdGlvbnMsIGVjdC5cbiAgICB9XG4gICAgc2VsZWN0ZWQgPSBudWxsO1xuICAgIHJldHVybiB0cnVlO1xuICAgIC8vIGVuZFxuICB9XG59O1xuXG5HYW1lLnByb3RvdHlwZS5wcm9tb3RlUGF3biA9IGZ1bmN0aW9uIChwYXduLCB4LCB5LCBjb2xvciwgdHlwZSkge1xuICB0aGlzLnBpZWNlKHR5cGUsIHgsIHksIGNvbG9yKTtcbn07XG5cbkdhbWUucHJvdG90eXBlLnNpbXVsYXRlQW5kRmlsdGVyID0gZnVuY3Rpb24gKG1vdmVzLCBwaWVjZSkge1xuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciBib2FyZCA9IHRoaXMuYm9hcmQ7XG5cbiAgbW92ZXMuZm9yRWFjaChmdW5jdGlvbiAobW92ZSwgaSkge1xuICAgIHZhciB5ID0gbW92ZS55O1xuICAgIHZhciB4ID0gbW92ZS54O1xuICAgIHZhciBmcm9tID0geyB4OiBwaWVjZS54LCB5OiBwaWVjZS55IH07XG4gICAgdmFyIG1vdmVQaWVjZSA9IGJvYXJkW3ldW3hdID8ge1xuICAgICAgcGllY2U6IGJvYXJkW3ldW3hdLFxuICAgICAgZnJvbTogeyB4OiB4LCB5OiB5IH0sXG4gICAgICB0bzogbnVsbFxuICAgIH0gOiBudWxsO1xuXG4gICAgaWYgKG1vdmUubW92ZVBpZWNlKSBtb3ZlUGllY2UgPSBtb3ZlLm1vdmVQaWVjZTtcbiAgICBpZiAobW92ZVBpZWNlKSBzZWxmLnNpbXBsZU1vdmVQaWVjZShtb3ZlUGllY2UucGllY2UsIG1vdmVQaWVjZS5mcm9tLCBtb3ZlUGllY2UudG8pO1xuXG4gICAgc2VsZi5zaW1wbGVNb3ZlUGllY2UocGllY2UsIGZyb20sIHsgeDogeCwgeTogeSB9KTtcbiAgICB2YXIgd2FybmluZyA9IHNlbGYud2FybmluZyhwaWVjZS5jb2xvcik7XG5cbiAgICAvLyBSZXR1cm4ga2luZ1xuICAgIHNlbGYuc2ltcGxlTW92ZVBpZWNlKHBpZWNlLCB7IHg6IHgsIHk6IHkgfSwgZnJvbSk7XG5cbiAgICAvLyByZXR1cm4gdGhlIG1vdmVQaWVjZSB3aXRoIHNpbXBsZU1vdmVQaWVjZSgpIG1ldGhvZFxuICAgIGlmIChtb3ZlUGllY2UpIHNlbGYuc2ltcGxlTW92ZVBpZWNlKG1vdmVQaWVjZS5waWVjZSwgbW92ZVBpZWNlLnRvLCBtb3ZlUGllY2UuZnJvbSk7XG5cbiAgICBpZiAoIXdhcm5pbmcpIHZhbGlkTW92ZXMucHVzaChtb3ZlKTtcbiAgfSk7XG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuR2FtZS5wcm90b3R5cGUuY2hlY2ttYXRlID0gZnVuY3Rpb24gKGNvbG9yKSB7XG4gIC8vIHVzaW5nIGxldCB3aWxsIGFsbG93IHVzIHRvIG1ha2UgdGhlIGNvZGUgYSBiaXQgc2ltcGxlclxuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICBpZiAodGhpcy5ib2FyZFtpXVtqXSAmJiB0aGlzLmJvYXJkW2ldW2pdLmNvbG9yID09PSBjb2xvciAmJiB0aGlzLmJvYXJkW2ldW2pdLmdldFZhbGlkTW92ZXModHJ1ZSkubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIGlmICh0aGlzLndhcm5pbmcoY29sb3IpKSByZXR1cm4gY29sb3I7XG4gIHJldHVybiAnRCc7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5zaW1wbGVNb3ZlUGllY2UgPSBmdW5jdGlvbiAocGllY2UsIGZyb20sIHRvKSB7XG4gIHZhciBib2FyZCA9IHRoaXMuYm9hcmQ7XG4gIGlmICh0bykge1xuICAgIGJvYXJkW3RvLnldW3RvLnhdID0gcGllY2U7XG4gICAgcGllY2UueCA9IHRvLng7XG4gICAgcGllY2UueSA9IHRvLnk7XG4gIH1cbiAgaWYgKGZyb20pIGJvYXJkW2Zyb20ueV1bZnJvbS54XSA9IG51bGw7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5zaW1wbGVNb3ZlID0gZnVuY3Rpb24gKG1vdmUpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgYm9hcmQgPSBzZWxmLmJvYXJkO1xuICB2YXIgZnJvbSA9IG1vdmUuZnJvbTtcbiAgdmFyIHRvID0gbW92ZS50bztcbiAgdmFyIHBpZWNlID0gYm9hcmRbZnJvbS55XVtmcm9tLnhdO1xuICB2YXIgY2FwdHVyZWRQaWVjZSA9IHRoaXMuYm9hcmRbdG8ueV1bdG8ueF0gPyB0aGlzLmJvYXJkW3RvLnldW3RvLnhdIDogbnVsbDtcbiAgdmFyIG1vdmVQaWVjZSA9IGJvYXJkW3RvLnldW3RvLnhdID8ge1xuICAgIHBpZWNlOiBib2FyZFt0by55XVt0by54XSxcbiAgICBmcm9tOiB7IHg6IHRvLngsIHk6IHRvLnkgfSxcbiAgICB0bzogbnVsbFxuICB9IDogbnVsbDtcblxuICB0aGlzLnR1cm4ucHVzaCh7XG4gICAgZnJvbTogZnJvbSxcbiAgICB0bzogeyB4OiB0by54LCB5OiB0by55IH0sXG4gICAgY29sb3I6IG1vdmUuY29sb3IsXG4gICAgdHlwZTogcGllY2UudHlwZSxcbiAgICBwaWVjZTogY2FwdHVyZWRQaWVjZSxcbiAgICBtb3ZlUGllY2U6IG1vdmVQaWVjZVxuICB9KTtcblxuICBpZiAodG8ubW92ZVBpZWNlKSBtb3ZlUGllY2UgPSB0by5tb3ZlUGllY2U7XG4gIGlmIChtb3ZlUGllY2UpIHNlbGYuc2ltcGxlTW92ZVBpZWNlKG1vdmVQaWVjZS5waWVjZSwgbW92ZVBpZWNlLmZyb20sIG1vdmVQaWVjZS50byk7XG4gIHNlbGYuc2ltcGxlTW92ZVBpZWNlKHBpZWNlLCBmcm9tLCB7IHg6IHRvLngsIHk6IHRvLnkgfSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAvLyByZXR1cm4gdGhlIGN1cnJlbnQgbW92ZSAvZXYvXG4gICAgaWYgKG1vdmVQaWVjZSkgc2VsZi5zaW1wbGVNb3ZlUGllY2UobW92ZVBpZWNlLnBpZWNlLCBtb3ZlUGllY2UudG8sIG1vdmVQaWVjZS5mcm9tKTtcbiAgICBzZWxmLnNpbXBsZU1vdmVQaWVjZShwaWVjZSwgeyB4OiB0by54LCB5OiB0by55IH0sIGZyb20pO1xuICAgIGlmIChjYXB0dXJlZFBpZWNlKSBib2FyZFt0by55XVt0by54XSA9IGNhcHR1cmVkUGllY2U7XG4gICAgc2VsZi50dXJuLnBvcCgpO1xuICB9O1xufTtcblxuR2FtZS5wcm90b3R5cGUud2FybmluZyA9IGZ1bmN0aW9uIChjb2xvcikge1xuICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gIHZhciBraW5nO1xuXG4gIHRoaXMuYm9hcmQuZm9yRWFjaChmdW5jdGlvbiAoeXl5KSB7XG4gICAgeXl5LmZvckVhY2goZnVuY3Rpb24gKHh4eCkge1xuICAgICAgaWYgKHh4eCAmJiB4eHguY29sb3IgPT09IGNvbG9yICYmIHh4eC50eXBlID09PSAna2luZycpIHtcbiAgICAgICAga2luZyA9IHh4eDtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgdGhpcy5ib2FyZC5mb3JFYWNoKGZ1bmN0aW9uICh5eXkpIHtcbiAgICB5eXkuZm9yRWFjaChmdW5jdGlvbiAoeHh4KSB7XG4gICAgICBpZiAoeHh4ICYmIHh4eC5jb2xvciAhPT0gY29sb3IpIHtcbiAgICAgICAgeHh4LmdldFZhbGlkTW92ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChtbW0pIHtcbiAgICAgICAgICBpZiAobW1tLnggPT09IGtpbmcueCAmJiBtbW0ueSA9PT0ga2luZy55KSByZXN1bHQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5HYW1lLnByb3RvdHlwZS50aHJlZWZvbGRDaGVjayA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRocmVlZm9sZCA9IHRoaXMudGhyZWVmb2xkO1xuICB2YXIgbGVuZ3RoID0gdGhyZWVmb2xkLmxlbmd0aDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgLy8gdXNpbmcgbGV0IHdpbGwgYWxsb3cgdXMgdG8gbWFrZSB0aGUgY29kZSBzaW1wbGVyXG4gICAgdmFyIGNvdW50ID0gMDtcbiAgICBmb3IgKHZhciBqID0gaSArIDE7IGogPCBsZW5ndGg7IGorKykge1xuICAgICAgaWYgKHRocmVlZm9sZFtpXSA9PT0gdGhyZWVmb2xkW2pdKSBjb3VudCArPSAxO1xuICAgIH1cbiAgICBpZiAoY291bnQgPj0gMikgcmV0dXJuIHRydWU7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5waWVjZVRvQU4gPSBmdW5jdGlvbiAoeCwgeSkge1xuICB2YXIgeENoYXJzID0gJ2FiY2RlZmdoJztcbiAgcmV0dXJuIHhDaGFycy5jaGFyQXQoeCkgKyAoOCAtIHkpO1xufTtcblxuLy8gU3VwcG9ydCBGRU4gZnVuY3Rpb25zIGluIHRoZSBBUElcbkdhbWUucHJvdG90eXBlLmJvYXJkVG9GRU4gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBib2FyZCA9IHRoaXMuYm9hcmQ7XG5cbiAgLy8gQ29udmVydCB0aGUgYm9hcmQgY29uZmlndXJhdGlvbiBpbnRvIEZFTlxuICB2YXIgRkVOYm9hcmQgPSAnJztcbiAgdmFyIG1pc3NpbmdQaWVjZXMgPSAwO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICBpZiAoYm9hcmRbaV1bal0pIHtcbiAgICAgICAgaWYgKG1pc3NpbmdQaWVjZXMpIEZFTmJvYXJkICs9IG1pc3NpbmdQaWVjZXM7XG4gICAgICAgIG1pc3NpbmdQaWVjZXMgPSAwO1xuICAgICAgICBGRU5ib2FyZCArPSBib2FyZFtpXVtqXS5GRU5uYW1lO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWlzc2luZ1BpZWNlcysrO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAobWlzc2luZ1BpZWNlcykgRkVOYm9hcmQgKz0gbWlzc2luZ1BpZWNlcztcbiAgICBtaXNzaW5nUGllY2VzID0gMDtcbiAgICBGRU5ib2FyZCArPSBpIDwgNyA/ICcvJyA6ICcnO1xuICB9XG5cbiAgcmV0dXJuIEZFTmJvYXJkO1xufTtcblxuR2FtZS5wcm90b3R5cGUuaGFsZm1vdmVDbG9jayA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHR1cm4gPSB0aGlzLnR1cm47XG4gIHZhciBsZW5ndGggPSB0dXJuLmxlbmd0aDtcbiAgdmFyIGNvdW50ID0gMDtcbiAgaWYgKHR1cm4ubGVuZ3RoID09PSAwKSByZXR1cm4gY291bnQ7XG5cbiAgdmFyIGV2ID0gdHVybltsZW5ndGggLSAxIC0gY291bnRdO1xuICB3aGlsZSAoY291bnQgPD0gbGVuZ3RoIC0gMSAmJiBldi50eXBlICE9PSAncGF3bicgJiYgIWV2LnBpZWNlKSB7XG4gICAgY291bnQrKztcbiAgICBldiA9IHR1cm5bbGVuZ3RoIC0gMSAtIGNvdW50XTtcbiAgfVxuXG4gIHJldHVybiBjb3VudDtcbn07XG5cbkdhbWUucHJvdG90eXBlLmFjdGl2ZUNvbG91ciA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHR1cm4gPSB0aGlzLnR1cm47XG4gIHZhciBhY3RpdmVDb2xvciA9IHR1cm4ubGVuZ3RoICYmIHR1cm5bdHVybi5sZW5ndGggLSAxXS5jb2xvciA9PT0gJ1cnID8gJ2InIDogJ3cnO1xuXG4gIHJldHVybiBhY3RpdmVDb2xvcjtcbn07XG5cbkdhbWUucHJvdG90eXBlLmNhc3RsaW5nVGFyZ2V0ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuICB2YXIgdHVybiA9IHRoaXMudHVybjtcbiAgdmFyIHBvc3NpYmxlQ2FzdGxpbmcgPSAnJztcblxuICB2YXIgd2hpdGVLaW5nTW92ZWQ7XG4gIHZhciBibGFja0tpbmdNb3ZlZDtcbiAgdHVybi5mb3JFYWNoKGZ1bmN0aW9uICh0dXJuKSB7XG4gICAgd2hpdGVLaW5nTW92ZWQgPSB0dXJuLnR5cGUgPT09ICdraW5nJyAmJiB0dXJuLmNvbG9yID09PSAnVyc7XG4gICAgYmxhY2tLaW5nTW92ZWQgPSB0dXJuLnR5cGUgPT09ICdraW5nJyAmJiB0dXJuLmNvbG9yID09PSAnQic7XG4gIH0pO1xuXG4gIFtbNywgMF0sIFswLCAwXSwgWzcsIDddLCBbMCwgN11dLmZvckVhY2goZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgdmFyIHJvb2tYID0gcHJvcHNbMF07XG4gICAgdmFyIHJvb2tZID0gcHJvcHNbMV07XG4gICAgdmFyIHJvb2sgPSBib2FyZFtyb29rWV1bcm9va1hdO1xuXG4gICAgaWYgKHJvb2tZID09PSA3ICYmIHdoaXRlS2luZ01vdmVkKSByZXR1cm47XG4gICAgaWYgKHJvb2tZID09PSAwICYmIGJsYWNrS2luZ01vdmVkKSByZXR1cm47XG5cbiAgICAvLyBDaGVjayByb29rIG9uIHBvc2l0aW9uXG4gICAgaWYgKCFyb29rIHx8ICFyb29rLnR5cGUgPT09ICdyb29rJykgcmV0dXJuO1xuXG4gICAgLy8gQ2hlY2sgcm9vayBoYXNuJ3QgbW92ZWRcbiAgICBpZiAodHVybi5zb21lKGZ1bmN0aW9uIChldikge1xuICAgICAgaWYgKGV2LnR5cGUgIT09ICdyb29rJykgcmV0dXJuIGZhbHNlO1xuICAgICAgcmV0dXJuIGV2LmZyb20ueCA9PT0gcm9va1ggJiYgZXYuZnJvbS55ID09PSByb29rWTtcbiAgICB9KSkgcmV0dXJuO1xuXG4gICAgdmFyIGNhc3RsaW5nU2lkZSA9IHJvb2tYID09PSAwID8gJ3EnIDogJ2snO1xuICAgIHBvc3NpYmxlQ2FzdGxpbmcgKz0gcm9va1kgPT09IDAgPyBjYXN0bGluZ1NpZGUudG9VcHBlckNhc2UoKSA6IGNhc3RsaW5nU2lkZTtcbiAgfSk7XG5cbiAgaWYgKCFwb3NzaWJsZUNhc3RsaW5nKSBwb3NzaWJsZUNhc3RsaW5nID0gJy0nO1xuICByZXR1cm4gcG9zc2libGVDYXN0bGluZztcbn07XG5cbkdhbWUucHJvdG90eXBlLmVuUGFzc2FudFRhcmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHR1cm4gPSB0aGlzLnR1cm47XG4gIHZhciBlblBhc3NhbnRUYXJnZXQgPSAnJztcblxuICBpZiAodHVybi5sZW5ndGgpIHtcbiAgICB2YXIgZXYgPSB0dXJuW3R1cm4ubGVuZ3RoIC0gMV07XG4gICAgaWYgKGV2LmNvbG9yID09PSAnVycgJiYgZXYudG8ueSA9PT0gNCkge1xuICAgICAgZW5QYXNzYW50VGFyZ2V0ID0gdGhpcy5waWVjZVRvQU4oZXYudG8ueCwgZXYudG8ueSArIDEpO1xuICAgIH1cblxuICAgIGlmIChldi5jb2xvciA9PT0gJ0InICYmIGV2LnRvLnkgPT09IDMpIHtcbiAgICAgIGVuUGFzc2FudFRhcmdldCA9IHRoaXMucGllY2VUb0FOKGV2LnRvLngsIGV2LnRvLnkgLSAxKTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWVuUGFzc2FudFRhcmdldCkgZW5QYXNzYW50VGFyZ2V0ID0gJy0nO1xuICByZXR1cm4gZW5QYXNzYW50VGFyZ2V0O1xufTtcblxuR2FtZS5wcm90b3R5cGUuZnVsbG1vdmVDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNvdW50ID0gMTtcbiAgdGhpcy50dXJuLmZvckVhY2goZnVuY3Rpb24gKGV2KSB7XG4gICAgaWYgKGV2LmNvbG9yID09PSAnQicpIGNvdW50ICs9IDE7XG4gIH0pO1xuXG4gIHJldHVybiBjb3VudDtcbn07XG5cbkdhbWUucHJvdG90eXBlLmdhbWVUb0ZFTiA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIEZFTiA9ICcnO1xuXG4gIC8vIENoZWNrIHRoZSBib2FyZCBjb25maWd1cmF0aW9uXG4gIEZFTiArPSB0aGlzLmJvYXJkVG9GRU4oKTtcblxuICAvLyBGaW5kIHRoZSBhY3RpdmUgY29sb3VyXG4gIEZFTiArPSAnICcgKyB0aGlzLmFjdGl2ZUNvbG91cigpO1xuXG4gIC8vIENoZWNrIGNhc3RsaW5nIGF2YWlsYWJpbGl0eVxuICBGRU4gKz0gJyAnICsgdGhpcy5jYXN0bGluZ1RhcmdldCgpO1xuXG4gIC8vIENoZWNrIHRoZSBFbi1wYXNzYW50IHRhcmdldFxuICBGRU4gKz0gJyAnICsgdGhpcy5lblBhc3NhbnRUYXJnZXQoKTtcblxuICAvLyBBZGQgdGhlIGhhbGZtb3ZlIGNsb2NrXG4gIEZFTiArPSAnICcgKyB0aGlzLmhhbGZtb3ZlQ2xvY2soKTtcblxuICAvLyBBZGQgdGhlIGZ1bGxtb3ZlIG51bWJlclxuICBGRU4gKz0gJyAnICsgdGhpcy5mdWxsbW92ZUNvdW50KCk7XG5cbiAgLypcclxuICAgIE1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIEZFTiBub3RhdGlvbjpcclxuICAgIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0ZvcnN5dGglRTIlODAlOTNFZHdhcmRzX05vdGF0aW9uXHJcbiAgICBodHRwczovL2NoZXNzcHJvZ3JhbW1pbmcud2lraXNwYWNlcy5jb20vRm9yc3l0aC1FZHdhcmRzK05vdGF0aW9uXHJcbiAgKi9cblxuICByZXR1cm4gRkVOO1xufTtcblxuLy8gU2V0IHVwIGRlZmF1bHQgZ2FtZSBjb25maWd1cmF0aW9uXG5HYW1lLnByb3RvdHlwZS5pbml0aWFsaXplR2FtZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGRlZmF1bHRHYW1lID0gbmV3IEdhbWUoKTtcblxuICAvLyBQYXduczpcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBkZWZhdWx0R2FtZS5waWVjZSgncGF3bicsIGksIDYsICdXJyk7XG4gICAgZGVmYXVsdEdhbWUucGllY2UoJ3Bhd24nLCBpLCAxLCAnQicpO1xuICB9XG5cbiAgLy8gQmxhY2sgZmlnczpcbiAgZGVmYXVsdEdhbWUucGllY2UoJ3Jvb2snLCAwLCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna25pZ2h0JywgMSwgMCwgJ0InKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2Jpc2hvcCcsIDIsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdxdWVlbicsIDMsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdraW5nJywgNCwgMCwgJ0InKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2Jpc2hvcCcsIDUsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdrbmlnaHQnLCA2LCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgncm9vaycsIDcsIDAsICdCJyk7XG5cbiAgLy8gV2hpdGUgZmlnczpcbiAgZGVmYXVsdEdhbWUucGllY2UoJ3Jvb2snLCAwLCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna25pZ2h0JywgMSwgNywgJ1cnKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2Jpc2hvcCcsIDIsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdxdWVlbicsIDMsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdraW5nJywgNCwgNywgJ1cnKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2Jpc2hvcCcsIDUsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdrbmlnaHQnLCA2LCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgncm9vaycsIDcsIDcsICdXJyk7XG5cbiAgcmV0dXJuIGRlZmF1bHRHYW1lO1xufTtcblxuR2FtZS5wcm90b3R5cGUuYWxsTW92ZXMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBib2FyZCA9IHRoaXMuYm9hcmQ7XG4gIHZhciBhbGxNb3ZlcyA9IFtdO1xuICB2YXIgYWN0aXZlQ29sb3VyID0gdGhpcy5hY3RpdmVDb2xvdXIoKS50b1VwcGVyQ2FzZSgpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHtcbiAgICAgIGlmIChib2FyZFtpXVtqXSAmJiBib2FyZFtpXVtqXS5jb2xvciA9PT0gYWN0aXZlQ29sb3VyKSB7XG4gICAgICAgIHZhciB2YWxpZE1vdmVzID0gYm9hcmRbaV1bal0uZ2V0VmFsaWRNb3Zlcyh0cnVlKTtcbiAgICAgICAgdmFsaWRNb3Zlcy5mb3JFYWNoKGZ1bmN0aW9uIChldikge1xuICAgICAgICAgIGFsbE1vdmVzLnB1c2goe1xuICAgICAgICAgICAgY29sb3I6IGJvYXJkW2ldW2pdLmNvbG9yLFxuICAgICAgICAgICAgZnJvbTogeyB4OiBqLCB5OiBpIH0sXG4gICAgICAgICAgICB0bzogZXYsXG4gICAgICAgICAgICBGRU5uYW1lOiBib2FyZFtpXVtqXS5GRU5uYW1lXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBhbGxNb3Zlcztcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEdhbWU7XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLy9cbi8vIFJTRyBDaGVzc1xuLy8gTGljZW5zZWQgdW5kZXIgQXBhY2hlIDIuMCBMSUNFTlNFXG5cbnZhciBQSUVDRV9DSEFSUyA9IGV4cG9ydHMuUElFQ0VfQ0hBUlMgPSB7XG4gIHBhd246IHsgVzogJ+KZmScsIEI6ICfimZ8nIH0sXG4gIHJvb2s6IHsgVzogJ+KZlicsIEI6ICfimZwnIH0sXG4gIGtuaWdodDogeyBXOiAn4pmYJywgQjogJ+KZnicgfSxcbiAgYmlzaG9wOiB7IFc6ICfimZcnLCBCOiAn4pmdJyB9LFxuICBxdWVlbjogeyBXOiAn4pmVJywgQjogJ+KZmycgfSxcbiAga2luZzogeyBXOiAn4pmUJywgQjogJ+KZmicgfVxufTtcblxuZnVuY3Rpb24gUGllY2UoeCwgeSwgY2hhckJhc2UsIGNvbG9yLCBnYW1lLCB0eXBlKSB7XG4gIGlmIChjaGFyQmFzZSkgdGhpcy5jaGFyID0gY2hhckJhc2VbY29sb3JdO1xuICB0aGlzLmNvbG9yID0gY29sb3I7XG4gIHRoaXMueCA9IHg7XG4gIHRoaXMueSA9IHk7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG4gIHRoaXMudHlwZSA9IHR5cGU7XG4gIGlmICh0eXBlKSB7XG4gICAgdmFyIEZFTm5hbWUgPSB0eXBlID09PSAna25pZ2h0JyA/ICduJyA6IHR5cGUuY2hhckF0KDApO1xuICAgIGlmICh0aGlzLmNvbG9yID09PSAnVycpIEZFTm5hbWUgPSBGRU5uYW1lLnRvVXBwZXJDYXNlKCk7XG4gICAgdGhpcy5GRU5uYW1lID0gRkVObmFtZTtcbiAgfVxufVxuXG5QaWVjZS5lbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIG5ldyBQaWVjZSgpO1xufTtcblxuUGllY2UucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBbeyB4OiAwLCB5OiAwIH0sIHsgeDogNywgeTogNyB9XTtcbn07XG5cbmZ1bmN0aW9uIFBhd24oeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5wYXduLCBjb2xvciwgZ2FtZSwgJ3Bhd24nKTtcbn1cblxuUGF3bi5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuUGF3bi5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIG1vdmVzID0gW107XG4gIC8qIGVzbGludC1kaXNhYmxlICovXG4gIHZhciB5ID0gdGhpcy55LFxuICAgICAgeCA9IHRoaXMueDtcbiAgdmFyIGJvYXJkID0gZ2FtZS5ib2FyZCxcbiAgICAgIHR1cm4gPSBnYW1lLnR1cm4sXG4gICAgICBsZW5ndGggPSB0dXJuLmxlbmd0aDtcbiAgdmFyIGxhc3QsIHR1cm5UbywgdHVybkZyb20sIGZpZ1gsIHBhc3NhbnRMYXN0LCBwYXNzYW50RmlnO1xuICB2YXIgY29sb3JZID0gdGhpcy5jb2xvciA9PT0gJ1cnID8geSAtIDEgOiB5ICsgMTtcbiAgdmFyIGNvbG9yWTIgPSB0aGlzLmNvbG9yID09PSAnVycgPyB5IC0gMiA6IHkgKyAyO1xuICB2YXIgcGFzc2FudFkyID0gdGhpcy5jb2xvciA9PT0gJ1cnID8gMyA6IDQ7XG4gIHZhciBmaWdYQXJyYXkgPSBbeCAtIDEsIHggKyAxXTtcbiAgLyogZXNsaW50LWVuYWJsZSAqL1xuXG4gIGlmIChjb2xvclkgPCA4ICYmIGNvbG9yWSA+PSAwICYmICFib2FyZFtjb2xvclldW3hdKSB7XG4gICAgbW92ZXMucHVzaCh7IHg6IHgsIHk6IGNvbG9yWSB9KTtcbiAgICBpZiAoKHkgPT09IDEgfHwgeSA9PT0gNikgJiYgY29sb3JZMiA8IDggJiYgY29sb3JZMiA+PSAwICYmICFnYW1lLmJvYXJkW2NvbG9yWTJdW3hdKSB7XG4gICAgICBtb3Zlcy5wdXNoKHsgeDogeCwgeTogY29sb3JZMiB9KTtcbiAgICB9XG4gIH1cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IDI7IGkrKykge1xuICAgIGZpZ1ggPSBmaWdYQXJyYXlbaV07XG4gICAgaWYgKGNvbG9yWSA8IDggJiYgY29sb3JZID49IDAgJiYgYm9hcmRbY29sb3JZXVtmaWdYXSAmJiBib2FyZFtjb2xvclldW2ZpZ1hdLmNvbG9yICE9PSB0aGlzLmNvbG9yKSBtb3Zlcy5wdXNoKHsgeDogZmlnWCwgeTogY29sb3JZIH0pO1xuICB9XG5cbiAgLy8gQ2hlY2sgZm9yIGVuLXBhc3NhbnRcbiAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IDI7IF9pKyspIHtcbiAgICBmaWdYID0gZmlnWEFycmF5W19pXTtcbiAgICBsYXN0ID0gdHVybltsZW5ndGggLSAxXTtcblxuICAgIGlmIChsYXN0ICYmIGxhc3QudHlwZSA9PT0gJ3Bhd24nICYmIGxhc3QudG8ueCA9PT0gZmlnWCAmJiBsYXN0LnRvLnkgPT09IHkgJiYgbGFzdC5jb2xvciAhPT0gdGhpcy5jb2xvciAmJiAobGFzdC5mcm9tLnkgPT09IDEgfHwgbGFzdC5mcm9tLnkgPT09IDYpICYmICh5ID09PSAzIHx8IHkgPT09IDQpKSB7XG4gICAgICBtb3Zlcy5wdXNoKHtcbiAgICAgICAgeDogZmlnWCxcbiAgICAgICAgeTogY29sb3JZLFxuICAgICAgICBtb3ZlUGllY2U6IHtcbiAgICAgICAgICBwaWVjZTogZ2FtZS5ib2FyZFt5XVtmaWdYXSxcbiAgICAgICAgICBmcm9tOiB7XG4gICAgICAgICAgICB4OiBmaWdYLFxuICAgICAgICAgICAgeTogeVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdG86IG51bGxcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2UucGF3biA9IGZ1bmN0aW9uICh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICByZXR1cm4gbmV3IFBhd24oeCwgeSwgY29sb3IsIGdhbWUpO1xufTtcblxuLy8gLy9cblxuZnVuY3Rpb24gUm9vayh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICBQaWVjZS5jYWxsKHRoaXMsIHgsIHksIFBJRUNFX0NIQVJTLnJvb2ssIGNvbG9yLCBnYW1lLCAncm9vaycpO1xufVxuXG5Sb29rLnByb3RvdHlwZSA9IFBpZWNlLmVtcHR5KCk7XG5Sb29rLnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzID0gZnVuY3Rpb24gKHNpbXVsYXRlKSB7XG4gIHZhciBnYW1lID0gdGhpcy5nYW1lO1xuICB2YXIgbW92ZXMgPSBbXTtcblxuICBbWy0xLCAwXSwgWzEsIDBdLCBbMCwgMV0sIFswLCAtMV1dLmZvckVhY2goZnVuY3Rpb24gKGNvZWYpIHtcbiAgICB2YXIgaW5kZXgsIHgsIHksIHBpZWNlO1xuICAgIGZvciAoaW5kZXggPSAxOzsgaW5kZXgrKykge1xuICAgICAgeCA9IHRoaXMueCArIGNvZWZbMF0gKiBpbmRleDtcbiAgICAgIHkgPSB0aGlzLnkgKyBjb2VmWzFdICogaW5kZXg7XG4gICAgICBpZiAoeSA8IDAgfHwgeSA+IDcgfHwgeCA8IDAgfHwgeCA+IDcpIGJyZWFrO1xuXG4gICAgICBwaWVjZSA9IGdhbWUuYm9hcmRbeV1beF07XG4gICAgICBpZiAocGllY2UgJiYgcGllY2UuY29sb3IgPT09IHRoaXMuY29sb3IpIGJyZWFrO1xuXG4gICAgICBtb3Zlcy5wdXNoKHsgeDogeCwgeTogeSB9KTtcbiAgICAgIGlmIChwaWVjZSkgYnJlYWs7XG4gICAgfVxuICB9LCB0aGlzKTtcblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3ZlcywgdGhpcyk7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5yb29rID0gZnVuY3Rpb24gKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIHJldHVybiBuZXcgUm9vayh4LCB5LCBjb2xvciwgZ2FtZSk7XG59O1xuXG4vLyAvL1xuXG5mdW5jdGlvbiBLbmlnaHQoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5rbmlnaHQsIGNvbG9yLCBnYW1lLCAna25pZ2h0Jyk7XG59XG5cbktuaWdodC5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuS25pZ2h0LnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzID0gZnVuY3Rpb24gKHNpbXVsYXRlKSB7XG4gIHZhciBnYW1lID0gdGhpcy5nYW1lO1xuICB2YXIgbW92ZXMgPSBbXTtcblxuICB2YXIgY29vcmRpbmF0ZXMgPSBbWzIsIDFdLCBbLTIsIDFdLCBbMSwgMl0sIFstMSwgMl0sIFsyLCAtMV0sIFstMiwgLTFdLCBbMSwgLTJdLCBbLTEsIC0yXV07XG5cbiAgdmFyIG9uZSwgdHdvO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb3JkaW5hdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGhlbHAgPSBmYWxzZTtcbiAgICB2YXIgYm9hcmRQaWVjZTtcbiAgICBvbmUgPSBjb29yZGluYXRlc1tpXVswXTtcbiAgICB0d28gPSBjb29yZGluYXRlc1tpXVsxXTtcblxuICAgIGlmICh0aGlzLnggKyBvbmUgPCA4ICYmIHRoaXMueCArIG9uZSA+PSAwICYmIHRoaXMueSArIHR3byA8IDggJiYgdGhpcy55ICsgdHdvID49IDApIHtcbiAgICAgIGJvYXJkUGllY2UgPSBnYW1lLmJvYXJkW3RoaXMueSArIHR3b11bdGhpcy54ICsgb25lXTtcbiAgICAgIGhlbHAgPSBib2FyZFBpZWNlID8gYm9hcmRQaWVjZS5jb2xvciAhPT0gdGhpcy5jb2xvciA6IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGhlbHApIHtcbiAgICAgIG1vdmVzLnB1c2goeyB4OiB0aGlzLnggKyBvbmUsIHk6IHRoaXMueSArIHR3byB9KTtcbiAgICB9XG4gIH1cblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3ZlcywgdGhpcyk7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5rbmlnaHQgPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBLbmlnaHQoeCwgeSwgY29sb3IsIGdhbWUpO1xufTtcblxuLy8gLy9cblxuZnVuY3Rpb24gQmlzaG9wKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMuYmlzaG9wLCBjb2xvciwgZ2FtZSwgJ2Jpc2hvcCcpO1xufVxuXG5CaXNob3AucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcbkJpc2hvcC5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIG1vdmVzID0gW107XG5cbiAgW1stMSwgLTFdLCBbMSwgMV0sIFstMSwgMV0sIFsxLCAtMV1dLmZvckVhY2goZnVuY3Rpb24gKGNvZWYpIHtcbiAgICB2YXIgaW5kZXgsIHgsIHksIHBpZWNlO1xuICAgIGZvciAoaW5kZXggPSAxOzsgaW5kZXgrKykge1xuICAgICAgeCA9IHRoaXMueCArIGNvZWZbMF0gKiBpbmRleDtcbiAgICAgIHkgPSB0aGlzLnkgKyBjb2VmWzFdICogaW5kZXg7XG4gICAgICBpZiAoeSA8IDAgfHwgeSA+IDcgfHwgeCA8IDAgfHwgeCA+IDcpIGJyZWFrO1xuXG4gICAgICBwaWVjZSA9IGdhbWUuYm9hcmRbeV1beF07XG4gICAgICBpZiAocGllY2UgJiYgcGllY2UuY29sb3IgPT09IHRoaXMuY29sb3IpIGJyZWFrO1xuXG4gICAgICBtb3Zlcy5wdXNoKHsgeDogeCwgeTogeSB9KTtcbiAgICAgIGlmIChwaWVjZSkgYnJlYWs7XG4gICAgfVxuICB9LCB0aGlzKTtcblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3ZlcywgdGhpcyk7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5iaXNob3AgPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBCaXNob3AoeCwgeSwgY29sb3IsIGdhbWUpO1xufTtcblxuLy8gLy9cblxuZnVuY3Rpb24gUXVlZW4oeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5xdWVlbiwgY29sb3IsIGdhbWUsICdxdWVlbicpO1xufVxuXG5RdWVlbi5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuUXVlZW4ucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoc2ltdWxhdGUpIHtcbiAgdmFyIGdhbWUgPSB0aGlzLmdhbWU7XG4gIHZhciByb29rTW92ZXMgPSBSb29rLnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzLmNhbGwodGhpcyk7XG4gIHZhciBiaXNob3BNb3ZlcyA9IEJpc2hvcC5wcm90b3R5cGUuZ2V0VmFsaWRNb3Zlcy5jYWxsKHRoaXMpO1xuICB2YXIgbW92ZXMgPSByb29rTW92ZXMuY29uY2F0KGJpc2hvcE1vdmVzKTtcblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3ZlcywgdGhpcyk7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5xdWVlbiA9IGZ1bmN0aW9uICh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICByZXR1cm4gbmV3IFF1ZWVuKHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbi8vIC8vXG5cbmZ1bmN0aW9uIEtpbmcoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5raW5nLCBjb2xvciwgZ2FtZSwgJ2tpbmcnKTtcbn1cblxuS2luZy5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuS2luZy5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgbW92ZXMgPSBbXTtcbiAgdmFyIGNvb3JkaW5hdGVzID0gW1swLCAxXSwgWzAsIC0xXSwgWzEsIDFdLCBbLTEsIC0xXSwgWzEsIC0xXSwgWy0xLCAxXSwgWy0xLCAwXSwgWzEsIDBdXTtcbiAgdmFyIHggPSB0aGlzLng7XG4gIHZhciB5ID0gdGhpcy55O1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIHR1cm4gPSBnYW1lLnR1cm47XG4gIHZhciBzZWxmID0gdGhpcztcblxuICBjb29yZGluYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChjb29yZCkge1xuICAgIHZhciBwaWVjZTtcbiAgICB2YXIgeHggPSB4ICsgY29vcmRbMF07XG4gICAgdmFyIHl5ID0geSArIGNvb3JkWzFdO1xuXG4gICAgaWYgKHh4IDwgOCAmJiB4eCA+PSAwICYmIHl5IDwgOCAmJiB5eSA+PSAwKSB7XG4gICAgICBwaWVjZSA9IGdhbWUuYm9hcmRbeXldW3h4XTtcbiAgICAgIGlmICghcGllY2UgfHwgcGllY2UuY29sb3IgIT09IHNlbGYuY29sb3IpIHtcbiAgICAgICAgbW92ZXMucHVzaCh7IHg6IHh4LCB5OiB5eSB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8vIENoZWNrIGtpbmcgaGFzbid0IG1vdmVkXG4gIHZhciBraW5nTW92ZWQgPSB0dXJuLnNvbWUoZnVuY3Rpb24gKHR1cm4pIHtcbiAgICByZXR1cm4gdHVybi50eXBlID09PSAna2luZycgJiYgdHVybi5jb2xvciA9PT0gc2VsZi5jb2xvcjtcbiAgfSk7XG5cbiAgaWYgKCFraW5nTW92ZWQpIHtcbiAgICBbWzAsIDIsIC0xXSwgWzcsIDYsICsxXV0uZm9yRWFjaChmdW5jdGlvbiAocHJvcHMpIHtcbiAgICAgIHZhciByb29rWCA9IHByb3BzWzBdO1xuICAgICAgdmFyIG5ld0tpbmdYID0gcHJvcHNbMV07XG4gICAgICB2YXIgZGlyID0gcHJvcHNbMl07XG4gICAgICB2YXIgcm9vayA9IGdhbWUuYm9hcmRbeV1bcm9va1hdO1xuXG4gICAgICAvLyBDaGVjayByb29rIG9uIHBvc2l0aW9uXG4gICAgICBpZiAoIXJvb2sgfHwgIXJvb2sudHlwZSA9PT0gJ3Jvb2snKSByZXR1cm47XG5cbiAgICAgIC8vIENoZWNrIHJvb2sgaGFzbid0IG1vdmVkXG4gICAgICBpZiAodHVybi5zb21lKGZ1bmN0aW9uIChldikge1xuICAgICAgICByZXR1cm4gZXYuZnJvbS54ID09PSByb29rWCAmJiBldi5mcm9tLnkgPT09IHk7XG4gICAgICB9KSkgcmV0dXJuO1xuXG4gICAgICAvLyBDaGVjayBzcXVhcmVzIGVtcHR5IGFuZCBzYWZlXG4gICAgICBmb3IgKHZhciB4eCA9IHggKyBkaXI7IHh4ICE9PSByb29rWDsgeHggKz0gZGlyKSB7XG4gICAgICAgIGlmIChnYW1lLmJvYXJkW3ldW3h4XSkgcmV0dXJuO1xuICAgICAgICB2YXIgc2FmZSA9IHRydWU7XG4gICAgICAgIGdhbWUuYm9hcmQuZm9yRWFjaChmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICBldi5mb3JFYWNoKGZ1bmN0aW9uIChldnYpIHtcbiAgICAgICAgICAgIGlmIChldnYgJiYgZXZ2LnR5cGUgIT09ICdraW5nJyAmJiBldnYuY29sb3IgIT09IHNlbGYuY29sb3IpIHtcbiAgICAgICAgICAgICAgZXZ2LmdldFZhbGlkTW92ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChldk1vdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZNb3ZlICYmIGV2TW92ZS55ID09PSB5ICYmIGV2TW92ZS54ID09PSB4eCkgc2FmZSA9IGZhbHNlO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghc2FmZSkgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgcm9jaGFkZSA9IHtcbiAgICAgICAgeDogbmV3S2luZ1gsXG4gICAgICAgIHk6IHksXG4gICAgICAgIG1vdmVQaWVjZToge1xuICAgICAgICAgIHBpZWNlOiBzZWxmLmdhbWUuYm9hcmRbeV1bcm9va1hdLFxuICAgICAgICAgIGZyb206IHtcbiAgICAgICAgICAgIHg6IHJvb2tYLCB5OiB5XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0bzoge1xuICAgICAgICAgICAgeTogeSwgeDogeCArIGRpclxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgbW92ZXMucHVzaChyb2NoYWRlKTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciB2YWxpZE1vdmVzID0gW107XG4gIGlmIChzaW11bGF0ZSkge1xuICAgIHZhbGlkTW92ZXMgPSBnYW1lLnNpbXVsYXRlQW5kRmlsdGVyKG1vdmVzLCBzZWxmKTtcbiAgfSBlbHNlIHtcbiAgICB2YWxpZE1vdmVzID0gbW92ZXM7XG4gIH1cblxuICByZXR1cm4gdmFsaWRNb3Zlcztcbn07XG5cblBpZWNlLmtpbmcgPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBLaW5nKHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbmV4cG9ydHMuUGllY2UgPSBQaWVjZTtcbmV4cG9ydHMuUGF3biA9IFBhd247XG5leHBvcnRzLlJvb2sgPSBSb29rO1xuZXhwb3J0cy5LbmlnaHQgPSBLbmlnaHQ7XG5leHBvcnRzLkJpc2hvcCA9IEJpc2hvcDtcbmV4cG9ydHMuUXVlZW4gPSBRdWVlbjtcbmV4cG9ydHMuS2luZyA9IEtpbmc7XG5cbi8qKiovIH0pLFxuLyogMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5BSSA9IGV4cG9ydHMuUGllY2VzID0gZXhwb3J0cy5HYW1lID0gdW5kZWZpbmVkO1xuXG52YXIgX2dhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgX2dhbWUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2FtZSk7XG5cbnZhciBfcGllY2VzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblxudmFyIFBpZWNlcyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9waWVjZXMpO1xuXG52YXIgX0FJID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblxudmFyIF9BSTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9BSSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8vIEFuZCBleHBvcnQuLi5cbmV4cG9ydHMuR2FtZSA9IF9nYW1lMi5kZWZhdWx0O1xuZXhwb3J0cy5QaWVjZXMgPSBQaWVjZXM7XG5leHBvcnRzLkFJID0gX0FJMi5kZWZhdWx0OyAvLyBMZXQncyBpbXBvcnQuLi5cblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZ2FtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cbnZhciBfZ2FtZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nYW1lKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIENoZXNzQUkgPSBmdW5jdGlvbiBDaGVzc0FJKGRlcHRoLCBnYW1lU3RhdGUsIGlzTWF4aW1pc2luZ1BsYXllcikge1xuICAvLyBDbG9uZSB0aGUgZ2FtZVN0YXRlIHRvIGFjY2VzcyBhbGwgZ2FtZSBhc3NvY2lhdGVkIG1ldGhvZHMuXG4gIC8vIFRoaXMgdXN1YWxseSBkb2Vzbid0IG1ha2Ugc2Vuc2UsIGJ1dCBzb21ldGltZXMgeW91IGNhbm5vdCBwb3N0IGZ1bmN0aW9ucyB0byBhIGJhY2tlbmQgb3IgYSB3ZWItd29ya2VyXG4gIC8vIGFuZCB0aGF0J3Mgd2h5IHdlJ3JlIHRvdWNoaW5nIHRoZSBnYW1lIG1ldGhvZHMgZnJvbSBuZXcgZ2FtZSBjb25maWd1cmF0aW9uIGludGVhZCBmcm9tIHRoZSBwYXNzZWQgYXJndW1lbnQuXG4gIC8vIFNvIGlmIHlvdSBwYXNzIHtib2FyZDogW215Qm9hcmRdLCB0dXJuOltteVR1cm5dLC4uLn0gZm9yIHRoZSBnYW1lIGFyZ3VtZW50IGl0IHdpbGwgYWN0dWFsbHkgd29yayFcbiAgLy8gQWxyZWFkeSBkZXNjcmliZWQgaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL1JTRy1Hcm91cC9DaGVzcy9pc3N1ZXMvOCNpc3N1ZWNvbW1lbnQtMzgxMjQ1Nzk0XG4gIHZhciBnYW1lID0gX2dhbWUyLmRlZmF1bHQucHJvdG90eXBlLmluaXRpYWxpemVHYW1lKCk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDg7IGorKykge1xuICAgICAgaWYgKGdhbWVTdGF0ZS5ib2FyZFtpXVtqXSkge1xuICAgICAgICB2YXIgY3VycmVudENlbGwgPSBnYW1lU3RhdGUuYm9hcmRbaV1bal07XG4gICAgICAgIGdhbWUucGllY2UoY3VycmVudENlbGwudHlwZSwgaiwgaSwgY3VycmVudENlbGwuY29sb3IpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ2FtZS5ib2FyZFtpXVtqXSA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2FtZS50dXJuID0gZ2FtZVN0YXRlLnR1cm47XG4gIGdhbWUudGhyZWVmb2xkID0gZ2FtZVN0YXRlLnRocmVlZm9sZDtcbiAgZ2FtZS5GRU4gPSBnYW1lU3RhdGUuRkVOO1xuICBnYW1lLkZFTmJvYXJkID0gZ2FtZVN0YXRlLkZFTmJvYXJkO1xuXG4gIC8vIFN0YXJ0IGxvb3BpbmcgYW5kIHNpbXVsYXRpbmcgYWxsIHZhbGlkIG1vdmVzXG4gIHZhciBhbGxNb3ZlcyA9IGdhbWUuYWxsTW92ZXMoKTtcbiAgdmFyIGJlc3RWYWx1ZSA9IC05OTk5O1xuICB2YXIgYmVzdE1vdmU7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbGxNb3Zlcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBuZXdHYW1lTW92ZSA9IGFsbE1vdmVzW2ldO1xuICAgIHZhciB1bmRvID0gZ2FtZS5zaW1wbGVNb3ZlKG5ld0dhbWVNb3ZlKTtcbiAgICB2YXIgYm9yYWRWYWx1ZSA9IG1pbmltYXgoZGVwdGggLSAxLCBnYW1lLCAtMTAwMDAsIDEwMDAwLCAhaXNNYXhpbWlzaW5nUGxheWVyKTtcbiAgICB1bmRvKCk7XG4gICAgaWYgKGJvcmFkVmFsdWUgPj0gYmVzdFZhbHVlKSB7XG4gICAgICBiZXN0VmFsdWUgPSBib3JhZFZhbHVlO1xuICAgICAgYmVzdE1vdmUgPSBuZXdHYW1lTW92ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGJlc3RNb3ZlO1xufTsgLy9cbi8vIFJTRyBDaGVzc1xuLy8gTGljZW5zZWQgdW5kZXIgQXBhY2hlIDIuMCBMSUNFTlNFXG5cbnZhciBtaW5pbWF4ID0gZnVuY3Rpb24gbWluaW1heChkZXB0aCwgZ2FtZSwgYWxwaGEsIGJldGEsIGlzTWF4aW1pc2luZ1BsYXllcikge1xuICBpZiAoZGVwdGggPT09IDApIHtcbiAgICByZXR1cm4gLWV2YWx1YXRlQm9hcmQoZ2FtZS5ib2FyZCk7XG4gIH1cblxuICB2YXIgYWxsTW92ZXMgPSBnYW1lLmFsbE1vdmVzKCk7XG4gIGlmIChpc01heGltaXNpbmdQbGF5ZXIpIHtcbiAgICB2YXIgYmVzdFZhbHVlID0gLTk5OTk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbGxNb3Zlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHVuZG8gPSBnYW1lLnNpbXBsZU1vdmUoYWxsTW92ZXNbaV0pO1xuICAgICAgYmVzdFZhbHVlID0gTWF0aC5tYXgoYmVzdFZhbHVlLCBtaW5pbWF4KGRlcHRoIC0gMSwgZ2FtZSwgYWxwaGEsIGJldGEsICFpc01heGltaXNpbmdQbGF5ZXIpKTtcbiAgICAgIHVuZG8oKTtcbiAgICAgIGFscGhhID0gTWF0aC5tYXgoYWxwaGEsIGJlc3RWYWx1ZSk7XG4gICAgICBpZiAoYmV0YSA8PSBhbHBoYSkge1xuICAgICAgICByZXR1cm4gYmVzdFZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYmVzdFZhbHVlO1xuICB9IGVsc2Uge1xuICAgIHZhciBfYmVzdFZhbHVlID0gOTk5OTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYWxsTW92ZXMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICB2YXIgX3VuZG8gPSBnYW1lLnNpbXBsZU1vdmUoYWxsTW92ZXNbX2ldKTtcbiAgICAgIF9iZXN0VmFsdWUgPSBNYXRoLm1pbihfYmVzdFZhbHVlLCBtaW5pbWF4KGRlcHRoIC0gMSwgZ2FtZSwgYWxwaGEsIGJldGEsICFpc01heGltaXNpbmdQbGF5ZXIpKTtcbiAgICAgIF91bmRvKCk7XG4gICAgICBiZXRhID0gTWF0aC5taW4oYmV0YSwgX2Jlc3RWYWx1ZSk7XG4gICAgICBpZiAoYmV0YSA8PSBhbHBoYSkge1xuICAgICAgICByZXR1cm4gX2Jlc3RWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIF9iZXN0VmFsdWU7XG4gIH1cbn07XG5cbnZhciBldmFsdWF0ZUJvYXJkID0gZnVuY3Rpb24gZXZhbHVhdGVCb2FyZChib2FyZCkge1xuICB2YXIgdG90YWxFdmFsdWF0aW9uID0gMDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDg7IGorKykge1xuICAgICAgLy8gY2FsY3VsYXRlIHRoZSBjdXJyZW50IGV2YWx1YXRpb25cbiAgICAgIHRvdGFsRXZhbHVhdGlvbiA9IHRvdGFsRXZhbHVhdGlvbiArIGdldFBpZWNlVmFsdWUoYm9hcmRbaV1bal0pO1xuICAgIH1cbiAgfVxuICAvLyByZXR1cm4gdGhlIHRvdGFsIGV2YWx1YXRpb25cbiAgcmV0dXJuIHRvdGFsRXZhbHVhdGlvbjtcbn07XG5cbnZhciBnZXRQaWVjZVZhbHVlID0gZnVuY3Rpb24gZ2V0UGllY2VWYWx1ZShwaWVjZSkge1xuICBpZiAocGllY2UgPT09IG51bGwpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIC8vIGdldCB2YWx1ZSBmb3IgZXZlcnkgcGllY2Ugb24gdGhlIGJvYXJkXG4gIHZhciBnZXRBYnNvbHV0ZVZhbHVlID0gZnVuY3Rpb24gZ2V0QWJzb2x1dGVWYWx1ZShwaWVjZSkge1xuICAgIGlmIChwaWVjZS50eXBlID09PSAncGF3bicpIHtcbiAgICAgIHJldHVybiAxMDtcbiAgICB9IGVsc2UgaWYgKHBpZWNlLnR5cGUgPT09ICdyb29rJykge1xuICAgICAgcmV0dXJuIDUwO1xuICAgIH0gZWxzZSBpZiAocGllY2UudHlwZSA9PT0gJ2tuaWdodCcpIHtcbiAgICAgIHJldHVybiAzMDtcbiAgICB9IGVsc2UgaWYgKHBpZWNlLnR5cGUgPT09ICdiaXNob3AnKSB7XG4gICAgICByZXR1cm4gMzA7XG4gICAgfSBlbHNlIGlmIChwaWVjZS50eXBlID09PSAncXVlZW4nKSB7XG4gICAgICByZXR1cm4gOTA7XG4gICAgfSBlbHNlIGlmIChwaWVjZS50eXBlID09PSAna2luZycpIHtcbiAgICAgIHJldHVybiA5MDA7XG4gICAgfVxuICB9O1xuXG4gIC8vIGNhbGN1bGF0ZSB0aGUgYWJzb2x1dGUgdmFsdWUgYW5kIHJldHVybiBpdFxuICB2YXIgYWJzb2x1dGVWYWx1ZSA9IGdldEFic29sdXRlVmFsdWUocGllY2UsIHBpZWNlLmNvbG9yID09PSAnVycpO1xuICByZXR1cm4gcGllY2UuY29sb3IgPT09ICdXJyA/IGFic29sdXRlVmFsdWUgOiAtYWJzb2x1dGVWYWx1ZTtcbn07XG5cbi8vIGV4cG9ydCB0aGUgYWxnb3JpdGhtXG5leHBvcnRzLmRlZmF1bHQgPSBDaGVzc0FJO1xuXG4vLyBXcml0dGVuIGJ5IFJhZGkgQ2hvXG4vLyBSU0cgQ2hlc3MgLSBieSBSU0cgR3JvdXBcblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL25vZGVfbW9kdWxlcy9yc2ctY2hlc3MvbGliL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=