!function(t){function o(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,o),i.l=!0,i.exports}var e={};o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},o.p="",o(o.s=0)}([function(t,o,e){"use strict";var r=e(1);self.addEventListener("message",function(t){if(t.data&&t.data.game&&t.data.playAgainstAI){var o=(0,r.AI)(t.data.playAgainstAI.depth,t.data.game,!0);self.postMessage(o)}})},function(t,o,e){!function(o,e){t.exports=e()}("undefined"!=typeof self&&self,function(){return function(t){function o(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,o),i.l=!0,i.exports}var e={};return o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},o.p="",o(o.s=3)}([function(t,o,e){"use strict";function r(t){this.board=[];for(var o=0;o<8;o++){for(var e=[],r=0;r<8;r++)e.push(null);this.board.push(e)}this.turn=[],this.FEN=[],this.FENboard=[],this.threefold=[]}Object.defineProperty(o,"__esModule",{value:!0});var i=e(1),n=e(2),a=function(t){return t&&t.__esModule?t:{default:t}}(n);r.prototype.piece=function(t,o,e,r){var n=i.Piece[t](o,e,r,this);this.board[e][o]=n,this.FEN=this.gameToFEN(),this.FENboard=this.boardToFEN()},r.prototype.moveSelected=function(t,o,e,r,i,n){var c=o.x,u=o.y;if(t){var s={x:t.x,y:t.y};if(this.board[u][c]!==t){for(var l=t.getValidMoves(!n),p=null,f=0;f<l.length;f++){var h=l[f];if(h.x===c&&h.y===u){p=h;break}}if(!p)return!1;var y,v,d,m=p.movePiece;m&&(y=m.from,v=m.to,null===v?this.board[y.y][y.x]=null:(d=this.board[y.y][y.x],this.board[v.y][v.x]=d,d.x=v.x,d.y=v.y,this.board[y.y][y.x]=null));var g=this.board[u][c]?this.board[u][c]:null;m=m?p.movePiece:null,this.turn.push({from:s,to:o,color:t.color,type:t.type,piece:g,movePiece:m}),this.board[u][c]=t,this.board[t.y][t.x]=null,this.board[u][c].x=c,this.board[u][c].y=u,this.FEN=this.gameToFEN(),this.FENboard=this.boardToFEN(),this.threefold.push(this.FENboard),("pawn"===t.type||g)&&(this.threefold=[]),this.threefoldCheck()&&r("D"),this.halfmoveClock()>=50&&r("D"),"pawn"===t.type&&("W"===t.color&&0===u||"B"===t.color&&7===u)&&e&&(i&&!i.mode&&i.comingAI&&"B"===t.color?i.customAIPromotion?i.customAIPromotion():this.promotePawn(t,c,u,t.color,"queen"):e(t,c,u,t.color));var x="W"===t.color?"B":"W",b=this.checkmate(x);if(b&&r(b),i&&i.mode&&i.move)if(i.customAIMovement)i.customAIMovement();else{var M=(0,a.default)(i.depth,this,!1);this.moveSelected(this.board[M.from.y][M.from.x],M.to,e,r,!1,!0,n)}}return t=null,!0}},r.prototype.promotePawn=function(t,o,e,r,i){this.piece(i,o,e,r)},r.prototype.simulateAndFilter=function(t,o){var e=[],r=this,i=this.board;return t.forEach(function(t,n){var a=t.y,c=t.x,u={x:o.x,y:o.y},s=i[a][c]?{piece:i[a][c],from:{x:c,y:a},to:null}:null;t.movePiece&&(s=t.movePiece),s&&r.simpleMovePiece(s.piece,s.from,s.to),r.simpleMovePiece(o,u,{x:c,y:a});var l=r.warning(o.color);r.simpleMovePiece(o,{x:c,y:a},u),s&&r.simpleMovePiece(s.piece,s.to,s.from),l||e.push(t)}),e},r.prototype.checkmate=function(t){for(var o=0;o<8;o++)for(var e=0;e<8;e++)if(this.board[o][e]&&this.board[o][e].color===t&&this.board[o][e].getValidMoves(!0).length)return!1;return this.warning(t)?t:"D"},r.prototype.simpleMovePiece=function(t,o,e){var r=this.board;e&&(r[e.y][e.x]=t,t.x=e.x,t.y=e.y),o&&(r[o.y][o.x]=null)},r.prototype.simpleMove=function(t){var o=this,e=o.board,r=t.from,i=t.to,n=e[r.y][r.x],a=this.board[i.y][i.x]?this.board[i.y][i.x]:null,c=e[i.y][i.x]?{piece:e[i.y][i.x],from:{x:i.x,y:i.y},to:null}:null;return this.turn.push({from:r,to:{x:i.x,y:i.y},color:t.color,type:n.type,piece:a,movePiece:c}),i.movePiece&&(c=i.movePiece),c&&o.simpleMovePiece(c.piece,c.from,c.to),o.simpleMovePiece(n,r,{x:i.x,y:i.y}),function(){c&&o.simpleMovePiece(c.piece,c.to,c.from),o.simpleMovePiece(n,{x:i.x,y:i.y},r),a&&(e[i.y][i.x]=a),o.turn.pop()}},r.prototype.warning=function(t){var o,e=!1;return this.board.forEach(function(e){e.forEach(function(e){e&&e.color===t&&"king"===e.type&&(o=e)})}),this.board.forEach(function(r){r.forEach(function(r){r&&r.color!==t&&r.getValidMoves().forEach(function(t){t.x===o.x&&t.y===o.y&&(e=!0)})})}),e},r.prototype.threefoldCheck=function(){for(var t=this.threefold,o=t.length,e=0;e<o;e++){for(var r=0,i=e+1;i<o;i++)t[e]===t[i]&&(r+=1);if(r>=2)return!0}return!1},r.prototype.pieceToAN=function(t,o){return"abcdefgh".charAt(t)+(8-o)},r.prototype.boardToFEN=function(){for(var t=this.board,o="",e=0,r=0;r<8;r++){for(var i=0;i<8;i++)t[r][i]?(e&&(o+=e),e=0,o+=t[r][i].FENname):e++;e&&(o+=e),e=0,o+=r<7?"/":""}return o},r.prototype.halfmoveClock=function(){var t=this.turn,o=t.length,e=0;if(0===t.length)return e;for(var r=t[o-1-e];e<=o-1&&"pawn"!==r.type&&!r.piece;)e++,r=t[o-1-e];return e},r.prototype.activeColour=function(){var t=this.turn;return t.length&&"W"===t[t.length-1].color?"b":"w"},r.prototype.castlingTarget=function(){var t,o,e=this.board,r=this.turn,i="";return r.forEach(function(e){t="king"===e.type&&"W"===e.color,o="king"===e.type&&"B"===e.color}),[[7,0],[0,0],[7,7],[0,7]].forEach(function(n){var a=n[0],c=n[1],u=e[c][a];if((7!==c||!t)&&(0!==c||!o)&&u&&"rook"!==!u.type&&!r.some(function(t){return"rook"===t.type&&(t.from.x===a&&t.from.y===c)})){var s=0===a?"q":"k";i+=0===c?s.toUpperCase():s}}),i||(i="-"),i},r.prototype.enPassantTarget=function(){var t=this.turn,o="";if(t.length){var e=t[t.length-1];"W"===e.color&&4===e.to.y&&(o=this.pieceToAN(e.to.x,e.to.y+1)),"B"===e.color&&3===e.to.y&&(o=this.pieceToAN(e.to.x,e.to.y-1))}return o||(o="-"),o},r.prototype.fullmoveCount=function(){var t=1;return this.turn.forEach(function(o){"B"===o.color&&(t+=1)}),t},r.prototype.gameToFEN=function(){var t="";return t+=this.boardToFEN(),t+=" "+this.activeColour(),t+=" "+this.castlingTarget(),t+=" "+this.enPassantTarget(),t+=" "+this.halfmoveClock(),t+=" "+this.fullmoveCount()},r.prototype.initializeGame=function(){for(var t=new r,o=0;o<8;o++)t.piece("pawn",o,6,"W"),t.piece("pawn",o,1,"B");return t.piece("rook",0,0,"B"),t.piece("knight",1,0,"B"),t.piece("bishop",2,0,"B"),t.piece("queen",3,0,"B"),t.piece("king",4,0,"B"),t.piece("bishop",5,0,"B"),t.piece("knight",6,0,"B"),t.piece("rook",7,0,"B"),t.piece("rook",0,7,"W"),t.piece("knight",1,7,"W"),t.piece("bishop",2,7,"W"),t.piece("queen",3,7,"W"),t.piece("king",4,7,"W"),t.piece("bishop",5,7,"W"),t.piece("knight",6,7,"W"),t.piece("rook",7,7,"W"),t},r.prototype.allMoves=function(){for(var t=this.board,o=[],e=this.activeColour().toUpperCase(),r=0;r<8;r++)for(var i=0;i<8;i++)if(t[r][i]&&t[r][i].color===e){var n=t[r][i].getValidMoves(!0);n.forEach(function(e){o.push({color:t[r][i].color,from:{x:i,y:r},to:e,FENname:t[r][i].FENname})})}return o},o.default=r},function(t,o,e){"use strict";function r(t,o,e,r,i,n){if(e&&(this.char=e[r]),this.color=r,this.x=t,this.y=o,this.game=i,this.type=n,n){var a="knight"===n?"n":n.charAt(0);"W"===this.color&&(a=a.toUpperCase()),this.FENname=a}}function i(t,o,e,i){r.call(this,t,o,l.pawn,e,i,"pawn")}function n(t,o,e,i){r.call(this,t,o,l.rook,e,i,"rook")}function a(t,o,e,i){r.call(this,t,o,l.knight,e,i,"knight")}function c(t,o,e,i){r.call(this,t,o,l.bishop,e,i,"bishop")}function u(t,o,e,i){r.call(this,t,o,l.queen,e,i,"queen")}function s(t,o,e,i){r.call(this,t,o,l.king,e,i,"king")}Object.defineProperty(o,"__esModule",{value:!0});var l=o.PIECE_CHARS={pawn:{W:"♙",B:"♟"},rook:{W:"♖",B:"♜"},knight:{W:"♘",B:"♞"},bishop:{W:"♗",B:"♝"},queen:{W:"♕",B:"♛"},king:{W:"♔",B:"♚"}};r.empty=function(){return new r},r.prototype.getValidMoves=function(){return[{x:0,y:0},{x:7,y:7}]},i.prototype=r.empty(),i.prototype.getValidMoves=function(t){var o,e,r=this.game,i=[],n=this.y,a=this.x,c=r.board,u=r.turn,s=u.length,l="W"===this.color?n-1:n+1,p="W"===this.color?n-2:n+2,f=(this.color,[a-1,a+1]);l<8&&l>=0&&!c[l][a]&&(i.push({x:a,y:l}),(1===n||6===n)&&p<8&&p>=0&&!r.board[p][a]&&i.push({x:a,y:p}));for(var h=0;h<2;h++)e=f[h],l<8&&l>=0&&c[l][e]&&c[l][e].color!==this.color&&i.push({x:e,y:l});for(var y=0;y<2;y++)e=f[y],!(o=u[s-1])||"pawn"!==o.type||o.to.x!==e||o.to.y!==n||o.color===this.color||1!==o.from.y&&6!==o.from.y||3!==n&&4!==n||i.push({x:e,y:l,movePiece:{piece:r.board[n][e],from:{x:e,y:n},to:null}});return t?r.simulateAndFilter(i,this):i},r.pawn=function(t,o,e,r){return new i(t,o,e,r)},n.prototype=r.empty(),n.prototype.getValidMoves=function(t){var o=this.game,e=[];[[-1,0],[1,0],[0,1],[0,-1]].forEach(function(t){var r,i,n,a;for(r=1;(i=this.x+t[0]*r,!((n=this.y+t[1]*r)<0||n>7||i<0||i>7))&&(!(a=o.board[n][i])||a.color!==this.color)&&(e.push({x:i,y:n}),!a);r++);},this);return t?o.simulateAndFilter(e,this):e},r.rook=function(t,o,e,r){return new n(t,o,e,r)},a.prototype=r.empty(),a.prototype.getValidMoves=function(t){for(var o,e,r=this.game,i=[],n=[[2,1],[-2,1],[1,2],[-1,2],[2,-1],[-2,-1],[1,-2],[-1,-2]],a=0;a<n.length;a++){var c,u=!1;o=n[a][0],e=n[a][1],this.x+o<8&&this.x+o>=0&&this.y+e<8&&this.y+e>=0&&(c=r.board[this.y+e][this.x+o],u=!c||c.color!==this.color),u&&i.push({x:this.x+o,y:this.y+e})}return t?r.simulateAndFilter(i,this):i},r.knight=function(t,o,e,r){return new a(t,o,e,r)},c.prototype=r.empty(),c.prototype.getValidMoves=function(t){var o=this.game,e=[];[[-1,-1],[1,1],[-1,1],[1,-1]].forEach(function(t){var r,i,n,a;for(r=1;(i=this.x+t[0]*r,!((n=this.y+t[1]*r)<0||n>7||i<0||i>7))&&(!(a=o.board[n][i])||a.color!==this.color)&&(e.push({x:i,y:n}),!a);r++);},this);return t?o.simulateAndFilter(e,this):e},r.bishop=function(t,o,e,r){return new c(t,o,e,r)},u.prototype=r.empty(),u.prototype.getValidMoves=function(t){var o=this.game,e=n.prototype.getValidMoves.call(this),r=c.prototype.getValidMoves.call(this),i=e.concat(r);return t?o.simulateAndFilter(i,this):i},r.queen=function(t,o,e,r){return new u(t,o,e,r)},s.prototype=r.empty(),s.prototype.getValidMoves=function(t){var o=[],e=[[0,1],[0,-1],[1,1],[-1,-1],[1,-1],[-1,1],[-1,0],[1,0]],r=this.x,i=this.y,n=this.game,a=n.turn,c=this;e.forEach(function(t){var e,a=r+t[0],u=i+t[1];a<8&&a>=0&&u<8&&u>=0&&((e=n.board[u][a])&&e.color===c.color||o.push({x:a,y:u}))}),a.some(function(t){return"king"===t.type&&t.color===c.color})||[[0,2,-1],[7,6,1]].forEach(function(t){var e=t[0],u=t[1],s=t[2],l=n.board[i][e];if(l&&"rook"!==!l.type&&!a.some(function(t){return t.from.x===e&&t.from.y===i})){for(var p=r+s;p!==e;p+=s){if(n.board[i][p])return;var f=!0;if(n.board.forEach(function(t){t.forEach(function(t){t&&"king"!==t.type&&t.color!==c.color&&t.getValidMoves().forEach(function(t){t&&t.y===i&&t.x===p&&(f=!1)})})}),!f)return}var h={x:u,y:i,movePiece:{piece:c.game.board[i][e],from:{x:e,y:i},to:{y:i,x:r+s}}};o.push(h)}});return t?n.simulateAndFilter(o,c):o},r.king=function(t,o,e,r){return new s(t,o,e,r)},o.Piece=r,o.Pawn=i,o.Rook=n,o.Knight=a,o.Bishop=c,o.Queen=u,o.King=s},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e(0),i=function(t){return t&&t.__esModule?t:{default:t}}(r),n=function(t,o,e){for(var r=i.default.prototype.initializeGame(),n=0;n<8;n++)for(var c=0;c<8;c++)if(o.board[n][c]){var u=o.board[n][c];r.piece(u.type,c,n,u.color)}else r.board[n][c]=null;r.turn=o.turn,r.threefold=o.threefold,r.FEN=o.FEN,r.FENboard=o.FENboard;for(var s,l=r.allMoves(),p=-9999,n=0;n<l.length;n++){var f=l[n],h=r.simpleMove(f),y=a(t-1,r,-1e4,1e4,!e);h(),y>=p&&(p=y,s=f)}return s},a=function t(o,e,r,i,n){if(0===o)return-c(e.board);var a=e.allMoves();if(n){for(var u=-9999,s=0;s<a.length;s++){var l=e.simpleMove(a[s]);if(u=Math.max(u,t(o-1,e,r,i,!n)),l(),r=Math.max(r,u),i<=r)return u}return u}for(var p=9999,f=0;f<a.length;f++){var h=e.simpleMove(a[f]);if(p=Math.min(p,t(o-1,e,r,i,!n)),h(),(i=Math.min(i,p))<=r)return p}return p},c=function(t){for(var o=0,e=0;e<8;e++)for(var r=0;r<8;r++)o+=u(t[e][r]);return o},u=function(t){if(null===t)return 0;var o=function(t){return"pawn"===t.type?10:"rook"===t.type?50:"knight"===t.type?30:"bishop"===t.type?30:"queen"===t.type?90:"king"===t.type?900:void 0}(t,t.color);return"W"===t.color?o:-o};o.default=n},function(t,o,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(o,"__esModule",{value:!0}),o.AI=o.Pieces=o.Game=void 0;var i=e(0),n=r(i),a=e(1),c=function(t){if(t&&t.__esModule)return t;var o={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e]);return o.default=t,o}(a),u=e(2),s=r(u);o.Game=n.default,o.Pieces=c,o.AI=s.default}])})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd29ya2VyLm1pbi5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMDE4OTcwMjBkYzRkY2IwYWVlMzYiLCJ3ZWJwYWNrOi8vLy4vanMvd29ya2VyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9yc2ctY2hlc3MvbGliL2luZGV4LmpzIl0sIm5hbWVzIjpbIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJfcnNnQ2hlc3MiLCJzZWxmIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJkYXRhIiwiZ2FtZSIsInBsYXlBZ2FpbnN0QUkiLCJiZXN0TW92ZSIsIkFJIiwiZGVwdGgiLCJwb3N0TWVzc2FnZSIsInJvb3QiLCJmYWN0b3J5IiwiR2FtZSIsInByb21vQ2FsbGJhY2siLCJ0aGlzIiwiYm9hcmQiLCJhcnJheUluIiwiaiIsInB1c2giLCJ0dXJuIiwiRkVOIiwiRkVOYm9hcmQiLCJ0aHJlZWZvbGQiLCJ2YWx1ZSIsIl9waWVjZXMiLCJfQUkiLCJfQUkyIiwib2JqIiwiZGVmYXVsdCIsInBpZWNlIiwidHlwZSIsIngiLCJ5IiwiY29sb3IiLCJQaWVjZSIsImdhbWVUb0ZFTiIsImJvYXJkVG9GRU4iLCJtb3ZlU2VsZWN0ZWQiLCJzZWxlY3RlZCIsInRvIiwicHJvbW90aW9uQ2FsbGJhY2siLCJjaGVja21hdGVDYWxsYmFjayIsInNpbXVsYXRlIiwiZnJvbSIsInZhbGlkTW92ZXMiLCJnZXRWYWxpZE1vdmVzIiwidmFsaWRNb3ZlIiwibGVuZ3RoIiwidm0iLCJ0YWtlIiwicGFzdGUiLCJyb29rIiwibW92ZVBpZWNlIiwidGhyZWVmb2xkQ2hlY2siLCJoYWxmbW92ZUNsb2NrIiwibW9kZSIsImNvbWluZ0FJIiwiY3VzdG9tQUlQcm9tb3Rpb24iLCJwcm9tb3RlUGF3biIsImNoZWNrbWF0ZUNvbG9yIiwiY2hlY2ttYXRlVmFsdWUiLCJjaGVja21hdGUiLCJtb3ZlIiwiY3VzdG9tQUlNb3ZlbWVudCIsInBhd24iLCJzaW11bGF0ZUFuZEZpbHRlciIsIm1vdmVzIiwiZm9yRWFjaCIsInNpbXBsZU1vdmVQaWVjZSIsIndhcm5pbmciLCJzaW1wbGVNb3ZlIiwiY2FwdHVyZWRQaWVjZSIsInBvcCIsImtpbmciLCJyZXN1bHQiLCJ5eXkiLCJ4eHgiLCJtbW0iLCJjb3VudCIsInBpZWNlVG9BTiIsImNoYXJBdCIsIm1pc3NpbmdQaWVjZXMiLCJGRU5uYW1lIiwiZXYiLCJhY3RpdmVDb2xvdXIiLCJjYXN0bGluZ1RhcmdldCIsIndoaXRlS2luZ01vdmVkIiwiYmxhY2tLaW5nTW92ZWQiLCJwb3NzaWJsZUNhc3RsaW5nIiwicHJvcHMiLCJyb29rWCIsInJvb2tZIiwic29tZSIsImNhc3RsaW5nU2lkZSIsInRvVXBwZXJDYXNlIiwiZW5QYXNzYW50VGFyZ2V0IiwiZnVsbG1vdmVDb3VudCIsImluaXRpYWxpemVHYW1lIiwiZGVmYXVsdEdhbWUiLCJhbGxNb3ZlcyIsImNoYXJCYXNlIiwiY2hhciIsIlBhd24iLCJQSUVDRV9DSEFSUyIsIlJvb2siLCJLbmlnaHQiLCJrbmlnaHQiLCJCaXNob3AiLCJiaXNob3AiLCJRdWVlbiIsInF1ZWVuIiwiS2luZyIsIlciLCJCIiwiZW1wdHkiLCJsYXN0IiwiZmlnWCIsImNvbG9yWSIsImNvbG9yWTIiLCJmaWdYQXJyYXkiLCJfaSIsImNvZWYiLCJpbmRleCIsIm9uZSIsInR3byIsImNvb3JkaW5hdGVzIiwiYm9hcmRQaWVjZSIsImhlbHAiLCJyb29rTW92ZXMiLCJiaXNob3BNb3ZlcyIsImNvbmNhdCIsImNvb3JkIiwieHgiLCJ5eSIsIm5ld0tpbmdYIiwiZGlyIiwic2FmZSIsImV2diIsImV2TW92ZSIsInJvY2hhZGUiLCJfZ2FtZSIsIl9nYW1lMiIsIkNoZXNzQUkiLCJnYW1lU3RhdGUiLCJpc01heGltaXNpbmdQbGF5ZXIiLCJjdXJyZW50Q2VsbCIsImJlc3RWYWx1ZSIsIm5ld0dhbWVNb3ZlIiwidW5kbyIsImJvcmFkVmFsdWUiLCJtaW5pbWF4IiwiYWxwaGEiLCJiZXRhIiwiZXZhbHVhdGVCb2FyZCIsIk1hdGgiLCJtYXgiLCJfYmVzdFZhbHVlIiwiX3VuZG8iLCJtaW4iLCJ0b3RhbEV2YWx1YXRpb24iLCJnZXRQaWVjZVZhbHVlIiwiYWJzb2x1dGVWYWx1ZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJQaWVjZXMiLCJ1bmRlZmluZWQiLCJuZXdPYmoiLCJrZXkiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FJLEVBQUFKLEVBQ0FLLEdBQUEsRUFDQUgsV0FVQSxPQU5BSixHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBdkJBLEdBQUFELEtBNEJBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdBRixFQUFBVSxFQUFBLFNBQUFQLEVBQUFRLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFWLEVBQUFRLElBQ0FHLE9BQUFDLGVBQUFaLEVBQUFRLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BWixFQUFBbUIsRUFBQSxTQUFBZixHQUNBLEdBQUFRLEdBQUFSLEtBQUFnQixXQUNBLFdBQTJCLE1BQUFoQixHQUFBLFNBQzNCLFdBQWlDLE1BQUFBLEdBRWpDLE9BREFKLEdBQUFVLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVosRUFBQWEsRUFBQSxTQUFBUSxFQUFBQyxHQUFzRCxNQUFBUixRQUFBUyxVQUFBQyxlQUFBakIsS0FBQWMsRUFBQUMsSUFHdER0QixFQUFBeUIsRUFBQSxHQUdBekIsSUFBQTBCLEVBQUEsS0RNTSxTQUFVdEIsRUFBUUQsRUFBU0gsR0FFakMsWUVwRUEsSUFBQTJCLEdBQUEzQixFQUFBLEVBRUE0QixNQUFLQyxpQkFBaUIsVUFBVyxTQUFVQyxHQUN6QyxHQUFJQSxFQUFFQyxNQUFRRCxFQUFFQyxLQUFLQyxNQUFRRixFQUFFQyxLQUFLRSxjQUFlLENBQ2pELEdBQUlDLElBQVcsRUFBQVAsRUFBQVEsSUFBR0wsRUFBRUMsS0FBS0UsY0FBY0csTUFBT04sRUFBRUMsS0FBS0MsTUFBTSxFQUMzREosTUFBS1MsWUFBWUgsT0Y2RWYsU0FBVTlCLEVBQVFELEVBQVNILElHbkZqQyxTQUFBc0MsRUFBQUMsR0FFQW5DLEVBQUFELFFBQUFvQyxLQU9DLG1CQUFBWCxZQUFBLFdBQ0QsZ0JBQUE3QixHQUtBLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FJLEVBQUFKLEVBQ0FLLEdBQUEsRUFDQUgsV0FVQSxPQU5BSixHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBdkJBLEdBQUFELEtBNERBLE9BaENBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdBRixFQUFBVSxFQUFBLFNBQUFQLEVBQUFRLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFWLEVBQUFRLElBQ0FHLE9BQUFDLGVBQUFaLEVBQUFRLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BWixFQUFBbUIsRUFBQSxTQUFBZixHQUNBLEdBQUFRLEdBQUFSLEtBQUFnQixXQUNBLFdBQW1DLE1BQUFoQixHQUFBLFNBQ25DLFdBQXlDLE1BQUFBLEdBRXpDLE9BREFKLEdBQUFVLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVosRUFBQWEsRUFBQSxTQUFBUSxFQUFBQyxHQUE4RCxNQUFBUixRQUFBUyxVQUFBQyxlQUFBakIsS0FBQWMsRUFBQUMsSUFHOUR0QixFQUFBeUIsRUFBQSxHQUdBekIsSUFBQTBCLEVBQUEsS0FLQSxTQUFBdEIsRUFBQUQsRUFBQUgsR0FFQSxZQWVBLFNBQUF3QyxHQUFBQyxHQUVBQyxLQUFBQyxRQUVBLFFBQUF0QyxHQUFBLEVBQWlCQSxFQUFBLEVBQU9BLElBQUEsQ0FFeEIsT0FEQXVDLE1BQ0FDLEVBQUEsRUFBbUJBLEVBQUEsRUFBT0EsSUFDMUJELEVBQUFFLEtBQUEsS0FFQUosTUFBQUMsTUFBQUcsS0FBQUYsR0FJQUYsS0FBQUssUUFFQUwsS0FBQU0sT0FFQU4sS0FBQU8sWUFFQVAsS0FBQVEsYUEvQkFwQyxPQUFBQyxlQUFBWixFQUFBLGNBQ0FnRCxPQUFBLEdBR0EsSUFBQUMsR0FBQXBELEVBQUEsR0FFQXFELEVBQUFyRCxFQUFBLEdBRUFzRCxFQUVBLFNBQUFDLEdBQXNDLE1BQUFBLE1BQUFuQyxXQUFBbUMsR0FBdUNDLFFBQUFELElBRjdFRixFQTBCQWIsR0FBQWpCLFVBQUFrQyxNQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsR0FBQUosR0FBQUwsRUFBQVUsTUFBQUosR0FBQUMsRUFBQUMsRUFBQUMsRUFBQW5CLEtBQ0FBLE1BQUFDLE1BQUFpQixHQUFBRCxHQUFBRixFQUVBZixLQUFBTSxJQUFBTixLQUFBcUIsWUFDQXJCLEtBQUFPLFNBQUFQLEtBQUFzQixjQUdBeEIsRUFBQWpCLFVBQUEwQyxhQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFwQyxFQUFBcUMsR0FDQSxHQUFBWCxHQUFBUSxFQUFBUixFQUNBQyxFQUFBTyxFQUFBUCxDQUVBLElBQUFNLEVBQUEsQ0FDQSxHQUFBSyxJQUFnQlosRUFBQU8sRUFBQVAsRUFBQUMsRUFBQU0sRUFBQU4sRUFFaEIsSUFBQWxCLEtBQUFDLE1BQUFpQixHQUFBRCxLQUFBTyxFQUFBLENBSUEsT0FIQU0sR0FBQU4sRUFBQU8sZUFBQUgsR0FDQUksRUFBQSxLQUVBckUsRUFBQSxFQUFxQkEsRUFBQW1FLEVBQUFHLE9BQXVCdEUsSUFBQSxDQUM1QyxHQUFBdUUsR0FBQUosRUFBQW5FLEVBQ0EsSUFBQXVFLEVBQUFqQixPQUFBaUIsRUFBQWhCLE1BQUEsQ0FDQWMsRUFBQUUsQ0FDQSxRQUlBLElBQUFGLEVBQUEsUUFDQSxJQUNBRyxHQUFBQyxFQUFBQyxFQURBQyxFQUFBTixFQUFBTSxTQUVBQSxLQUNBSCxFQUFBRyxFQUFBVCxLQUNBTyxFQUFBRSxFQUFBYixHQUNBLE9BQUFXLEVBQ0FwQyxLQUFBQyxNQUFBa0MsRUFBQWpCLEdBQUFpQixFQUFBbEIsR0FBQSxNQUVBb0IsRUFBQXJDLEtBQUFDLE1BQUFrQyxFQUFBakIsR0FBQWlCLEVBQUFsQixHQUNBakIsS0FBQUMsTUFBQW1DLEVBQUFsQixHQUFBa0IsRUFBQW5CLEdBQUFvQixFQUNBQSxFQUFBcEIsRUFBQW1CLEVBQUFuQixFQUNBb0IsRUFBQW5CLEVBQUFrQixFQUFBbEIsRUFDQWxCLEtBQUFDLE1BQUFrQyxFQUFBakIsR0FBQWlCLEVBQUFsQixHQUFBLE1BSUEsSUFBQUYsR0FBQWYsS0FBQUMsTUFBQWlCLEdBQUFELEdBQUFqQixLQUFBQyxNQUFBaUIsR0FBQUQsR0FBQSxJQUNBcUIsS0FBQU4sRUFBQU0sVUFBQSxLQUNBdEMsS0FBQUssS0FBQUQsTUFDQXlCLE9BQ0FKLEtBQ0FOLE1BQUFLLEVBQUFMLE1BQ0FILEtBQUFRLEVBQUFSLEtBQ0FELFFBQ0F1QixjQUdBdEMsS0FBQUMsTUFBQWlCLEdBQUFELEdBQUFPLEVBQ0F4QixLQUFBQyxNQUFBdUIsRUFBQU4sR0FBQU0sRUFBQVAsR0FBQSxLQUNBakIsS0FBQUMsTUFBQWlCLEdBQUFELE9BQ0FqQixLQUFBQyxNQUFBaUIsR0FBQUQsR0FBQUMsSUFFQWxCLEtBQUFNLElBQUFOLEtBQUFxQixZQUNBckIsS0FBQU8sU0FBQVAsS0FBQXNCLGFBR0F0QixLQUFBUSxVQUFBSixLQUFBSixLQUFBTyxXQUNBLFNBQUFpQixFQUFBUixNQUFBRCxLQUFBZixLQUFBUSxjQUNBUixLQUFBdUMsa0JBQUFaLEVBQUEsS0FHQTNCLEtBQUF3QyxpQkFBQSxJQUFBYixFQUFBLEtBR0EsU0FBQUgsRUFBQVIsT0FDQSxNQUFBUSxFQUFBTCxPQUFBLElBQUFELEdBQUEsTUFBQU0sRUFBQUwsT0FBQSxJQUFBRCxJQUNBUSxJQUNBbkMsTUFBQWtELE1BQUFsRCxFQUFBbUQsVUFBQSxNQUFBbEIsRUFBQUwsTUFDQTVCLEVBQUFvRCxrQkFBQXBELEVBQUFvRCxvQkFBQTNDLEtBQUE0QyxZQUFBcEIsRUFBQVAsRUFBQUMsRUFBQU0sRUFBQUwsTUFBQSxTQUVBTyxFQUFBRixFQUFBUCxFQUFBQyxFQUFBTSxFQUFBTCxPQU1BLElBQUEwQixHQUFBLE1BQUFyQixFQUFBTCxNQUFBLFFBQ0EyQixFQUFBOUMsS0FBQStDLFVBQUFGLEVBSUEsSUFIQUMsR0FBQW5CLEVBQUFtQixHQUdBdkQsS0FBQWtELE1BQUFsRCxFQUFBeUQsS0FDQSxHQUFBekQsRUFBQTBELGlCQUNBMUQsRUFBQTBELHVCQUNTLENBQ1QsR0FBQXpELElBQUEsRUFBQW9CLEVBQUFFLFNBQUF2QixFQUFBRyxNQUFBTSxNQUFBLEVBQ0FBLE1BQUF1QixhQUFBdkIsS0FBQUMsTUFBQVQsRUFBQXFDLEtBQUFYLEdBQUExQixFQUFBcUMsS0FBQVosR0FBQXpCLEVBQUFpQyxHQUFBQyxFQUFBQyxHQUFBLEtBQUFDLElBTUEsTUFEQUosR0FBQSxNQUNBLElBSUExQixFQUFBakIsVUFBQStELFlBQUEsU0FBQU0sRUFBQWpDLEVBQUFDLEVBQUFDLEVBQUFILEdBQ0FoQixLQUFBZSxNQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxJQUdBckIsRUFBQWpCLFVBQUFzRSxrQkFBQSxTQUFBQyxFQUFBckMsR0FDQSxHQUFBZSxNQUNBNUMsRUFBQWMsS0FDQUMsRUFBQUQsS0FBQUMsS0EwQkEsT0F4QkFtRCxHQUFBQyxRQUFBLFNBQUFMLEVBQUFyRixHQUNBLEdBQUF1RCxHQUFBOEIsRUFBQTlCLEVBQ0FELEVBQUErQixFQUFBL0IsRUFDQVksR0FBZ0JaLEVBQUFGLEVBQUFFLEVBQUFDLEVBQUFILEVBQUFHLEdBQ2hCb0IsRUFBQXJDLEVBQUFpQixHQUFBRCxJQUNBRixNQUFBZCxFQUFBaUIsR0FBQUQsR0FDQVksTUFBYVosSUFBQUMsS0FDYk8sR0FBQSxNQUNLLElBRUx1QixHQUFBVixjQUFBVSxFQUFBVixXQUNBQSxHQUFBcEQsRUFBQW9FLGdCQUFBaEIsRUFBQXZCLE1BQUF1QixFQUFBVCxLQUFBUyxFQUFBYixJQUVBdkMsRUFBQW9FLGdCQUFBdkMsRUFBQWMsR0FBdUNaLElBQUFDLEtBQ3ZDLElBQUFxQyxHQUFBckUsRUFBQXFFLFFBQUF4QyxFQUFBSSxNQUdBakMsR0FBQW9FLGdCQUFBdkMsR0FBaUNFLElBQUFDLEtBQWFXLEdBRzlDUyxHQUFBcEQsRUFBQW9FLGdCQUFBaEIsRUFBQXZCLE1BQUF1QixFQUFBYixHQUFBYSxFQUFBVCxNQUVBMEIsR0FBQXpCLEVBQUExQixLQUFBNEMsS0FFQWxCLEdBR0FoQyxFQUFBakIsVUFBQWtFLFVBQUEsU0FBQTVCLEdBRUEsT0FBQXhELEdBQUEsRUFBaUJBLEVBQUEsRUFBT0EsSUFDeEIsT0FBQXdDLEdBQUEsRUFBbUJBLEVBQUEsRUFBT0EsSUFDMUIsR0FBQUgsS0FBQUMsTUFBQXRDLEdBQUF3QyxJQUFBSCxLQUFBQyxNQUFBdEMsR0FBQXdDLEdBQUFnQixXQUFBbkIsS0FBQUMsTUFBQXRDLEdBQUF3QyxHQUFBNEIsZUFBQSxHQUFBRSxPQUFBLFFBR0EsT0FBQWpDLE1BQUF1RCxRQUFBcEMsS0FDQSxLQUdBckIsRUFBQWpCLFVBQUF5RSxnQkFBQSxTQUFBdkMsRUFBQWMsRUFBQUosR0FDQSxHQUFBeEIsR0FBQUQsS0FBQUMsS0FDQXdCLEtBQ0F4QixFQUFBd0IsRUFBQVAsR0FBQU8sRUFBQVIsR0FBQUYsRUFDQUEsRUFBQUUsRUFBQVEsRUFBQVIsRUFDQUYsRUFBQUcsRUFBQU8sRUFBQVAsR0FFQVcsSUFBQTVCLEVBQUE0QixFQUFBWCxHQUFBVyxFQUFBWixHQUFBLE9BR0FuQixFQUFBakIsVUFBQTJFLFdBQUEsU0FBQVIsR0FDQSxHQUFBOUQsR0FBQWMsS0FDQUMsRUFBQWYsRUFBQWUsTUFDQTRCLEVBQUFtQixFQUFBbkIsS0FDQUosRUFBQXVCLEVBQUF2QixHQUNBVixFQUFBZCxFQUFBNEIsRUFBQVgsR0FBQVcsRUFBQVosR0FDQXdDLEVBQUF6RCxLQUFBQyxNQUFBd0IsRUFBQVAsR0FBQU8sRUFBQVIsR0FBQWpCLEtBQUFDLE1BQUF3QixFQUFBUCxHQUFBTyxFQUFBUixHQUFBLEtBQ0FxQixFQUFBckMsRUFBQXdCLEVBQUFQLEdBQUFPLEVBQUFSLElBQ0FGLE1BQUFkLEVBQUF3QixFQUFBUCxHQUFBTyxFQUFBUixHQUNBWSxNQUFXWixFQUFBUSxFQUFBUixFQUFBQyxFQUFBTyxFQUFBUCxHQUNYTyxHQUFBLE1BQ0csSUFlSCxPQWJBekIsTUFBQUssS0FBQUQsTUFDQXlCLE9BQ0FKLElBQVNSLEVBQUFRLEVBQUFSLEVBQUFDLEVBQUFPLEVBQUFQLEdBQ1RDLE1BQUE2QixFQUFBN0IsTUFDQUgsS0FBQUQsRUFBQUMsS0FDQUQsTUFBQTBDLEVBQ0FuQixjQUdBYixFQUFBYSxjQUFBYixFQUFBYSxXQUNBQSxHQUFBcEQsRUFBQW9FLGdCQUFBaEIsRUFBQXZCLE1BQUF1QixFQUFBVCxLQUFBUyxFQUFBYixJQUNBdkMsRUFBQW9FLGdCQUFBdkMsRUFBQWMsR0FBcUNaLEVBQUFRLEVBQUFSLEVBQUFDLEVBQUFPLEVBQUFQLElBRXJDLFdBRUFvQixHQUFBcEQsRUFBQW9FLGdCQUFBaEIsRUFBQXZCLE1BQUF1QixFQUFBYixHQUFBYSxFQUFBVCxNQUNBM0MsRUFBQW9FLGdCQUFBdkMsR0FBaUNFLEVBQUFRLEVBQUFSLEVBQUFDLEVBQUFPLEVBQUFQLEdBQW1CVyxHQUNwRDRCLElBQUF4RCxFQUFBd0IsRUFBQVAsR0FBQU8sRUFBQVIsR0FBQXdDLEdBQ0F2RSxFQUFBbUIsS0FBQXFELFFBSUE1RCxFQUFBakIsVUFBQTBFLFFBQUEsU0FBQXBDLEdBQ0EsR0FDQXdDLEdBREFDLEdBQUEsQ0FvQkEsT0FqQkE1RCxNQUFBQyxNQUFBb0QsUUFBQSxTQUFBUSxHQUNBQSxFQUFBUixRQUFBLFNBQUFTLEdBQ0FBLEtBQUEzQyxXQUFBLFNBQUEyQyxFQUFBOUMsT0FDQTJDLEVBQUFHLE9BS0E5RCxLQUFBQyxNQUFBb0QsUUFBQSxTQUFBUSxHQUNBQSxFQUFBUixRQUFBLFNBQUFTLEdBQ0FBLEtBQUEzQyxXQUNBMkMsRUFBQS9CLGdCQUFBc0IsUUFBQSxTQUFBVSxHQUNBQSxFQUFBOUMsSUFBQTBDLEVBQUExQyxHQUFBOEMsRUFBQTdDLElBQUF5QyxFQUFBekMsSUFBQTBDLEdBQUEsU0FLQUEsR0FHQTlELEVBQUFqQixVQUFBMEQsZUFBQSxXQUlBLE9BSEEvQixHQUFBUixLQUFBUSxVQUNBeUIsRUFBQXpCLEVBQUF5QixPQUVBdEUsRUFBQSxFQUFpQkEsRUFBQXNFLEVBQVl0RSxJQUFBLENBRzdCLE9BREFxRyxHQUFBLEVBQ0E3RCxFQUFBeEMsRUFBQSxFQUF1QndDLEVBQUE4QixFQUFZOUIsSUFDbkNLLEVBQUE3QyxLQUFBNkMsRUFBQUwsS0FBQTZELEdBQUEsRUFFQSxJQUFBQSxHQUFBLFdBR0EsVUFHQWxFLEVBQUFqQixVQUFBb0YsVUFBQSxTQUFBaEQsRUFBQUMsR0FFQSxNQURBLFdBQ0FnRCxPQUFBakQsSUFBQSxFQUFBQyxJQUlBcEIsRUFBQWpCLFVBQUF5QyxXQUFBLFdBTUEsT0FMQXJCLEdBQUFELEtBQUFDLE1BR0FNLEVBQUEsR0FDQTRELEVBQUEsRUFDQXhHLEVBQUEsRUFBaUJBLEVBQUEsRUFBT0EsSUFBQSxDQUN4QixPQUFBd0MsR0FBQSxFQUFtQkEsRUFBQSxFQUFPQSxJQUMxQkYsRUFBQXRDLEdBQUF3QyxJQUNBZ0UsSUFBQTVELEdBQUE0RCxHQUNBQSxFQUFBLEVBQ0E1RCxHQUFBTixFQUFBdEMsR0FBQXdDLEdBQUFpRSxTQUVBRCxHQUdBQSxLQUFBNUQsR0FBQTRELEdBQ0FBLEVBQUEsRUFDQTVELEdBQUE1QyxFQUFBLFNBR0EsTUFBQTRDLElBR0FULEVBQUFqQixVQUFBMkQsY0FBQSxXQUNBLEdBQUFuQyxHQUFBTCxLQUFBSyxLQUNBNEIsRUFBQTVCLEVBQUE0QixPQUNBK0IsRUFBQSxDQUNBLFFBQUEzRCxFQUFBNEIsT0FBQSxNQUFBK0IsRUFHQSxLQURBLEdBQUFLLEdBQUFoRSxFQUFBNEIsRUFBQSxFQUFBK0IsR0FDQUEsR0FBQS9CLEVBQUEsWUFBQW9DLEVBQUFyRCxPQUFBcUQsRUFBQXRELE9BQ0FpRCxJQUNBSyxFQUFBaEUsRUFBQTRCLEVBQUEsRUFBQStCLEVBR0EsT0FBQUEsSUFHQWxFLEVBQUFqQixVQUFBeUYsYUFBQSxXQUNBLEdBQUFqRSxHQUFBTCxLQUFBSyxJQUdBLE9BRkFBLEdBQUE0QixRQUFBLE1BQUE1QixJQUFBNEIsT0FBQSxHQUFBZCxNQUFBLFNBS0FyQixFQUFBakIsVUFBQTBGLGVBQUEsV0FDQSxHQUlBQyxHQUNBQyxFQUxBeEUsRUFBQUQsS0FBQUMsTUFDQUksRUFBQUwsS0FBQUssS0FDQXFFLEVBQUEsRUErQkEsT0EzQkFyRSxHQUFBZ0QsUUFBQSxTQUFBaEQsR0FDQW1FLEVBQUEsU0FBQW5FLEVBQUFXLE1BQUEsTUFBQVgsRUFBQWMsTUFDQXNELEVBQUEsU0FBQXBFLEVBQUFXLE1BQUEsTUFBQVgsRUFBQWMsVUFHQSx3QkFBQWtDLFFBQUEsU0FBQXNCLEdBQ0EsR0FBQUMsR0FBQUQsRUFBQSxHQUNBRSxFQUFBRixFQUFBLEdBQ0F0QyxFQUFBcEMsRUFBQTRFLEdBQUFELEVBRUEsU0FBQUMsSUFBQUwsS0FDQSxJQUFBSyxJQUFBSixJQUdBcEMsR0FBQSxVQUFBQSxFQUFBckIsT0FHQVgsRUFBQXlFLEtBQUEsU0FBQVQsR0FDQSxlQUFBQSxFQUFBckQsT0FDQXFELEVBQUF4QyxLQUFBWixJQUFBMkQsR0FBQVAsRUFBQXhDLEtBQUFYLElBQUEyRCxLQUZBLENBS0EsR0FBQUUsR0FBQSxJQUFBSCxFQUFBLE9BQ0FGLElBQUEsSUFBQUcsRUFBQUUsRUFBQUMsY0FBQUQsS0FHQUwsTUFBQSxLQUNBQSxHQUdBNUUsRUFBQWpCLFVBQUFvRyxnQkFBQSxXQUNBLEdBQUE1RSxHQUFBTCxLQUFBSyxLQUNBNEUsRUFBQSxFQUVBLElBQUE1RSxFQUFBNEIsT0FBQSxDQUNBLEdBQUFvQyxHQUFBaEUsSUFBQTRCLE9BQUEsRUFDQSxPQUFBb0MsRUFBQWxELE9BQUEsSUFBQWtELEVBQUE1QyxHQUFBUCxJQUNBK0QsRUFBQWpGLEtBQUFpRSxVQUFBSSxFQUFBNUMsR0FBQVIsRUFBQW9ELEVBQUE1QyxHQUFBUCxFQUFBLElBR0EsTUFBQW1ELEVBQUFsRCxPQUFBLElBQUFrRCxFQUFBNUMsR0FBQVAsSUFDQStELEVBQUFqRixLQUFBaUUsVUFBQUksRUFBQTVDLEdBQUFSLEVBQUFvRCxFQUFBNUMsR0FBQVAsRUFBQSxJQUtBLE1BREErRCxPQUFBLEtBQ0FBLEdBR0FuRixFQUFBakIsVUFBQXFHLGNBQUEsV0FDQSxHQUFBbEIsR0FBQSxDQUtBLE9BSkFoRSxNQUFBSyxLQUFBZ0QsUUFBQSxTQUFBZ0IsR0FDQSxNQUFBQSxFQUFBbEQsUUFBQTZDLEdBQUEsS0FHQUEsR0FHQWxFLEVBQUFqQixVQUFBd0MsVUFBQSxXQUNBLEdBQUFmLEdBQUEsRUEwQkEsT0F2QkFBLElBQUFOLEtBQUFzQixhQUdBaEIsR0FBQSxJQUFBTixLQUFBc0UsZUFHQWhFLEdBQUEsSUFBQU4sS0FBQXVFLGlCQUdBakUsR0FBQSxJQUFBTixLQUFBaUYsa0JBR0EzRSxHQUFBLElBQUFOLEtBQUF3QyxnQkFHQWxDLEdBQUEsSUFBQU4sS0FBQWtGLGlCQVlBcEYsRUFBQWpCLFVBQUFzRyxlQUFBLFdBSUEsT0FIQUMsR0FBQSxHQUFBdEYsR0FHQW5DLEVBQUEsRUFBaUJBLEVBQUEsRUFBT0EsSUFDeEJ5SCxFQUFBckUsTUFBQSxPQUFBcEQsRUFBQSxPQUNBeUgsRUFBQXJFLE1BQUEsT0FBQXBELEVBQUEsTUF1QkEsT0FuQkF5SCxHQUFBckUsTUFBQSxnQkFDQXFFLEVBQUFyRSxNQUFBLGtCQUNBcUUsRUFBQXJFLE1BQUEsa0JBQ0FxRSxFQUFBckUsTUFBQSxpQkFDQXFFLEVBQUFyRSxNQUFBLGdCQUNBcUUsRUFBQXJFLE1BQUEsa0JBQ0FxRSxFQUFBckUsTUFBQSxrQkFDQXFFLEVBQUFyRSxNQUFBLGdCQUdBcUUsRUFBQXJFLE1BQUEsZ0JBQ0FxRSxFQUFBckUsTUFBQSxrQkFDQXFFLEVBQUFyRSxNQUFBLGtCQUNBcUUsRUFBQXJFLE1BQUEsaUJBQ0FxRSxFQUFBckUsTUFBQSxnQkFDQXFFLEVBQUFyRSxNQUFBLGtCQUNBcUUsRUFBQXJFLE1BQUEsa0JBQ0FxRSxFQUFBckUsTUFBQSxnQkFFQXFFLEdBR0F0RixFQUFBakIsVUFBQXdHLFNBQUEsV0FLQSxPQUpBcEYsR0FBQUQsS0FBQUMsTUFDQW9GLEtBQ0FmLEVBQUF0RSxLQUFBc0UsZUFBQVUsY0FFQXJILEVBQUEsRUFBaUJBLEVBQUEsRUFBT0EsSUFDeEIsT0FBQXdDLEdBQUEsRUFBbUJBLEVBQUEsRUFBT0EsSUFDMUIsR0FBQUYsRUFBQXRDLEdBQUF3QyxJQUFBRixFQUFBdEMsR0FBQXdDLEdBQUFnQixRQUFBbUQsRUFBQSxDQUNBLEdBQUF4QyxHQUFBN0IsRUFBQXRDLEdBQUF3QyxHQUFBNEIsZUFBQSxFQUNBRCxHQUFBdUIsUUFBQSxTQUFBZ0IsR0FDQWdCLEVBQUFqRixNQUNBZSxNQUFBbEIsRUFBQXRDLEdBQUF3QyxHQUFBZ0IsTUFDQVUsTUFBbUJaLEVBQUFkLEVBQUFlLEVBQUF2RCxHQUNuQjhELEdBQUE0QyxFQUNBRCxRQUFBbkUsRUFBQXRDLEdBQUF3QyxHQUFBaUUsWUFPQSxNQUFBaUIsSUFHQTVILEVBQUFxRCxRQUFBaEIsR0FJQSxTQUFBcEMsRUFBQUQsRUFBQUgsR0FFQSxZQW1CQSxTQUFBOEQsR0FBQUgsRUFBQUMsRUFBQW9FLEVBQUFuRSxFQUFBN0IsRUFBQTBCLEdBT0EsR0FOQXNFLElBQUF0RixLQUFBdUYsS0FBQUQsRUFBQW5FLElBQ0FuQixLQUFBbUIsUUFDQW5CLEtBQUFpQixJQUNBakIsS0FBQWtCLElBQ0FsQixLQUFBVixPQUNBVSxLQUFBZ0IsT0FDQUEsRUFBQSxDQUNBLEdBQUFvRCxHQUFBLFdBQUFwRCxFQUFBLElBQUFBLEVBQUFrRCxPQUFBLEVBQ0EsT0FBQWxFLEtBQUFtQixRQUFBaUQsSUFBQVksZUFDQWhGLEtBQUFvRSxXQVlBLFFBQUFvQixHQUFBdkUsRUFBQUMsRUFBQUMsRUFBQTdCLEdBQ0E4QixFQUFBdkQsS0FBQW1DLEtBQUFpQixFQUFBQyxFQUFBdUUsRUFBQXZDLEtBQUEvQixFQUFBN0IsRUFBQSxRQXFFQSxRQUFBb0csR0FBQXpFLEVBQUFDLEVBQUFDLEVBQUE3QixHQUNBOEIsRUFBQXZELEtBQUFtQyxLQUFBaUIsRUFBQUMsRUFBQXVFLEVBQUFwRCxLQUFBbEIsRUFBQTdCLEVBQUEsUUF1Q0EsUUFBQXFHLEdBQUExRSxFQUFBQyxFQUFBQyxFQUFBN0IsR0FDQThCLEVBQUF2RCxLQUFBbUMsS0FBQWlCLEVBQUFDLEVBQUF1RSxFQUFBRyxPQUFBekUsRUFBQTdCLEVBQUEsVUEyQ0EsUUFBQXVHLEdBQUE1RSxFQUFBQyxFQUFBQyxFQUFBN0IsR0FDQThCLEVBQUF2RCxLQUFBbUMsS0FBQWlCLEVBQUFDLEVBQUF1RSxFQUFBSyxPQUFBM0UsRUFBQTdCLEVBQUEsVUF1Q0EsUUFBQXlHLEdBQUE5RSxFQUFBQyxFQUFBQyxFQUFBN0IsR0FDQThCLEVBQUF2RCxLQUFBbUMsS0FBQWlCLEVBQUFDLEVBQUF1RSxFQUFBTyxNQUFBN0UsRUFBQTdCLEVBQUEsU0EwQkEsUUFBQTJHLEdBQUFoRixFQUFBQyxFQUFBQyxFQUFBN0IsR0FDQThCLEVBQUF2RCxLQUFBbUMsS0FBQWlCLEVBQUFDLEVBQUF1RSxFQUFBOUIsS0FBQXhDLEVBQUE3QixFQUFBLFFBcFFBbEIsT0FBQUMsZUFBQVosRUFBQSxjQUNBZ0QsT0FBQSxHQU1BLElBQUFnRixHQUFBaEksRUFBQWdJLGFBQ0F2QyxNQUFTZ0QsRUFBQSxJQUFBQyxFQUFBLEtBQ1Q5RCxNQUFTNkQsRUFBQSxJQUFBQyxFQUFBLEtBQ1RQLFFBQVdNLEVBQUEsSUFBQUMsRUFBQSxLQUNYTCxRQUFXSSxFQUFBLElBQUFDLEVBQUEsS0FDWEgsT0FBVUUsRUFBQSxJQUFBQyxFQUFBLEtBQ1Z4QyxNQUFTdUMsRUFBQSxJQUFBQyxFQUFBLEtBaUJUL0UsR0FBQWdGLE1BQUEsV0FDQSxVQUFBaEYsSUFHQUEsRUFBQXZDLFVBQUFrRCxjQUFBLFdBQ0EsUUFBV2QsRUFBQSxFQUFBQyxFQUFBLElBQWdCRCxFQUFBLEVBQUFDLEVBQUEsS0FPM0JzRSxFQUFBM0csVUFBQXVDLEVBQUFnRixRQUNBWixFQUFBM0csVUFBQWtELGNBQUEsU0FBQUgsR0FDQSxHQVFBeUUsR0FBQUMsRUFSQWhILEVBQUFVLEtBQUFWLEtBQ0E4RCxLQUVBbEMsRUFBQWxCLEtBQUFrQixFQUNBRCxFQUFBakIsS0FBQWlCLEVBQ0FoQixFQUFBWCxFQUFBVyxNQUNBSSxFQUFBZixFQUFBZSxLQUNBNEIsRUFBQTVCLEVBQUE0QixPQUVBc0UsRUFBQSxNQUFBdkcsS0FBQW1CLE1BQUFELEVBQUEsRUFBQUEsRUFBQSxFQUNBc0YsRUFBQSxNQUFBeEcsS0FBQW1CLE1BQUFELEVBQUEsRUFBQUEsRUFBQSxFQUVBdUYsR0FEQXpHLEtBQUFtQixPQUNBRixFQUFBLEVBQUFBLEVBQUEsR0FHQXNGLEdBQUEsR0FBQUEsR0FBQSxJQUFBdEcsRUFBQXNHLEdBQUF0RixLQUNBbUMsRUFBQWhELE1BQWdCYSxJQUFBQyxFQUFBcUYsS0FDaEIsSUFBQXJGLEdBQUEsSUFBQUEsSUFBQXNGLEVBQUEsR0FBQUEsR0FBQSxJQUFBbEgsRUFBQVcsTUFBQXVHLEdBQUF2RixJQUNBbUMsRUFBQWhELE1BQWtCYSxJQUFBQyxFQUFBc0YsSUFJbEIsUUFBQTdJLEdBQUEsRUFBaUJBLEVBQUEsRUFBT0EsSUFDeEIySSxFQUFBRyxFQUFBOUksR0FDQTRJLEVBQUEsR0FBQUEsR0FBQSxHQUFBdEcsRUFBQXNHLEdBQUFELElBQUFyRyxFQUFBc0csR0FBQUQsR0FBQW5GLFFBQUFuQixLQUFBbUIsT0FBQWlDLEVBQUFoRCxNQUFrSGEsRUFBQXFGLEVBQUFwRixFQUFBcUYsR0FJbEgsUUFBQUcsR0FBQSxFQUFrQkEsRUFBQSxFQUFRQSxJQUMxQkosRUFBQUcsRUFBQUMsS0FDQUwsRUFBQWhHLEVBQUE0QixFQUFBLEtBRUEsU0FBQW9FLEVBQUFyRixNQUFBcUYsRUFBQTVFLEdBQUFSLElBQUFxRixHQUFBRCxFQUFBNUUsR0FBQVAsT0FBQW1GLEVBQUFsRixRQUFBbkIsS0FBQW1CLE9BQUEsSUFBQWtGLEVBQUF4RSxLQUFBWCxHQUFBLElBQUFtRixFQUFBeEUsS0FBQVgsR0FBQSxJQUFBQSxHQUFBLElBQUFBLEdBQ0FrQyxFQUFBaEQsTUFDQWEsRUFBQXFGLEVBQ0FwRixFQUFBcUYsRUFDQWpFLFdBQ0F2QixNQUFBekIsRUFBQVcsTUFBQWlCLEdBQUFvRixHQUNBekUsTUFDQVosRUFBQXFGLEVBQ0FwRixLQUVBTyxHQUFBLE9BYUEsT0FOQUcsR0FDQXRDLEVBQUE2RCxrQkFBQUMsRUFBQXBELE1BRUFvRCxHQU1BaEMsRUFBQThCLEtBQUEsU0FBQWpDLEVBQUFDLEVBQUFDLEVBQUE3QixHQUNBLFVBQUFrRyxHQUFBdkUsRUFBQUMsRUFBQUMsRUFBQTdCLElBU0FvRyxFQUFBN0csVUFBQXVDLEVBQUFnRixRQUNBVixFQUFBN0csVUFBQWtELGNBQUEsU0FBQUgsR0FDQSxHQUFBdEMsR0FBQVUsS0FBQVYsS0FDQThELFFBRUEseUJBQUFDLFFBQUEsU0FBQXNELEdBQ0EsR0FBQUMsR0FBQTNGLEVBQUFDLEVBQUFILENBQ0EsS0FBQTZGLEVBQUEsR0FDQTNGLEVBQUFqQixLQUFBaUIsRUFBQTBGLEVBQUEsR0FBQUMsS0FDQTFGLEVBQUFsQixLQUFBa0IsRUFBQXlGLEVBQUEsR0FBQUMsR0FDQSxHQUFBMUYsRUFBQSxHQUFBRCxFQUFBLEdBQUFBLEVBQUEsUUFFQUYsRUFBQXpCLEVBQUFXLE1BQUFpQixHQUFBRCxLQUNBRixFQUFBSSxRQUFBbkIsS0FBQW1CLFNBRUFpQyxFQUFBaEQsTUFBa0JhLElBQUFDLE9BQ2xCSCxHQVRvQjZGLE9BV2pCNUcsS0FTSCxPQU5BNEIsR0FDQXRDLEVBQUE2RCxrQkFBQUMsRUFBQXBELE1BRUFvRCxHQU1BaEMsRUFBQWlCLEtBQUEsU0FBQXBCLEVBQUFDLEVBQUFDLEVBQUE3QixHQUNBLFVBQUFvRyxHQUFBekUsRUFBQUMsRUFBQUMsRUFBQTdCLElBU0FxRyxFQUFBOUcsVUFBQXVDLEVBQUFnRixRQUNBVCxFQUFBOUcsVUFBQWtELGNBQUEsU0FBQUgsR0FPQSxPQURBaUYsR0FBQUMsRUFMQXhILEVBQUFVLEtBQUFWLEtBQ0E4RCxLQUVBMkQsSUFBQSx3REFHQXBKLEVBQUEsRUFBaUJBLEVBQUFvSixFQUFBOUUsT0FBd0J0RSxJQUFBLENBQ3pDLEdBQ0FxSixHQURBQyxHQUFBLENBRUFKLEdBQUFFLEVBQUFwSixHQUFBLEdBQ0FtSixFQUFBQyxFQUFBcEosR0FBQSxHQUVBcUMsS0FBQWlCLEVBQUE0RixFQUFBLEdBQUE3RyxLQUFBaUIsRUFBQTRGLEdBQUEsR0FBQTdHLEtBQUFrQixFQUFBNEYsRUFBQSxHQUFBOUcsS0FBQWtCLEVBQUE0RixHQUFBLElBQ0FFLEVBQUExSCxFQUFBVyxNQUFBRCxLQUFBa0IsRUFBQTRGLEdBQUE5RyxLQUFBaUIsRUFBQTRGLEdBQ0FJLEdBQUFELEtBQUE3RixRQUFBbkIsS0FBQW1CLE9BR0E4RixHQUNBN0QsRUFBQWhELE1BQWtCYSxFQUFBakIsS0FBQWlCLEVBQUE0RixFQUFBM0YsRUFBQWxCLEtBQUFrQixFQUFBNEYsSUFXbEIsTUFOQWxGLEdBQ0F0QyxFQUFBNkQsa0JBQUFDLEVBQUFwRCxNQUVBb0QsR0FNQWhDLEVBQUF3RSxPQUFBLFNBQUEzRSxFQUFBQyxFQUFBQyxFQUFBN0IsR0FDQSxVQUFBcUcsR0FBQTFFLEVBQUFDLEVBQUFDLEVBQUE3QixJQVNBdUcsRUFBQWhILFVBQUF1QyxFQUFBZ0YsUUFDQVAsRUFBQWhILFVBQUFrRCxjQUFBLFNBQUFILEdBQ0EsR0FBQXRDLEdBQUFVLEtBQUFWLEtBQ0E4RCxRQUVBLDJCQUFBQyxRQUFBLFNBQUFzRCxHQUNBLEdBQUFDLEdBQUEzRixFQUFBQyxFQUFBSCxDQUNBLEtBQUE2RixFQUFBLEdBQ0EzRixFQUFBakIsS0FBQWlCLEVBQUEwRixFQUFBLEdBQUFDLEtBQ0ExRixFQUFBbEIsS0FBQWtCLEVBQUF5RixFQUFBLEdBQUFDLEdBQ0EsR0FBQTFGLEVBQUEsR0FBQUQsRUFBQSxHQUFBQSxFQUFBLFFBRUFGLEVBQUF6QixFQUFBVyxNQUFBaUIsR0FBQUQsS0FDQUYsRUFBQUksUUFBQW5CLEtBQUFtQixTQUVBaUMsRUFBQWhELE1BQWtCYSxJQUFBQyxPQUNsQkgsR0FUb0I2RixPQVdqQjVHLEtBU0gsT0FOQTRCLEdBQ0F0QyxFQUFBNkQsa0JBQUFDLEVBQUFwRCxNQUVBb0QsR0FNQWhDLEVBQUEwRSxPQUFBLFNBQUE3RSxFQUFBQyxFQUFBQyxFQUFBN0IsR0FDQSxVQUFBdUcsR0FBQTVFLEVBQUFDLEVBQUFDLEVBQUE3QixJQVNBeUcsRUFBQWxILFVBQUF1QyxFQUFBZ0YsUUFDQUwsRUFBQWxILFVBQUFrRCxjQUFBLFNBQUFILEdBQ0EsR0FBQXRDLEdBQUFVLEtBQUFWLEtBQ0E0SCxFQUFBeEIsRUFBQTdHLFVBQUFrRCxjQUFBbEUsS0FBQW1DLE1BQ0FtSCxFQUFBdEIsRUFBQWhILFVBQUFrRCxjQUFBbEUsS0FBQW1DLE1BQ0FvRCxFQUFBOEQsRUFBQUUsT0FBQUQsRUFTQSxPQU5BdkYsR0FDQXRDLEVBQUE2RCxrQkFBQUMsRUFBQXBELE1BRUFvRCxHQU1BaEMsRUFBQTRFLE1BQUEsU0FBQS9FLEVBQUFDLEVBQUFDLEVBQUE3QixHQUNBLFVBQUF5RyxHQUFBOUUsRUFBQUMsRUFBQUMsRUFBQTdCLElBU0EyRyxFQUFBcEgsVUFBQXVDLEVBQUFnRixRQUNBSCxFQUFBcEgsVUFBQWtELGNBQUEsU0FBQUgsR0FDQSxHQUFBd0IsTUFDQTJELElBQUEsc0RBQ0E5RixFQUFBakIsS0FBQWlCLEVBQ0FDLEVBQUFsQixLQUFBa0IsRUFDQTVCLEVBQUFVLEtBQUFWLEtBQ0FlLEVBQUFmLEVBQUFlLEtBQ0FuQixFQUFBYyxJQUVBK0csR0FBQTFELFFBQUEsU0FBQWdFLEdBQ0EsR0FBQXRHLEdBQ0F1RyxFQUFBckcsRUFBQW9HLEVBQUEsR0FDQUUsRUFBQXJHLEVBQUFtRyxFQUFBLEVBRUFDLEdBQUEsR0FBQUEsR0FBQSxHQUFBQyxFQUFBLEdBQUFBLEdBQUEsS0FDQXhHLEVBQUF6QixFQUFBVyxNQUFBc0gsR0FBQUQsS0FDQXZHLEVBQUFJLFFBQUFqQyxFQUFBaUMsT0FDQWlDLEVBQUFoRCxNQUFvQmEsRUFBQXFHLEVBQUFwRyxFQUFBcUcsT0FNcEJsSCxFQUFBeUUsS0FBQSxTQUFBekUsR0FDQSxlQUFBQSxFQUFBVyxNQUFBWCxFQUFBYyxRQUFBakMsRUFBQWlDLFdBSUEsaUJBQUFrQyxRQUFBLFNBQUFzQixHQUNBLEdBQUFDLEdBQUFELEVBQUEsR0FDQTZDLEVBQUE3QyxFQUFBLEdBQ0E4QyxFQUFBOUMsRUFBQSxHQUNBdEMsRUFBQS9DLEVBQUFXLE1BQUFpQixHQUFBMEQsRUFHQSxJQUFBdkMsR0FBQSxVQUFBQSxFQUFBckIsT0FHQVgsRUFBQXlFLEtBQUEsU0FBQVQsR0FDQSxNQUFBQSxHQUFBeEMsS0FBQVosSUFBQTJELEdBQUFQLEVBQUF4QyxLQUFBWCxRQURBLENBS0EsT0FBQW9HLEdBQUFyRyxFQUFBd0csRUFBNEJILElBQUExQyxFQUFjMEMsR0FBQUcsRUFBQSxDQUMxQyxHQUFBbkksRUFBQVcsTUFBQWlCLEdBQUFvRyxHQUFBLE1BQ0EsSUFBQUksSUFBQSxDQVVBLElBVEFwSSxFQUFBVyxNQUFBb0QsUUFBQSxTQUFBZ0IsR0FDQUEsRUFBQWhCLFFBQUEsU0FBQXNFLEdBQ0FBLEdBQUEsU0FBQUEsRUFBQTNHLE1BQUEyRyxFQUFBeEcsUUFBQWpDLEVBQUFpQyxPQUNBd0csRUFBQTVGLGdCQUFBc0IsUUFBQSxTQUFBdUUsR0FDQUEsS0FBQTFHLE9BQUEwRyxFQUFBM0csSUFBQXFHLElBQUFJLEdBQUEsVUFLQUEsRUFBQSxPQUdBLEdBQUFHLElBQ0E1RyxFQUFBdUcsRUFDQXRHLElBQ0FvQixXQUNBdkIsTUFBQTdCLEVBQUFJLEtBQUFXLE1BQUFpQixHQUFBMEQsR0FDQS9DLE1BQ0FaLEVBQUEyRCxFQUFBMUQsS0FFQU8sSUFDQVAsSUFBQUQsSUFBQXdHLElBS0FyRSxHQUFBaEQsS0FBQXlILEtBV0EsT0FOQWpHLEdBQ0F0QyxFQUFBNkQsa0JBQUFDLEVBQUFsRSxHQUVBa0UsR0FNQWhDLEVBQUF1QyxLQUFBLFNBQUExQyxFQUFBQyxFQUFBQyxFQUFBN0IsR0FDQSxVQUFBMkcsR0FBQWhGLEVBQUFDLEVBQUFDLEVBQUE3QixJQUdBN0IsRUFBQTJELFFBQ0EzRCxFQUFBK0gsT0FDQS9ILEVBQUFpSSxPQUNBakksRUFBQWtJLFNBQ0FsSSxFQUFBb0ksU0FDQXBJLEVBQUFzSSxRQUNBdEksRUFBQXdJLFFBSUEsU0FBQXZJLEVBQUFELEVBQUFILEdBRUEsWUFHQWMsUUFBQUMsZUFBQVosRUFBQSxjQUNBZ0QsT0FBQSxHQUdBLElBQUFxSCxHQUFBeEssRUFBQSxHQUVBeUssRUFFQSxTQUFBbEgsR0FBc0MsTUFBQUEsTUFBQW5DLFdBQUFtQyxHQUF1Q0MsUUFBQUQsSUFGN0VpSCxHQUlBRSxFQUFBLFNBQUF0SSxFQUFBdUksRUFBQUMsR0FRQSxPQUZBNUksR0FBQXlJLEVBQUFqSCxRQUFBakMsVUFBQXNHLGlCQUVBeEgsRUFBQSxFQUFpQkEsRUFBQSxFQUFPQSxJQUN4QixPQUFBd0MsR0FBQSxFQUFtQkEsRUFBQSxFQUFPQSxJQUMxQixHQUFBOEgsRUFBQWhJLE1BQUF0QyxHQUFBd0MsR0FBQSxDQUNBLEdBQUFnSSxHQUFBRixFQUFBaEksTUFBQXRDLEdBQUF3QyxFQUNBYixHQUFBeUIsTUFBQW9ILEVBQUFuSCxLQUFBYixFQUFBeEMsRUFBQXdLLEVBQUFoSCxXQUVBN0IsR0FBQVcsTUFBQXRDLEdBQUF3QyxHQUFBLElBS0FiLEdBQUFlLEtBQUE0SCxFQUFBNUgsS0FDQWYsRUFBQWtCLFVBQUF5SCxFQUFBekgsVUFDQWxCLEVBQUFnQixJQUFBMkgsRUFBQTNILElBQ0FoQixFQUFBaUIsU0FBQTBILEVBQUExSCxRQU9BLFFBRkFmLEdBRkE2RixFQUFBL0YsRUFBQStGLFdBQ0ErQyxHQUFBLEtBR0F6SyxFQUFBLEVBQWlCQSxFQUFBMEgsRUFBQXBELE9BQXFCdEUsSUFBQSxDQUN0QyxHQUFBMEssR0FBQWhELEVBQUExSCxHQUNBMkssRUFBQWhKLEVBQUFrRSxXQUFBNkUsR0FDQUUsRUFBQUMsRUFBQTlJLEVBQUEsRUFBQUosR0FBQSxTQUFBNEksRUFDQUksS0FDQUMsR0FBQUgsSUFDQUEsRUFBQUcsRUFDQS9JLEVBQUE2SSxHQUdBLE1BQUE3SSxJQUtBZ0osRUFBQSxRQUFBQSxHQUFBOUksRUFBQUosRUFBQW1KLEVBQUFDLEVBQUFSLEdBQ0EsT0FBQXhJLEVBQ0EsT0FBQWlKLEVBQUFySixFQUFBVyxNQUdBLElBQUFvRixHQUFBL0YsRUFBQStGLFVBQ0EsSUFBQTZDLEVBQUEsQ0FFQSxPQURBRSxJQUFBLEtBQ0F6SyxFQUFBLEVBQW1CQSxFQUFBMEgsRUFBQXBELE9BQXFCdEUsSUFBQSxDQUN4QyxHQUFBMkssR0FBQWhKLEVBQUFrRSxXQUFBNkIsRUFBQTFILEdBSUEsSUFIQXlLLEVBQUFRLEtBQUFDLElBQUFULEVBQUFJLEVBQUE5SSxFQUFBLEVBQUFKLEVBQUFtSixFQUFBQyxHQUFBUixJQUNBSSxJQUNBRyxFQUFBRyxLQUFBQyxJQUFBSixFQUFBTCxHQUNBTSxHQUFBRCxFQUNBLE1BQUFMLEdBR0EsTUFBQUEsR0FHQSxPQURBVSxHQUFBLEtBQ0FwQyxFQUFBLEVBQW9CQSxFQUFBckIsRUFBQXBELE9BQXNCeUUsSUFBQSxDQUMxQyxHQUFBcUMsR0FBQXpKLEVBQUFrRSxXQUFBNkIsRUFBQXFCLEdBSUEsSUFIQW9DLEVBQUFGLEtBQUFJLElBQUFGLEVBQUFOLEVBQUE5SSxFQUFBLEVBQUFKLEVBQUFtSixFQUFBQyxHQUFBUixJQUNBYSxLQUNBTCxFQUFBRSxLQUFBSSxJQUFBTixFQUFBSSxLQUNBTCxFQUNBLE1BQUFLLEdBR0EsTUFBQUEsSUFJQUgsRUFBQSxTQUFBMUksR0FFQSxPQURBZ0osR0FBQSxFQUNBdEwsRUFBQSxFQUFpQkEsRUFBQSxFQUFPQSxJQUN4QixPQUFBd0MsR0FBQSxFQUFtQkEsRUFBQSxFQUFPQSxJQUUxQjhJLEdBQUFDLEVBQUFqSixFQUFBdEMsR0FBQXdDLEdBSUEsT0FBQThJLElBR0FDLEVBQUEsU0FBQW5JLEdBQ0EsVUFBQUEsRUFDQSxRQUlBLElBaUJBb0ksR0FqQkEsU0FBQXBJLEdBQ0EsZUFBQUEsRUFBQUMsS0FDQSxHQUNLLFNBQUFELEVBQUFDLEtBQ0wsR0FDSyxXQUFBRCxFQUFBQyxLQUNMLEdBQ0ssV0FBQUQsRUFBQUMsS0FDTCxHQUNLLFVBQUFELEVBQUFDLEtBQ0wsR0FDSyxTQUFBRCxFQUFBQyxLQUNMLFFBREssSUFNTEQsSUFBQUksTUFDQSxhQUFBSixFQUFBSSxNQUFBZ0ksS0FJQTFMLEdBQUFxRCxRQUFBa0gsR0FPQSxTQUFBdEssRUFBQUQsRUFBQUgsR0FFQSxZQXNCQSxTQUFBOEwsR0FBQXZJLEdBQXNDLE1BQUFBLE1BQUFuQyxXQUFBbUMsR0FBdUNDLFFBQUFELEdBbkI3RXpDLE9BQUFDLGVBQUFaLEVBQUEsY0FDQWdELE9BQUEsSUFFQWhELEVBQUFnQyxHQUFBaEMsRUFBQTRMLE9BQUE1TCxFQUFBcUMsU0FBQXdKLEVBRUEsSUFBQXhCLEdBQUF4SyxFQUFBLEdBRUF5SyxFQUFBcUIsRUFBQXRCLEdBRUFwSCxFQUFBcEQsRUFBQSxHQUVBK0wsRUFNQSxTQUFBeEksR0FBdUMsR0FBQUEsS0FBQW5DLFdBQTZCLE1BQUFtQyxFQUFxQixJQUFBMEksS0FBaUIsVUFBQTFJLEVBQW1CLE9BQUEySSxLQUFBM0ksR0FBdUJ6QyxPQUFBUyxVQUFBQyxlQUFBakIsS0FBQWdELEVBQUEySSxLQUFBRCxFQUFBQyxHQUFBM0ksRUFBQTJJLEdBQXNHLE9BQXRCRCxHQUFBekksUUFBQUQsRUFBc0IwSSxHQU4xUDdJLEdBRUFDLEVBQUFyRCxFQUFBLEdBRUFzRCxFQUFBd0ksRUFBQXpJLEVBT0FsRCxHQUFBcUMsS0FBQWlJLEVBQUFqSCxRQUNBckQsRUFBQTRMLFNBQ0E1TCxFQUFBZ0MsR0FBQW1CLEVBQUFFIiwiZmlsZSI6Indvcmtlci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGk6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bDogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuLyoqKioqKi8gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbi8qKioqKiovIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4vKioqKioqLyBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4vKioqKioqLyBcdFx0XHRcdGdldDogZ2V0dGVyXG4vKioqKioqLyBcdFx0XHR9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbi8qKioqKiovIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuLyoqKioqKi8gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbi8qKioqKiovIFx0XHRyZXR1cm4gZ2V0dGVyO1xuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBfcnNnQ2hlc3MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXG5zZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZSkge1xuICBpZiAoZS5kYXRhICYmIGUuZGF0YS5nYW1lICYmIGUuZGF0YS5wbGF5QWdhaW5zdEFJKSB7XG4gICAgdmFyIGJlc3RNb3ZlID0gKDAsIF9yc2dDaGVzcy5BSSkoZS5kYXRhLnBsYXlBZ2FpbnN0QUkuZGVwdGgsIGUuZGF0YS5nYW1lLCB0cnVlKTtcbiAgICBzZWxmLnBvc3RNZXNzYWdlKGJlc3RNb3ZlKTtcbiAgfVxufSk7IC8vIHNlbGYuaW1wb3J0U2NyaXB0cyhcImdhbWUuanNcIik7XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG4oZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0cnVlKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJyc2ctY2hlc3NcIiwgW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wicnNnLWNoZXNzXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcInJzZy1jaGVzc1wiXSA9IGZhY3RvcnkoKTtcbn0pKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGk6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bDogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuLyoqKioqKi8gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbi8qKioqKiovIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4vKioqKioqLyBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4vKioqKioqLyBcdFx0XHRcdGdldDogZ2V0dGVyXG4vKioqKioqLyBcdFx0XHR9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbi8qKioqKiovIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuLyoqKioqKi8gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbi8qKioqKiovIFx0XHRyZXR1cm4gZ2V0dGVyO1xuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMyk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfcGllY2VzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblxudmFyIF9BSSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cbnZhciBfQUkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQUkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBHYW1lKHByb21vQ2FsbGJhY2spIHtcbiAgLy8gdGhlIGdhbWUgYm9hcmRcbiAgdGhpcy5ib2FyZCA9IFtdO1xuICAvLyBmaWxsIHRoZSBib2FyZFxuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIHZhciBhcnJheUluID0gW107XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHtcbiAgICAgIGFycmF5SW4ucHVzaChudWxsKTtcbiAgICB9XG4gICAgdGhpcy5ib2FyZC5wdXNoKGFycmF5SW4pO1xuICB9XG5cbiAgLy8gdGhlIGhpc3Rvcnkgb2YgYWxsIHR1cm5zXG4gIHRoaXMudHVybiA9IFtdO1xuICAvLyB0aGUgY3VycmVudCBGRU4gc3RhdHVzXG4gIHRoaXMuRkVOID0gW107XG4gIC8vIHRoZSBjdXJyZW50IGdhbWUgY29uZmlndXJhdGlvbiBhcyBGRU5cbiAgdGhpcy5GRU5ib2FyZCA9IFtdO1xuICAvLyB0aGUgaGlzdG9yeSBvZiBhbGwgZ2FtZSBjb25maWd1cmF0aW9ucyBkaXNwbGF5ZWQgdXNpbmcgRkVOXG4gIHRoaXMudGhyZWVmb2xkID0gW107XG59XG5cbkdhbWUucHJvdG90eXBlLnBpZWNlID0gZnVuY3Rpb24gKHR5cGUsIHgsIHksIGNvbG9yKSB7XG4gIHZhciBwaWVjZSA9IF9waWVjZXMuUGllY2VbdHlwZV0oeCwgeSwgY29sb3IsIHRoaXMpO1xuICB0aGlzLmJvYXJkW3ldW3hdID0gcGllY2U7XG5cbiAgdGhpcy5GRU4gPSB0aGlzLmdhbWVUb0ZFTigpO1xuICB0aGlzLkZFTmJvYXJkID0gdGhpcy5ib2FyZFRvRkVOKCk7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5tb3ZlU2VsZWN0ZWQgPSBmdW5jdGlvbiAoc2VsZWN0ZWQsIHRvLCBwcm9tb3Rpb25DYWxsYmFjaywgY2hlY2ttYXRlQ2FsbGJhY2ssIHBsYXlBZ2FpbnN0QUksIHNpbXVsYXRlKSB7XG4gIHZhciB4ID0gdG8ueDtcbiAgdmFyIHkgPSB0by55O1xuXG4gIGlmIChzZWxlY3RlZCkge1xuICAgIHZhciBmcm9tID0geyB4OiBzZWxlY3RlZC54LCB5OiBzZWxlY3RlZC55IH07XG5cbiAgICBpZiAodGhpcy5ib2FyZFt5XVt4XSAhPT0gc2VsZWN0ZWQpIHtcbiAgICAgIHZhciB2YWxpZE1vdmVzID0gc2VsZWN0ZWQuZ2V0VmFsaWRNb3Zlcyghc2ltdWxhdGUpO1xuICAgICAgdmFyIHZhbGlkTW92ZSA9IG51bGw7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsaWRNb3Zlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgdm0gPSB2YWxpZE1vdmVzW2ldO1xuICAgICAgICBpZiAodm0ueCA9PT0geCAmJiB2bS55ID09PSB5KSB7XG4gICAgICAgICAgdmFsaWRNb3ZlID0gdm07XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCF2YWxpZE1vdmUpIHJldHVybiBmYWxzZTtcbiAgICAgIHZhciBtb3ZlUGllY2UgPSB2YWxpZE1vdmUubW92ZVBpZWNlO1xuICAgICAgdmFyIHRha2UsIHBhc3RlLCByb29rO1xuICAgICAgaWYgKG1vdmVQaWVjZSkge1xuICAgICAgICB0YWtlID0gbW92ZVBpZWNlLmZyb207XG4gICAgICAgIHBhc3RlID0gbW92ZVBpZWNlLnRvO1xuICAgICAgICBpZiAocGFzdGUgPT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLmJvYXJkW3Rha2UueV1bdGFrZS54XSA9IG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcm9vayA9IHRoaXMuYm9hcmRbdGFrZS55XVt0YWtlLnhdO1xuICAgICAgICAgIHRoaXMuYm9hcmRbcGFzdGUueV1bcGFzdGUueF0gPSByb29rO1xuICAgICAgICAgIHJvb2sueCA9IHBhc3RlLng7XG4gICAgICAgICAgcm9vay55ID0gcGFzdGUueTtcbiAgICAgICAgICB0aGlzLmJvYXJkW3Rha2UueV1bdGFrZS54XSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIHBpZWNlID0gdGhpcy5ib2FyZFt5XVt4XSA/IHRoaXMuYm9hcmRbeV1beF0gOiBudWxsO1xuICAgICAgbW92ZVBpZWNlID0gbW92ZVBpZWNlID8gdmFsaWRNb3ZlLm1vdmVQaWVjZSA6IG51bGw7XG4gICAgICB0aGlzLnR1cm4ucHVzaCh7XG4gICAgICAgIGZyb206IGZyb20sXG4gICAgICAgIHRvOiB0byxcbiAgICAgICAgY29sb3I6IHNlbGVjdGVkLmNvbG9yLFxuICAgICAgICB0eXBlOiBzZWxlY3RlZC50eXBlLFxuICAgICAgICBwaWVjZTogcGllY2UsXG4gICAgICAgIG1vdmVQaWVjZTogbW92ZVBpZWNlXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5ib2FyZFt5XVt4XSA9IHNlbGVjdGVkO1xuICAgICAgdGhpcy5ib2FyZFtzZWxlY3RlZC55XVtzZWxlY3RlZC54XSA9IG51bGw7XG4gICAgICB0aGlzLmJvYXJkW3ldW3hdLnggPSB4O1xuICAgICAgdGhpcy5ib2FyZFt5XVt4XS55ID0geTtcblxuICAgICAgdGhpcy5GRU4gPSB0aGlzLmdhbWVUb0ZFTigpO1xuICAgICAgdGhpcy5GRU5ib2FyZCA9IHRoaXMuYm9hcmRUb0ZFTigpO1xuICAgICAgLy8gY2hlY2sgZm9yIHRocmVlZm9sZCByZXBldGl0aW9uXG5cbiAgICAgIHRoaXMudGhyZWVmb2xkLnB1c2godGhpcy5GRU5ib2FyZCk7XG4gICAgICBpZiAoc2VsZWN0ZWQudHlwZSA9PT0gJ3Bhd24nIHx8IHBpZWNlKSB0aGlzLnRocmVlZm9sZCA9IFtdO1xuICAgICAgaWYgKHRoaXMudGhyZWVmb2xkQ2hlY2soKSkgY2hlY2ttYXRlQ2FsbGJhY2soJ0QnKTtcblxuICAgICAgLy8gY2hlY2sgZm9yIHRoZSBmaWZ0eS1tb3ZlIHJ1bGVcbiAgICAgIGlmICh0aGlzLmhhbGZtb3ZlQ2xvY2soKSA+PSA1MCkgY2hlY2ttYXRlQ2FsbGJhY2soJ0QnKTtcblxuICAgICAgLy8gY2hlY2sgZm9yIHBhd24gcHJvbW90aW9uXG4gICAgICBpZiAoc2VsZWN0ZWQudHlwZSA9PT0gJ3Bhd24nKSB7XG4gICAgICAgIGlmIChzZWxlY3RlZC5jb2xvciA9PT0gJ1cnICYmIHkgPT09IDAgfHwgc2VsZWN0ZWQuY29sb3IgPT09ICdCJyAmJiB5ID09PSA3KSB7XG4gICAgICAgICAgaWYgKHByb21vdGlvbkNhbGxiYWNrKSB7XG4gICAgICAgICAgICBpZiAocGxheUFnYWluc3RBSSAmJiAhcGxheUFnYWluc3RBSS5tb2RlICYmIHBsYXlBZ2FpbnN0QUkuY29taW5nQUkgJiYgc2VsZWN0ZWQuY29sb3IgPT09ICdCJykge1xuICAgICAgICAgICAgICBwbGF5QWdhaW5zdEFJLmN1c3RvbUFJUHJvbW90aW9uID8gcGxheUFnYWluc3RBSS5jdXN0b21BSVByb21vdGlvbigpIDogdGhpcy5wcm9tb3RlUGF3bihzZWxlY3RlZCwgeCwgeSwgc2VsZWN0ZWQuY29sb3IsICdxdWVlbicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcHJvbW90aW9uQ2FsbGJhY2soc2VsZWN0ZWQsIHgsIHksIHNlbGVjdGVkLmNvbG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHZhciBjaGVja21hdGVDb2xvciA9IHNlbGVjdGVkLmNvbG9yID09PSAnVycgPyAnQicgOiAnVyc7XG4gICAgICB2YXIgY2hlY2ttYXRlVmFsdWUgPSB0aGlzLmNoZWNrbWF0ZShjaGVja21hdGVDb2xvcik7XG4gICAgICBpZiAoY2hlY2ttYXRlVmFsdWUpIGNoZWNrbWF0ZUNhbGxiYWNrKGNoZWNrbWF0ZVZhbHVlKTtcblxuICAgICAgLy8gUGxheSBBSVxuICAgICAgaWYgKHBsYXlBZ2FpbnN0QUkgJiYgcGxheUFnYWluc3RBSS5tb2RlICYmIHBsYXlBZ2FpbnN0QUkubW92ZSkge1xuICAgICAgICBpZiAocGxheUFnYWluc3RBSS5jdXN0b21BSU1vdmVtZW50KSB7XG4gICAgICAgICAgcGxheUFnYWluc3RBSS5jdXN0b21BSU1vdmVtZW50KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIGJlc3RNb3ZlID0gKDAsIF9BSTIuZGVmYXVsdCkocGxheUFnYWluc3RBSS5kZXB0aCwgdGhpcywgZmFsc2UpO1xuICAgICAgICAgIHRoaXMubW92ZVNlbGVjdGVkKHRoaXMuYm9hcmRbYmVzdE1vdmUuZnJvbS55XVtiZXN0TW92ZS5mcm9tLnhdLCBiZXN0TW92ZS50bywgcHJvbW90aW9uQ2FsbGJhY2ssIGNoZWNrbWF0ZUNhbGxiYWNrLCBmYWxzZSwgdHJ1ZSwgc2ltdWxhdGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBlbmRcbiAgICB9XG4gICAgc2VsZWN0ZWQgPSBudWxsO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59O1xuXG5HYW1lLnByb3RvdHlwZS5wcm9tb3RlUGF3biA9IGZ1bmN0aW9uIChwYXduLCB4LCB5LCBjb2xvciwgdHlwZSkge1xuICB0aGlzLnBpZWNlKHR5cGUsIHgsIHksIGNvbG9yKTtcbn07XG5cbkdhbWUucHJvdG90eXBlLnNpbXVsYXRlQW5kRmlsdGVyID0gZnVuY3Rpb24gKG1vdmVzLCBwaWVjZSkge1xuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciBib2FyZCA9IHRoaXMuYm9hcmQ7XG5cbiAgbW92ZXMuZm9yRWFjaChmdW5jdGlvbiAobW92ZSwgaSkge1xuICAgIHZhciB5ID0gbW92ZS55O1xuICAgIHZhciB4ID0gbW92ZS54O1xuICAgIHZhciBmcm9tID0geyB4OiBwaWVjZS54LCB5OiBwaWVjZS55IH07XG4gICAgdmFyIG1vdmVQaWVjZSA9IGJvYXJkW3ldW3hdID8ge1xuICAgICAgcGllY2U6IGJvYXJkW3ldW3hdLFxuICAgICAgZnJvbTogeyB4OiB4LCB5OiB5IH0sXG4gICAgICB0bzogbnVsbFxuICAgIH0gOiBudWxsO1xuXG4gICAgaWYgKG1vdmUubW92ZVBpZWNlKSBtb3ZlUGllY2UgPSBtb3ZlLm1vdmVQaWVjZTtcbiAgICBpZiAobW92ZVBpZWNlKSBzZWxmLnNpbXBsZU1vdmVQaWVjZShtb3ZlUGllY2UucGllY2UsIG1vdmVQaWVjZS5mcm9tLCBtb3ZlUGllY2UudG8pO1xuXG4gICAgc2VsZi5zaW1wbGVNb3ZlUGllY2UocGllY2UsIGZyb20sIHsgeDogeCwgeTogeSB9KTtcbiAgICB2YXIgd2FybmluZyA9IHNlbGYud2FybmluZyhwaWVjZS5jb2xvcik7XG5cbiAgICAvLyBSZXR1cm4ga2luZ1xuICAgIHNlbGYuc2ltcGxlTW92ZVBpZWNlKHBpZWNlLCB7IHg6IHgsIHk6IHkgfSwgZnJvbSk7XG5cbiAgICAvLyByZXR1cm4gdGhlIG1vdmVQaWVjZSB3aXRoIHNpbXBsZU1vdmVQaWVjZSgpIG1ldGhvZFxuICAgIGlmIChtb3ZlUGllY2UpIHNlbGYuc2ltcGxlTW92ZVBpZWNlKG1vdmVQaWVjZS5waWVjZSwgbW92ZVBpZWNlLnRvLCBtb3ZlUGllY2UuZnJvbSk7XG5cbiAgICBpZiAoIXdhcm5pbmcpIHZhbGlkTW92ZXMucHVzaChtb3ZlKTtcbiAgfSk7XG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuR2FtZS5wcm90b3R5cGUuY2hlY2ttYXRlID0gZnVuY3Rpb24gKGNvbG9yKSB7XG4gIC8vIHVzaW5nIGxldCB3aWxsIGFsbG93IHVzIHRvIG1ha2UgdGhlIGNvZGUgYSBiaXQgc2ltcGxlclxuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICBpZiAodGhpcy5ib2FyZFtpXVtqXSAmJiB0aGlzLmJvYXJkW2ldW2pdLmNvbG9yID09PSBjb2xvciAmJiB0aGlzLmJvYXJkW2ldW2pdLmdldFZhbGlkTW92ZXModHJ1ZSkubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIGlmICh0aGlzLndhcm5pbmcoY29sb3IpKSByZXR1cm4gY29sb3I7XG4gIHJldHVybiAnRCc7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5zaW1wbGVNb3ZlUGllY2UgPSBmdW5jdGlvbiAocGllY2UsIGZyb20sIHRvKSB7XG4gIHZhciBib2FyZCA9IHRoaXMuYm9hcmQ7XG4gIGlmICh0bykge1xuICAgIGJvYXJkW3RvLnldW3RvLnhdID0gcGllY2U7XG4gICAgcGllY2UueCA9IHRvLng7XG4gICAgcGllY2UueSA9IHRvLnk7XG4gIH1cbiAgaWYgKGZyb20pIGJvYXJkW2Zyb20ueV1bZnJvbS54XSA9IG51bGw7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5zaW1wbGVNb3ZlID0gZnVuY3Rpb24gKG1vdmUpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgYm9hcmQgPSBzZWxmLmJvYXJkO1xuICB2YXIgZnJvbSA9IG1vdmUuZnJvbTtcbiAgdmFyIHRvID0gbW92ZS50bztcbiAgdmFyIHBpZWNlID0gYm9hcmRbZnJvbS55XVtmcm9tLnhdO1xuICB2YXIgY2FwdHVyZWRQaWVjZSA9IHRoaXMuYm9hcmRbdG8ueV1bdG8ueF0gPyB0aGlzLmJvYXJkW3RvLnldW3RvLnhdIDogbnVsbDtcbiAgdmFyIG1vdmVQaWVjZSA9IGJvYXJkW3RvLnldW3RvLnhdID8ge1xuICAgIHBpZWNlOiBib2FyZFt0by55XVt0by54XSxcbiAgICBmcm9tOiB7IHg6IHRvLngsIHk6IHRvLnkgfSxcbiAgICB0bzogbnVsbFxuICB9IDogbnVsbDtcblxuICB0aGlzLnR1cm4ucHVzaCh7XG4gICAgZnJvbTogZnJvbSxcbiAgICB0bzogeyB4OiB0by54LCB5OiB0by55IH0sXG4gICAgY29sb3I6IG1vdmUuY29sb3IsXG4gICAgdHlwZTogcGllY2UudHlwZSxcbiAgICBwaWVjZTogY2FwdHVyZWRQaWVjZSxcbiAgICBtb3ZlUGllY2U6IG1vdmVQaWVjZVxuICB9KTtcblxuICBpZiAodG8ubW92ZVBpZWNlKSBtb3ZlUGllY2UgPSB0by5tb3ZlUGllY2U7XG4gIGlmIChtb3ZlUGllY2UpIHNlbGYuc2ltcGxlTW92ZVBpZWNlKG1vdmVQaWVjZS5waWVjZSwgbW92ZVBpZWNlLmZyb20sIG1vdmVQaWVjZS50byk7XG4gIHNlbGYuc2ltcGxlTW92ZVBpZWNlKHBpZWNlLCBmcm9tLCB7IHg6IHRvLngsIHk6IHRvLnkgfSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAvLyByZXR1cm4gdGhlIGN1cnJlbnQgbW92ZSAvZXYvXG4gICAgaWYgKG1vdmVQaWVjZSkgc2VsZi5zaW1wbGVNb3ZlUGllY2UobW92ZVBpZWNlLnBpZWNlLCBtb3ZlUGllY2UudG8sIG1vdmVQaWVjZS5mcm9tKTtcbiAgICBzZWxmLnNpbXBsZU1vdmVQaWVjZShwaWVjZSwgeyB4OiB0by54LCB5OiB0by55IH0sIGZyb20pO1xuICAgIGlmIChjYXB0dXJlZFBpZWNlKSBib2FyZFt0by55XVt0by54XSA9IGNhcHR1cmVkUGllY2U7XG4gICAgc2VsZi50dXJuLnBvcCgpO1xuICB9O1xufTtcblxuR2FtZS5wcm90b3R5cGUud2FybmluZyA9IGZ1bmN0aW9uIChjb2xvcikge1xuICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gIHZhciBraW5nO1xuXG4gIHRoaXMuYm9hcmQuZm9yRWFjaChmdW5jdGlvbiAoeXl5KSB7XG4gICAgeXl5LmZvckVhY2goZnVuY3Rpb24gKHh4eCkge1xuICAgICAgaWYgKHh4eCAmJiB4eHguY29sb3IgPT09IGNvbG9yICYmIHh4eC50eXBlID09PSAna2luZycpIHtcbiAgICAgICAga2luZyA9IHh4eDtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgdGhpcy5ib2FyZC5mb3JFYWNoKGZ1bmN0aW9uICh5eXkpIHtcbiAgICB5eXkuZm9yRWFjaChmdW5jdGlvbiAoeHh4KSB7XG4gICAgICBpZiAoeHh4ICYmIHh4eC5jb2xvciAhPT0gY29sb3IpIHtcbiAgICAgICAgeHh4LmdldFZhbGlkTW92ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChtbW0pIHtcbiAgICAgICAgICBpZiAobW1tLnggPT09IGtpbmcueCAmJiBtbW0ueSA9PT0ga2luZy55KSByZXN1bHQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5HYW1lLnByb3RvdHlwZS50aHJlZWZvbGRDaGVjayA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRocmVlZm9sZCA9IHRoaXMudGhyZWVmb2xkO1xuICB2YXIgbGVuZ3RoID0gdGhyZWVmb2xkLmxlbmd0aDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgLy8gdXNpbmcgbGV0IHdpbGwgYWxsb3cgdXMgdG8gbWFrZSB0aGUgY29kZSBzaW1wbGVyXG4gICAgdmFyIGNvdW50ID0gMDtcbiAgICBmb3IgKHZhciBqID0gaSArIDE7IGogPCBsZW5ndGg7IGorKykge1xuICAgICAgaWYgKHRocmVlZm9sZFtpXSA9PT0gdGhyZWVmb2xkW2pdKSBjb3VudCArPSAxO1xuICAgIH1cbiAgICBpZiAoY291bnQgPj0gMikgcmV0dXJuIHRydWU7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5waWVjZVRvQU4gPSBmdW5jdGlvbiAoeCwgeSkge1xuICB2YXIgeENoYXJzID0gJ2FiY2RlZmdoJztcbiAgcmV0dXJuIHhDaGFycy5jaGFyQXQoeCkgKyAoOCAtIHkpO1xufTtcblxuLy8gU3VwcG9ydCBGRU4gZnVuY3Rpb25zIGluIHRoZSBBUElcbkdhbWUucHJvdG90eXBlLmJvYXJkVG9GRU4gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBib2FyZCA9IHRoaXMuYm9hcmQ7XG5cbiAgLy8gQ29udmVydCB0aGUgYm9hcmQgY29uZmlndXJhdGlvbiBpbnRvIEZFTlxuICB2YXIgRkVOYm9hcmQgPSAnJztcbiAgdmFyIG1pc3NpbmdQaWVjZXMgPSAwO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICBpZiAoYm9hcmRbaV1bal0pIHtcbiAgICAgICAgaWYgKG1pc3NpbmdQaWVjZXMpIEZFTmJvYXJkICs9IG1pc3NpbmdQaWVjZXM7XG4gICAgICAgIG1pc3NpbmdQaWVjZXMgPSAwO1xuICAgICAgICBGRU5ib2FyZCArPSBib2FyZFtpXVtqXS5GRU5uYW1lO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWlzc2luZ1BpZWNlcysrO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAobWlzc2luZ1BpZWNlcykgRkVOYm9hcmQgKz0gbWlzc2luZ1BpZWNlcztcbiAgICBtaXNzaW5nUGllY2VzID0gMDtcbiAgICBGRU5ib2FyZCArPSBpIDwgNyA/ICcvJyA6ICcnO1xuICB9XG5cbiAgcmV0dXJuIEZFTmJvYXJkO1xufTtcblxuR2FtZS5wcm90b3R5cGUuaGFsZm1vdmVDbG9jayA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHR1cm4gPSB0aGlzLnR1cm47XG4gIHZhciBsZW5ndGggPSB0dXJuLmxlbmd0aDtcbiAgdmFyIGNvdW50ID0gMDtcbiAgaWYgKHR1cm4ubGVuZ3RoID09PSAwKSByZXR1cm4gY291bnQ7XG5cbiAgdmFyIGV2ID0gdHVybltsZW5ndGggLSAxIC0gY291bnRdO1xuICB3aGlsZSAoY291bnQgPD0gbGVuZ3RoIC0gMSAmJiBldi50eXBlICE9PSAncGF3bicgJiYgIWV2LnBpZWNlKSB7XG4gICAgY291bnQrKztcbiAgICBldiA9IHR1cm5bbGVuZ3RoIC0gMSAtIGNvdW50XTtcbiAgfVxuXG4gIHJldHVybiBjb3VudDtcbn07XG5cbkdhbWUucHJvdG90eXBlLmFjdGl2ZUNvbG91ciA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHR1cm4gPSB0aGlzLnR1cm47XG4gIHZhciBhY3RpdmVDb2xvciA9IHR1cm4ubGVuZ3RoICYmIHR1cm5bdHVybi5sZW5ndGggLSAxXS5jb2xvciA9PT0gJ1cnID8gJ2InIDogJ3cnO1xuXG4gIHJldHVybiBhY3RpdmVDb2xvcjtcbn07XG5cbkdhbWUucHJvdG90eXBlLmNhc3RsaW5nVGFyZ2V0ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuICB2YXIgdHVybiA9IHRoaXMudHVybjtcbiAgdmFyIHBvc3NpYmxlQ2FzdGxpbmcgPSAnJztcblxuICB2YXIgd2hpdGVLaW5nTW92ZWQ7XG4gIHZhciBibGFja0tpbmdNb3ZlZDtcbiAgdHVybi5mb3JFYWNoKGZ1bmN0aW9uICh0dXJuKSB7XG4gICAgd2hpdGVLaW5nTW92ZWQgPSB0dXJuLnR5cGUgPT09ICdraW5nJyAmJiB0dXJuLmNvbG9yID09PSAnVyc7XG4gICAgYmxhY2tLaW5nTW92ZWQgPSB0dXJuLnR5cGUgPT09ICdraW5nJyAmJiB0dXJuLmNvbG9yID09PSAnQic7XG4gIH0pO1xuXG4gIFtbNywgMF0sIFswLCAwXSwgWzcsIDddLCBbMCwgN11dLmZvckVhY2goZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgdmFyIHJvb2tYID0gcHJvcHNbMF07XG4gICAgdmFyIHJvb2tZID0gcHJvcHNbMV07XG4gICAgdmFyIHJvb2sgPSBib2FyZFtyb29rWV1bcm9va1hdO1xuXG4gICAgaWYgKHJvb2tZID09PSA3ICYmIHdoaXRlS2luZ01vdmVkKSByZXR1cm47XG4gICAgaWYgKHJvb2tZID09PSAwICYmIGJsYWNrS2luZ01vdmVkKSByZXR1cm47XG5cbiAgICAvLyBDaGVjayByb29rIG9uIHBvc2l0aW9uXG4gICAgaWYgKCFyb29rIHx8ICFyb29rLnR5cGUgPT09ICdyb29rJykgcmV0dXJuO1xuXG4gICAgLy8gQ2hlY2sgcm9vayBoYXNuJ3QgbW92ZWRcbiAgICBpZiAodHVybi5zb21lKGZ1bmN0aW9uIChldikge1xuICAgICAgaWYgKGV2LnR5cGUgIT09ICdyb29rJykgcmV0dXJuIGZhbHNlO1xuICAgICAgcmV0dXJuIGV2LmZyb20ueCA9PT0gcm9va1ggJiYgZXYuZnJvbS55ID09PSByb29rWTtcbiAgICB9KSkgcmV0dXJuO1xuXG4gICAgdmFyIGNhc3RsaW5nU2lkZSA9IHJvb2tYID09PSAwID8gJ3EnIDogJ2snO1xuICAgIHBvc3NpYmxlQ2FzdGxpbmcgKz0gcm9va1kgPT09IDAgPyBjYXN0bGluZ1NpZGUudG9VcHBlckNhc2UoKSA6IGNhc3RsaW5nU2lkZTtcbiAgfSk7XG5cbiAgaWYgKCFwb3NzaWJsZUNhc3RsaW5nKSBwb3NzaWJsZUNhc3RsaW5nID0gJy0nO1xuICByZXR1cm4gcG9zc2libGVDYXN0bGluZztcbn07XG5cbkdhbWUucHJvdG90eXBlLmVuUGFzc2FudFRhcmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHR1cm4gPSB0aGlzLnR1cm47XG4gIHZhciBlblBhc3NhbnRUYXJnZXQgPSAnJztcblxuICBpZiAodHVybi5sZW5ndGgpIHtcbiAgICB2YXIgZXYgPSB0dXJuW3R1cm4ubGVuZ3RoIC0gMV07XG4gICAgaWYgKGV2LmNvbG9yID09PSAnVycgJiYgZXYudG8ueSA9PT0gNCkge1xuICAgICAgZW5QYXNzYW50VGFyZ2V0ID0gdGhpcy5waWVjZVRvQU4oZXYudG8ueCwgZXYudG8ueSArIDEpO1xuICAgIH1cblxuICAgIGlmIChldi5jb2xvciA9PT0gJ0InICYmIGV2LnRvLnkgPT09IDMpIHtcbiAgICAgIGVuUGFzc2FudFRhcmdldCA9IHRoaXMucGllY2VUb0FOKGV2LnRvLngsIGV2LnRvLnkgLSAxKTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWVuUGFzc2FudFRhcmdldCkgZW5QYXNzYW50VGFyZ2V0ID0gJy0nO1xuICByZXR1cm4gZW5QYXNzYW50VGFyZ2V0O1xufTtcblxuR2FtZS5wcm90b3R5cGUuZnVsbG1vdmVDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNvdW50ID0gMTtcbiAgdGhpcy50dXJuLmZvckVhY2goZnVuY3Rpb24gKGV2KSB7XG4gICAgaWYgKGV2LmNvbG9yID09PSAnQicpIGNvdW50ICs9IDE7XG4gIH0pO1xuXG4gIHJldHVybiBjb3VudDtcbn07XG5cbkdhbWUucHJvdG90eXBlLmdhbWVUb0ZFTiA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIEZFTiA9ICcnO1xuXG4gIC8vIENoZWNrIHRoZSBib2FyZCBjb25maWd1cmF0aW9uXG4gIEZFTiArPSB0aGlzLmJvYXJkVG9GRU4oKTtcblxuICAvLyBGaW5kIHRoZSBhY3RpdmUgY29sb3VyXG4gIEZFTiArPSAnICcgKyB0aGlzLmFjdGl2ZUNvbG91cigpO1xuXG4gIC8vIENoZWNrIGNhc3RsaW5nIGF2YWlsYWJpbGl0eVxuICBGRU4gKz0gJyAnICsgdGhpcy5jYXN0bGluZ1RhcmdldCgpO1xuXG4gIC8vIENoZWNrIHRoZSBFbi1wYXNzYW50IHRhcmdldFxuICBGRU4gKz0gJyAnICsgdGhpcy5lblBhc3NhbnRUYXJnZXQoKTtcblxuICAvLyBBZGQgdGhlIGhhbGZtb3ZlIGNsb2NrXG4gIEZFTiArPSAnICcgKyB0aGlzLmhhbGZtb3ZlQ2xvY2soKTtcblxuICAvLyBBZGQgdGhlIGZ1bGxtb3ZlIG51bWJlclxuICBGRU4gKz0gJyAnICsgdGhpcy5mdWxsbW92ZUNvdW50KCk7XG5cbiAgLypcclxuICAgIE1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIEZFTiBub3RhdGlvbjpcclxuICAgIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0ZvcnN5dGglRTIlODAlOTNFZHdhcmRzX05vdGF0aW9uXHJcbiAgICBodHRwczovL2NoZXNzcHJvZ3JhbW1pbmcud2lraXNwYWNlcy5jb20vRm9yc3l0aC1FZHdhcmRzK05vdGF0aW9uXHJcbiAgKi9cblxuICByZXR1cm4gRkVOO1xufTtcblxuLy8gU2V0IHVwIGRlZmF1bHQgZ2FtZSBjb25maWd1cmF0aW9uXG5HYW1lLnByb3RvdHlwZS5pbml0aWFsaXplR2FtZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGRlZmF1bHRHYW1lID0gbmV3IEdhbWUoKTtcblxuICAvLyBQYXduczpcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBkZWZhdWx0R2FtZS5waWVjZSgncGF3bicsIGksIDYsICdXJyk7XG4gICAgZGVmYXVsdEdhbWUucGllY2UoJ3Bhd24nLCBpLCAxLCAnQicpO1xuICB9XG5cbiAgLy8gQmxhY2sgZmlnczpcbiAgZGVmYXVsdEdhbWUucGllY2UoJ3Jvb2snLCAwLCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna25pZ2h0JywgMSwgMCwgJ0InKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2Jpc2hvcCcsIDIsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdxdWVlbicsIDMsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdraW5nJywgNCwgMCwgJ0InKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2Jpc2hvcCcsIDUsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdrbmlnaHQnLCA2LCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgncm9vaycsIDcsIDAsICdCJyk7XG5cbiAgLy8gV2hpdGUgZmlnczpcbiAgZGVmYXVsdEdhbWUucGllY2UoJ3Jvb2snLCAwLCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna25pZ2h0JywgMSwgNywgJ1cnKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2Jpc2hvcCcsIDIsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdxdWVlbicsIDMsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdraW5nJywgNCwgNywgJ1cnKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2Jpc2hvcCcsIDUsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdrbmlnaHQnLCA2LCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgncm9vaycsIDcsIDcsICdXJyk7XG5cbiAgcmV0dXJuIGRlZmF1bHRHYW1lO1xufTtcblxuR2FtZS5wcm90b3R5cGUuYWxsTW92ZXMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBib2FyZCA9IHRoaXMuYm9hcmQ7XG4gIHZhciBhbGxNb3ZlcyA9IFtdO1xuICB2YXIgYWN0aXZlQ29sb3VyID0gdGhpcy5hY3RpdmVDb2xvdXIoKS50b1VwcGVyQ2FzZSgpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHtcbiAgICAgIGlmIChib2FyZFtpXVtqXSAmJiBib2FyZFtpXVtqXS5jb2xvciA9PT0gYWN0aXZlQ29sb3VyKSB7XG4gICAgICAgIHZhciB2YWxpZE1vdmVzID0gYm9hcmRbaV1bal0uZ2V0VmFsaWRNb3Zlcyh0cnVlKTtcbiAgICAgICAgdmFsaWRNb3Zlcy5mb3JFYWNoKGZ1bmN0aW9uIChldikge1xuICAgICAgICAgIGFsbE1vdmVzLnB1c2goe1xuICAgICAgICAgICAgY29sb3I6IGJvYXJkW2ldW2pdLmNvbG9yLFxuICAgICAgICAgICAgZnJvbTogeyB4OiBqLCB5OiBpIH0sXG4gICAgICAgICAgICB0bzogZXYsXG4gICAgICAgICAgICBGRU5uYW1lOiBib2FyZFtpXVtqXS5GRU5uYW1lXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBhbGxNb3Zlcztcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEdhbWU7XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLy9cbi8vIFJTRyBDaGVzc1xuLy8gTGljZW5zZWQgdW5kZXIgQXBhY2hlIDIuMCBMSUNFTlNFXG5cbnZhciBQSUVDRV9DSEFSUyA9IGV4cG9ydHMuUElFQ0VfQ0hBUlMgPSB7XG4gIHBhd246IHsgVzogJ+KZmScsIEI6ICfimZ8nIH0sXG4gIHJvb2s6IHsgVzogJ+KZlicsIEI6ICfimZwnIH0sXG4gIGtuaWdodDogeyBXOiAn4pmYJywgQjogJ+KZnicgfSxcbiAgYmlzaG9wOiB7IFc6ICfimZcnLCBCOiAn4pmdJyB9LFxuICBxdWVlbjogeyBXOiAn4pmVJywgQjogJ+KZmycgfSxcbiAga2luZzogeyBXOiAn4pmUJywgQjogJ+KZmicgfVxufTtcblxuZnVuY3Rpb24gUGllY2UoeCwgeSwgY2hhckJhc2UsIGNvbG9yLCBnYW1lLCB0eXBlKSB7XG4gIGlmIChjaGFyQmFzZSkgdGhpcy5jaGFyID0gY2hhckJhc2VbY29sb3JdO1xuICB0aGlzLmNvbG9yID0gY29sb3I7XG4gIHRoaXMueCA9IHg7XG4gIHRoaXMueSA9IHk7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG4gIHRoaXMudHlwZSA9IHR5cGU7XG4gIGlmICh0eXBlKSB7XG4gICAgdmFyIEZFTm5hbWUgPSB0eXBlID09PSAna25pZ2h0JyA/ICduJyA6IHR5cGUuY2hhckF0KDApO1xuICAgIGlmICh0aGlzLmNvbG9yID09PSAnVycpIEZFTm5hbWUgPSBGRU5uYW1lLnRvVXBwZXJDYXNlKCk7XG4gICAgdGhpcy5GRU5uYW1lID0gRkVObmFtZTtcbiAgfVxufVxuXG5QaWVjZS5lbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIG5ldyBQaWVjZSgpO1xufTtcblxuUGllY2UucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBbeyB4OiAwLCB5OiAwIH0sIHsgeDogNywgeTogNyB9XTtcbn07XG5cbmZ1bmN0aW9uIFBhd24oeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5wYXduLCBjb2xvciwgZ2FtZSwgJ3Bhd24nKTtcbn1cblxuUGF3bi5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuUGF3bi5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIG1vdmVzID0gW107XG4gIC8qIGVzbGludC1kaXNhYmxlICovXG4gIHZhciB5ID0gdGhpcy55LFxuICAgICAgeCA9IHRoaXMueDtcbiAgdmFyIGJvYXJkID0gZ2FtZS5ib2FyZCxcbiAgICAgIHR1cm4gPSBnYW1lLnR1cm4sXG4gICAgICBsZW5ndGggPSB0dXJuLmxlbmd0aDtcbiAgdmFyIGxhc3QsIHR1cm5UbywgdHVybkZyb20sIGZpZ1gsIHBhc3NhbnRMYXN0LCBwYXNzYW50RmlnO1xuICB2YXIgY29sb3JZID0gdGhpcy5jb2xvciA9PT0gJ1cnID8geSAtIDEgOiB5ICsgMTtcbiAgdmFyIGNvbG9yWTIgPSB0aGlzLmNvbG9yID09PSAnVycgPyB5IC0gMiA6IHkgKyAyO1xuICB2YXIgcGFzc2FudFkyID0gdGhpcy5jb2xvciA9PT0gJ1cnID8gMyA6IDQ7XG4gIHZhciBmaWdYQXJyYXkgPSBbeCAtIDEsIHggKyAxXTtcbiAgLyogZXNsaW50LWVuYWJsZSAqL1xuXG4gIGlmIChjb2xvclkgPCA4ICYmIGNvbG9yWSA+PSAwICYmICFib2FyZFtjb2xvclldW3hdKSB7XG4gICAgbW92ZXMucHVzaCh7IHg6IHgsIHk6IGNvbG9yWSB9KTtcbiAgICBpZiAoKHkgPT09IDEgfHwgeSA9PT0gNikgJiYgY29sb3JZMiA8IDggJiYgY29sb3JZMiA+PSAwICYmICFnYW1lLmJvYXJkW2NvbG9yWTJdW3hdKSB7XG4gICAgICBtb3Zlcy5wdXNoKHsgeDogeCwgeTogY29sb3JZMiB9KTtcbiAgICB9XG4gIH1cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IDI7IGkrKykge1xuICAgIGZpZ1ggPSBmaWdYQXJyYXlbaV07XG4gICAgaWYgKGNvbG9yWSA8IDggJiYgY29sb3JZID49IDAgJiYgYm9hcmRbY29sb3JZXVtmaWdYXSAmJiBib2FyZFtjb2xvclldW2ZpZ1hdLmNvbG9yICE9PSB0aGlzLmNvbG9yKSBtb3Zlcy5wdXNoKHsgeDogZmlnWCwgeTogY29sb3JZIH0pO1xuICB9XG5cbiAgLy8gQ2hlY2sgZm9yIGVuLXBhc3NhbnRcbiAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IDI7IF9pKyspIHtcbiAgICBmaWdYID0gZmlnWEFycmF5W19pXTtcbiAgICBsYXN0ID0gdHVybltsZW5ndGggLSAxXTtcblxuICAgIGlmIChsYXN0ICYmIGxhc3QudHlwZSA9PT0gJ3Bhd24nICYmIGxhc3QudG8ueCA9PT0gZmlnWCAmJiBsYXN0LnRvLnkgPT09IHkgJiYgbGFzdC5jb2xvciAhPT0gdGhpcy5jb2xvciAmJiAobGFzdC5mcm9tLnkgPT09IDEgfHwgbGFzdC5mcm9tLnkgPT09IDYpICYmICh5ID09PSAzIHx8IHkgPT09IDQpKSB7XG4gICAgICBtb3Zlcy5wdXNoKHtcbiAgICAgICAgeDogZmlnWCxcbiAgICAgICAgeTogY29sb3JZLFxuICAgICAgICBtb3ZlUGllY2U6IHtcbiAgICAgICAgICBwaWVjZTogZ2FtZS5ib2FyZFt5XVtmaWdYXSxcbiAgICAgICAgICBmcm9tOiB7XG4gICAgICAgICAgICB4OiBmaWdYLFxuICAgICAgICAgICAgeTogeVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdG86IG51bGxcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2UucGF3biA9IGZ1bmN0aW9uICh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICByZXR1cm4gbmV3IFBhd24oeCwgeSwgY29sb3IsIGdhbWUpO1xufTtcblxuLy8gLy9cblxuZnVuY3Rpb24gUm9vayh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICBQaWVjZS5jYWxsKHRoaXMsIHgsIHksIFBJRUNFX0NIQVJTLnJvb2ssIGNvbG9yLCBnYW1lLCAncm9vaycpO1xufVxuXG5Sb29rLnByb3RvdHlwZSA9IFBpZWNlLmVtcHR5KCk7XG5Sb29rLnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzID0gZnVuY3Rpb24gKHNpbXVsYXRlKSB7XG4gIHZhciBnYW1lID0gdGhpcy5nYW1lO1xuICB2YXIgbW92ZXMgPSBbXTtcblxuICBbWy0xLCAwXSwgWzEsIDBdLCBbMCwgMV0sIFswLCAtMV1dLmZvckVhY2goZnVuY3Rpb24gKGNvZWYpIHtcbiAgICB2YXIgaW5kZXgsIHgsIHksIHBpZWNlO1xuICAgIGZvciAoaW5kZXggPSAxOzsgaW5kZXgrKykge1xuICAgICAgeCA9IHRoaXMueCArIGNvZWZbMF0gKiBpbmRleDtcbiAgICAgIHkgPSB0aGlzLnkgKyBjb2VmWzFdICogaW5kZXg7XG4gICAgICBpZiAoeSA8IDAgfHwgeSA+IDcgfHwgeCA8IDAgfHwgeCA+IDcpIGJyZWFrO1xuXG4gICAgICBwaWVjZSA9IGdhbWUuYm9hcmRbeV1beF07XG4gICAgICBpZiAocGllY2UgJiYgcGllY2UuY29sb3IgPT09IHRoaXMuY29sb3IpIGJyZWFrO1xuXG4gICAgICBtb3Zlcy5wdXNoKHsgeDogeCwgeTogeSB9KTtcbiAgICAgIGlmIChwaWVjZSkgYnJlYWs7XG4gICAgfVxuICB9LCB0aGlzKTtcblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3ZlcywgdGhpcyk7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5yb29rID0gZnVuY3Rpb24gKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIHJldHVybiBuZXcgUm9vayh4LCB5LCBjb2xvciwgZ2FtZSk7XG59O1xuXG4vLyAvL1xuXG5mdW5jdGlvbiBLbmlnaHQoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5rbmlnaHQsIGNvbG9yLCBnYW1lLCAna25pZ2h0Jyk7XG59XG5cbktuaWdodC5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuS25pZ2h0LnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzID0gZnVuY3Rpb24gKHNpbXVsYXRlKSB7XG4gIHZhciBnYW1lID0gdGhpcy5nYW1lO1xuICB2YXIgbW92ZXMgPSBbXTtcblxuICB2YXIgY29vcmRpbmF0ZXMgPSBbWzIsIDFdLCBbLTIsIDFdLCBbMSwgMl0sIFstMSwgMl0sIFsyLCAtMV0sIFstMiwgLTFdLCBbMSwgLTJdLCBbLTEsIC0yXV07XG5cbiAgdmFyIG9uZSwgdHdvO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb3JkaW5hdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGhlbHAgPSBmYWxzZTtcbiAgICB2YXIgYm9hcmRQaWVjZTtcbiAgICBvbmUgPSBjb29yZGluYXRlc1tpXVswXTtcbiAgICB0d28gPSBjb29yZGluYXRlc1tpXVsxXTtcblxuICAgIGlmICh0aGlzLnggKyBvbmUgPCA4ICYmIHRoaXMueCArIG9uZSA+PSAwICYmIHRoaXMueSArIHR3byA8IDggJiYgdGhpcy55ICsgdHdvID49IDApIHtcbiAgICAgIGJvYXJkUGllY2UgPSBnYW1lLmJvYXJkW3RoaXMueSArIHR3b11bdGhpcy54ICsgb25lXTtcbiAgICAgIGhlbHAgPSBib2FyZFBpZWNlID8gYm9hcmRQaWVjZS5jb2xvciAhPT0gdGhpcy5jb2xvciA6IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGhlbHApIHtcbiAgICAgIG1vdmVzLnB1c2goeyB4OiB0aGlzLnggKyBvbmUsIHk6IHRoaXMueSArIHR3byB9KTtcbiAgICB9XG4gIH1cblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3ZlcywgdGhpcyk7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5rbmlnaHQgPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBLbmlnaHQoeCwgeSwgY29sb3IsIGdhbWUpO1xufTtcblxuLy8gLy9cblxuZnVuY3Rpb24gQmlzaG9wKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMuYmlzaG9wLCBjb2xvciwgZ2FtZSwgJ2Jpc2hvcCcpO1xufVxuXG5CaXNob3AucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcbkJpc2hvcC5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIG1vdmVzID0gW107XG5cbiAgW1stMSwgLTFdLCBbMSwgMV0sIFstMSwgMV0sIFsxLCAtMV1dLmZvckVhY2goZnVuY3Rpb24gKGNvZWYpIHtcbiAgICB2YXIgaW5kZXgsIHgsIHksIHBpZWNlO1xuICAgIGZvciAoaW5kZXggPSAxOzsgaW5kZXgrKykge1xuICAgICAgeCA9IHRoaXMueCArIGNvZWZbMF0gKiBpbmRleDtcbiAgICAgIHkgPSB0aGlzLnkgKyBjb2VmWzFdICogaW5kZXg7XG4gICAgICBpZiAoeSA8IDAgfHwgeSA+IDcgfHwgeCA8IDAgfHwgeCA+IDcpIGJyZWFrO1xuXG4gICAgICBwaWVjZSA9IGdhbWUuYm9hcmRbeV1beF07XG4gICAgICBpZiAocGllY2UgJiYgcGllY2UuY29sb3IgPT09IHRoaXMuY29sb3IpIGJyZWFrO1xuXG4gICAgICBtb3Zlcy5wdXNoKHsgeDogeCwgeTogeSB9KTtcbiAgICAgIGlmIChwaWVjZSkgYnJlYWs7XG4gICAgfVxuICB9LCB0aGlzKTtcblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3ZlcywgdGhpcyk7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5iaXNob3AgPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBCaXNob3AoeCwgeSwgY29sb3IsIGdhbWUpO1xufTtcblxuLy8gLy9cblxuZnVuY3Rpb24gUXVlZW4oeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5xdWVlbiwgY29sb3IsIGdhbWUsICdxdWVlbicpO1xufVxuXG5RdWVlbi5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuUXVlZW4ucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoc2ltdWxhdGUpIHtcbiAgdmFyIGdhbWUgPSB0aGlzLmdhbWU7XG4gIHZhciByb29rTW92ZXMgPSBSb29rLnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzLmNhbGwodGhpcyk7XG4gIHZhciBiaXNob3BNb3ZlcyA9IEJpc2hvcC5wcm90b3R5cGUuZ2V0VmFsaWRNb3Zlcy5jYWxsKHRoaXMpO1xuICB2YXIgbW92ZXMgPSByb29rTW92ZXMuY29uY2F0KGJpc2hvcE1vdmVzKTtcblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3ZlcywgdGhpcyk7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5xdWVlbiA9IGZ1bmN0aW9uICh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICByZXR1cm4gbmV3IFF1ZWVuKHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbi8vIC8vXG5cbmZ1bmN0aW9uIEtpbmcoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5raW5nLCBjb2xvciwgZ2FtZSwgJ2tpbmcnKTtcbn1cblxuS2luZy5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuS2luZy5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgbW92ZXMgPSBbXTtcbiAgdmFyIGNvb3JkaW5hdGVzID0gW1swLCAxXSwgWzAsIC0xXSwgWzEsIDFdLCBbLTEsIC0xXSwgWzEsIC0xXSwgWy0xLCAxXSwgWy0xLCAwXSwgWzEsIDBdXTtcbiAgdmFyIHggPSB0aGlzLng7XG4gIHZhciB5ID0gdGhpcy55O1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIHR1cm4gPSBnYW1lLnR1cm47XG4gIHZhciBzZWxmID0gdGhpcztcblxuICBjb29yZGluYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChjb29yZCkge1xuICAgIHZhciBwaWVjZTtcbiAgICB2YXIgeHggPSB4ICsgY29vcmRbMF07XG4gICAgdmFyIHl5ID0geSArIGNvb3JkWzFdO1xuXG4gICAgaWYgKHh4IDwgOCAmJiB4eCA+PSAwICYmIHl5IDwgOCAmJiB5eSA+PSAwKSB7XG4gICAgICBwaWVjZSA9IGdhbWUuYm9hcmRbeXldW3h4XTtcbiAgICAgIGlmICghcGllY2UgfHwgcGllY2UuY29sb3IgIT09IHNlbGYuY29sb3IpIHtcbiAgICAgICAgbW92ZXMucHVzaCh7IHg6IHh4LCB5OiB5eSB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8vIENoZWNrIGtpbmcgaGFzbid0IG1vdmVkXG4gIHZhciBraW5nTW92ZWQgPSB0dXJuLnNvbWUoZnVuY3Rpb24gKHR1cm4pIHtcbiAgICByZXR1cm4gdHVybi50eXBlID09PSAna2luZycgJiYgdHVybi5jb2xvciA9PT0gc2VsZi5jb2xvcjtcbiAgfSk7XG5cbiAgaWYgKCFraW5nTW92ZWQpIHtcbiAgICBbWzAsIDIsIC0xXSwgWzcsIDYsICsxXV0uZm9yRWFjaChmdW5jdGlvbiAocHJvcHMpIHtcbiAgICAgIHZhciByb29rWCA9IHByb3BzWzBdO1xuICAgICAgdmFyIG5ld0tpbmdYID0gcHJvcHNbMV07XG4gICAgICB2YXIgZGlyID0gcHJvcHNbMl07XG4gICAgICB2YXIgcm9vayA9IGdhbWUuYm9hcmRbeV1bcm9va1hdO1xuXG4gICAgICAvLyBDaGVjayByb29rIG9uIHBvc2l0aW9uXG4gICAgICBpZiAoIXJvb2sgfHwgIXJvb2sudHlwZSA9PT0gJ3Jvb2snKSByZXR1cm47XG5cbiAgICAgIC8vIENoZWNrIHJvb2sgaGFzbid0IG1vdmVkXG4gICAgICBpZiAodHVybi5zb21lKGZ1bmN0aW9uIChldikge1xuICAgICAgICByZXR1cm4gZXYuZnJvbS54ID09PSByb29rWCAmJiBldi5mcm9tLnkgPT09IHk7XG4gICAgICB9KSkgcmV0dXJuO1xuXG4gICAgICAvLyBDaGVjayBzcXVhcmVzIGVtcHR5IGFuZCBzYWZlXG4gICAgICBmb3IgKHZhciB4eCA9IHggKyBkaXI7IHh4ICE9PSByb29rWDsgeHggKz0gZGlyKSB7XG4gICAgICAgIGlmIChnYW1lLmJvYXJkW3ldW3h4XSkgcmV0dXJuO1xuICAgICAgICB2YXIgc2FmZSA9IHRydWU7XG4gICAgICAgIGdhbWUuYm9hcmQuZm9yRWFjaChmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICBldi5mb3JFYWNoKGZ1bmN0aW9uIChldnYpIHtcbiAgICAgICAgICAgIGlmIChldnYgJiYgZXZ2LnR5cGUgIT09ICdraW5nJyAmJiBldnYuY29sb3IgIT09IHNlbGYuY29sb3IpIHtcbiAgICAgICAgICAgICAgZXZ2LmdldFZhbGlkTW92ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChldk1vdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZNb3ZlICYmIGV2TW92ZS55ID09PSB5ICYmIGV2TW92ZS54ID09PSB4eCkgc2FmZSA9IGZhbHNlO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghc2FmZSkgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgcm9jaGFkZSA9IHtcbiAgICAgICAgeDogbmV3S2luZ1gsXG4gICAgICAgIHk6IHksXG4gICAgICAgIG1vdmVQaWVjZToge1xuICAgICAgICAgIHBpZWNlOiBzZWxmLmdhbWUuYm9hcmRbeV1bcm9va1hdLFxuICAgICAgICAgIGZyb206IHtcbiAgICAgICAgICAgIHg6IHJvb2tYLCB5OiB5XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0bzoge1xuICAgICAgICAgICAgeTogeSwgeDogeCArIGRpclxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgbW92ZXMucHVzaChyb2NoYWRlKTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciB2YWxpZE1vdmVzID0gW107XG4gIGlmIChzaW11bGF0ZSkge1xuICAgIHZhbGlkTW92ZXMgPSBnYW1lLnNpbXVsYXRlQW5kRmlsdGVyKG1vdmVzLCBzZWxmKTtcbiAgfSBlbHNlIHtcbiAgICB2YWxpZE1vdmVzID0gbW92ZXM7XG4gIH1cblxuICByZXR1cm4gdmFsaWRNb3Zlcztcbn07XG5cblBpZWNlLmtpbmcgPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBLaW5nKHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbmV4cG9ydHMuUGllY2UgPSBQaWVjZTtcbmV4cG9ydHMuUGF3biA9IFBhd247XG5leHBvcnRzLlJvb2sgPSBSb29rO1xuZXhwb3J0cy5LbmlnaHQgPSBLbmlnaHQ7XG5leHBvcnRzLkJpc2hvcCA9IEJpc2hvcDtcbmV4cG9ydHMuUXVlZW4gPSBRdWVlbjtcbmV4cG9ydHMuS2luZyA9IEtpbmc7XG5cbi8qKiovIH0pLFxuLyogMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2dhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgX2dhbWUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2FtZSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBDaGVzc0FJID0gZnVuY3Rpb24gQ2hlc3NBSShkZXB0aCwgZ2FtZVN0YXRlLCBpc01heGltaXNpbmdQbGF5ZXIpIHtcbiAgLy8gQ2xvbmUgdGhlIGdhbWVTdGF0ZSB0byBhY2Nlc3MgYWxsIGdhbWUgYXNzb2NpYXRlZCBtZXRob2RzLlxuICAvLyBUaGlzIHVzdWFsbHkgZG9lc24ndCBtYWtlIHNlbnNlLCBidXQgc29tZXRpbWVzIHlvdSBjYW5ub3QgcG9zdCBmdW5jdGlvbnMgdG8gYSBiYWNrZW5kIG9yIGEgd2ViLXdvcmtlclxuICAvLyBhbmQgdGhhdCdzIHdoeSB3ZSdyZSB0b3VjaGluZyB0aGUgZ2FtZSBtZXRob2RzIGZyb20gbmV3IGdhbWUgY29uZmlndXJhdGlvbiBpbnRlYWQgZnJvbSB0aGUgcGFzc2VkIGFyZ3VtZW50LlxuICAvLyBTbyBpZiB5b3UgcGFzcyB7Ym9hcmQ6IFtteUJvYXJkXSwgdHVybjpbbXlUdXJuXSwuLi59IGZvciB0aGUgZ2FtZSBhcmd1bWVudCBpdCB3aWxsIGFjdHVhbGx5IHdvcmshXG4gIC8vIEFscmVhZHkgZGVzY3JpYmVkIGhlcmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9SU0ctR3JvdXAvQ2hlc3MvaXNzdWVzLzgjaXNzdWVjb21tZW50LTM4MTI0NTc5NFxuICB2YXIgZ2FtZSA9IF9nYW1lMi5kZWZhdWx0LnByb3RvdHlwZS5pbml0aWFsaXplR2FtZSgpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHtcbiAgICAgIGlmIChnYW1lU3RhdGUuYm9hcmRbaV1bal0pIHtcbiAgICAgICAgdmFyIGN1cnJlbnRDZWxsID0gZ2FtZVN0YXRlLmJvYXJkW2ldW2pdO1xuICAgICAgICBnYW1lLnBpZWNlKGN1cnJlbnRDZWxsLnR5cGUsIGosIGksIGN1cnJlbnRDZWxsLmNvbG9yKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdhbWUuYm9hcmRbaV1bal0gPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdhbWUudHVybiA9IGdhbWVTdGF0ZS50dXJuO1xuICBnYW1lLnRocmVlZm9sZCA9IGdhbWVTdGF0ZS50aHJlZWZvbGQ7XG4gIGdhbWUuRkVOID0gZ2FtZVN0YXRlLkZFTjtcbiAgZ2FtZS5GRU5ib2FyZCA9IGdhbWVTdGF0ZS5GRU5ib2FyZDtcblxuICAvLyBTdGFydCBsb29waW5nIGFuZCBzaW11bGF0aW5nIGFsbCB2YWxpZCBtb3Zlc1xuICB2YXIgYWxsTW92ZXMgPSBnYW1lLmFsbE1vdmVzKCk7XG4gIHZhciBiZXN0VmFsdWUgPSAtOTk5OTtcbiAgdmFyIGJlc3RNb3ZlO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsTW92ZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbmV3R2FtZU1vdmUgPSBhbGxNb3Zlc1tpXTtcbiAgICB2YXIgdW5kbyA9IGdhbWUuc2ltcGxlTW92ZShuZXdHYW1lTW92ZSk7XG4gICAgdmFyIGJvcmFkVmFsdWUgPSBtaW5pbWF4KGRlcHRoIC0gMSwgZ2FtZSwgLTEwMDAwLCAxMDAwMCwgIWlzTWF4aW1pc2luZ1BsYXllcik7XG4gICAgdW5kbygpO1xuICAgIGlmIChib3JhZFZhbHVlID49IGJlc3RWYWx1ZSkge1xuICAgICAgYmVzdFZhbHVlID0gYm9yYWRWYWx1ZTtcbiAgICAgIGJlc3RNb3ZlID0gbmV3R2FtZU1vdmU7XG4gICAgfVxuICB9XG4gIHJldHVybiBiZXN0TW92ZTtcbn07IC8vXG4vLyBSU0cgQ2hlc3Ncbi8vIExpY2Vuc2VkIHVuZGVyIEFwYWNoZSAyLjAgTElDRU5TRVxuXG52YXIgbWluaW1heCA9IGZ1bmN0aW9uIG1pbmltYXgoZGVwdGgsIGdhbWUsIGFscGhhLCBiZXRhLCBpc01heGltaXNpbmdQbGF5ZXIpIHtcbiAgaWYgKGRlcHRoID09PSAwKSB7XG4gICAgcmV0dXJuIC1ldmFsdWF0ZUJvYXJkKGdhbWUuYm9hcmQpO1xuICB9XG5cbiAgdmFyIGFsbE1vdmVzID0gZ2FtZS5hbGxNb3ZlcygpO1xuICBpZiAoaXNNYXhpbWlzaW5nUGxheWVyKSB7XG4gICAgdmFyIGJlc3RWYWx1ZSA9IC05OTk5O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsTW92ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciB1bmRvID0gZ2FtZS5zaW1wbGVNb3ZlKGFsbE1vdmVzW2ldKTtcbiAgICAgIGJlc3RWYWx1ZSA9IE1hdGgubWF4KGJlc3RWYWx1ZSwgbWluaW1heChkZXB0aCAtIDEsIGdhbWUsIGFscGhhLCBiZXRhLCAhaXNNYXhpbWlzaW5nUGxheWVyKSk7XG4gICAgICB1bmRvKCk7XG4gICAgICBhbHBoYSA9IE1hdGgubWF4KGFscGhhLCBiZXN0VmFsdWUpO1xuICAgICAgaWYgKGJldGEgPD0gYWxwaGEpIHtcbiAgICAgICAgcmV0dXJuIGJlc3RWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJlc3RWYWx1ZTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgX2Jlc3RWYWx1ZSA9IDk5OTk7XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFsbE1vdmVzLmxlbmd0aDsgX2krKykge1xuICAgICAgdmFyIF91bmRvID0gZ2FtZS5zaW1wbGVNb3ZlKGFsbE1vdmVzW19pXSk7XG4gICAgICBfYmVzdFZhbHVlID0gTWF0aC5taW4oX2Jlc3RWYWx1ZSwgbWluaW1heChkZXB0aCAtIDEsIGdhbWUsIGFscGhhLCBiZXRhLCAhaXNNYXhpbWlzaW5nUGxheWVyKSk7XG4gICAgICBfdW5kbygpO1xuICAgICAgYmV0YSA9IE1hdGgubWluKGJldGEsIF9iZXN0VmFsdWUpO1xuICAgICAgaWYgKGJldGEgPD0gYWxwaGEpIHtcbiAgICAgICAgcmV0dXJuIF9iZXN0VmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBfYmVzdFZhbHVlO1xuICB9XG59O1xuXG52YXIgZXZhbHVhdGVCb2FyZCA9IGZ1bmN0aW9uIGV2YWx1YXRlQm9hcmQoYm9hcmQpIHtcbiAgdmFyIHRvdGFsRXZhbHVhdGlvbiA9IDA7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHtcbiAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgY3VycmVudCBldmFsdWF0aW9uXG4gICAgICB0b3RhbEV2YWx1YXRpb24gPSB0b3RhbEV2YWx1YXRpb24gKyBnZXRQaWVjZVZhbHVlKGJvYXJkW2ldW2pdKTtcbiAgICB9XG4gIH1cbiAgLy8gcmV0dXJuIHRoZSB0b3RhbCBldmFsdWF0aW9uXG4gIHJldHVybiB0b3RhbEV2YWx1YXRpb247XG59O1xuXG52YXIgZ2V0UGllY2VWYWx1ZSA9IGZ1bmN0aW9uIGdldFBpZWNlVmFsdWUocGllY2UpIHtcbiAgaWYgKHBpZWNlID09PSBudWxsKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cblxuICAvLyBnZXQgdmFsdWUgZm9yIGV2ZXJ5IHBpZWNlIG9uIHRoZSBib2FyZFxuICB2YXIgZ2V0QWJzb2x1dGVWYWx1ZSA9IGZ1bmN0aW9uIGdldEFic29sdXRlVmFsdWUocGllY2UpIHtcbiAgICBpZiAocGllY2UudHlwZSA9PT0gJ3Bhd24nKSB7XG4gICAgICByZXR1cm4gMTA7XG4gICAgfSBlbHNlIGlmIChwaWVjZS50eXBlID09PSAncm9vaycpIHtcbiAgICAgIHJldHVybiA1MDtcbiAgICB9IGVsc2UgaWYgKHBpZWNlLnR5cGUgPT09ICdrbmlnaHQnKSB7XG4gICAgICByZXR1cm4gMzA7XG4gICAgfSBlbHNlIGlmIChwaWVjZS50eXBlID09PSAnYmlzaG9wJykge1xuICAgICAgcmV0dXJuIDMwO1xuICAgIH0gZWxzZSBpZiAocGllY2UudHlwZSA9PT0gJ3F1ZWVuJykge1xuICAgICAgcmV0dXJuIDkwO1xuICAgIH0gZWxzZSBpZiAocGllY2UudHlwZSA9PT0gJ2tpbmcnKSB7XG4gICAgICByZXR1cm4gOTAwO1xuICAgIH1cbiAgfTtcblxuICAvLyBjYWxjdWxhdGUgdGhlIGFic29sdXRlIHZhbHVlIGFuZCByZXR1cm4gaXRcbiAgdmFyIGFic29sdXRlVmFsdWUgPSBnZXRBYnNvbHV0ZVZhbHVlKHBpZWNlLCBwaWVjZS5jb2xvciA9PT0gJ1cnKTtcbiAgcmV0dXJuIHBpZWNlLmNvbG9yID09PSAnVycgPyBhYnNvbHV0ZVZhbHVlIDogLWFic29sdXRlVmFsdWU7XG59O1xuXG4vLyBleHBvcnQgdGhlIGFsZ29yaXRobVxuZXhwb3J0cy5kZWZhdWx0ID0gQ2hlc3NBSTtcblxuLy8gV3JpdHRlbiBieSBSYWRpIENob1xuLy8gUlNHIENoZXNzIC0gYnkgUlNHIEdyb3VwXG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5BSSA9IGV4cG9ydHMuUGllY2VzID0gZXhwb3J0cy5HYW1lID0gdW5kZWZpbmVkO1xuXG52YXIgX2dhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgX2dhbWUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2FtZSk7XG5cbnZhciBfcGllY2VzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblxudmFyIFBpZWNlcyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9waWVjZXMpO1xuXG52YXIgX0FJID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblxudmFyIF9BSTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9BSSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8vIEFuZCBleHBvcnQuLi5cbmV4cG9ydHMuR2FtZSA9IF9nYW1lMi5kZWZhdWx0O1xuZXhwb3J0cy5QaWVjZXMgPSBQaWVjZXM7XG5leHBvcnRzLkFJID0gX0FJMi5kZWZhdWx0OyAvLyBMZXQncyBpbXBvcnQuLi5cblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3b3JrZXIubWluLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgMDE4OTcwMjBkYzRkY2IwYWVlMzYiLCIvLyBzZWxmLmltcG9ydFNjcmlwdHMoXCJnYW1lLmpzXCIpO1xyXG5pbXBvcnQgeyBBSSB9IGZyb20gJ3JzZy1jaGVzcydcclxuXHJcbnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7XHJcbiAgaWYgKGUuZGF0YSAmJiBlLmRhdGEuZ2FtZSAmJiBlLmRhdGEucGxheUFnYWluc3RBSSkge1xyXG4gICAgdmFyIGJlc3RNb3ZlID0gQUkoZS5kYXRhLnBsYXlBZ2FpbnN0QUkuZGVwdGgsIGUuZGF0YS5nYW1lLCB0cnVlKVxyXG4gICAgc2VsZi5wb3N0TWVzc2FnZShiZXN0TW92ZSlcclxuICB9XHJcbn0pXHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2pzL3dvcmtlci5qcyIsIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwicnNnLWNoZXNzXCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInJzZy1jaGVzc1wiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJyc2ctY2hlc3NcIl0gPSBmYWN0b3J5KCk7XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRpOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGw6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3BpZWNlcyA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cbnZhciBfQUkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXG52YXIgX0FJMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0FJKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gR2FtZShwcm9tb0NhbGxiYWNrKSB7XG4gIC8vIHRoZSBnYW1lIGJvYXJkXG4gIHRoaXMuYm9hcmQgPSBbXTtcbiAgLy8gZmlsbCB0aGUgYm9hcmRcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICB2YXIgYXJyYXlJbiA9IFtdO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICBhcnJheUluLnB1c2gobnVsbCk7XG4gICAgfVxuICAgIHRoaXMuYm9hcmQucHVzaChhcnJheUluKTtcbiAgfVxuXG4gIC8vIHRoZSBoaXN0b3J5IG9mIGFsbCB0dXJuc1xuICB0aGlzLnR1cm4gPSBbXTtcbiAgLy8gdGhlIGN1cnJlbnQgRkVOIHN0YXR1c1xuICB0aGlzLkZFTiA9IFtdO1xuICAvLyB0aGUgY3VycmVudCBnYW1lIGNvbmZpZ3VyYXRpb24gYXMgRkVOXG4gIHRoaXMuRkVOYm9hcmQgPSBbXTtcbiAgLy8gdGhlIGhpc3Rvcnkgb2YgYWxsIGdhbWUgY29uZmlndXJhdGlvbnMgZGlzcGxheWVkIHVzaW5nIEZFTlxuICB0aGlzLnRocmVlZm9sZCA9IFtdO1xufVxuXG5HYW1lLnByb3RvdHlwZS5waWVjZSA9IGZ1bmN0aW9uICh0eXBlLCB4LCB5LCBjb2xvcikge1xuICB2YXIgcGllY2UgPSBfcGllY2VzLlBpZWNlW3R5cGVdKHgsIHksIGNvbG9yLCB0aGlzKTtcbiAgdGhpcy5ib2FyZFt5XVt4XSA9IHBpZWNlO1xuXG4gIHRoaXMuRkVOID0gdGhpcy5nYW1lVG9GRU4oKTtcbiAgdGhpcy5GRU5ib2FyZCA9IHRoaXMuYm9hcmRUb0ZFTigpO1xufTtcblxuR2FtZS5wcm90b3R5cGUubW92ZVNlbGVjdGVkID0gZnVuY3Rpb24gKHNlbGVjdGVkLCB0bywgcHJvbW90aW9uQ2FsbGJhY2ssIGNoZWNrbWF0ZUNhbGxiYWNrLCBwbGF5QWdhaW5zdEFJLCBzaW11bGF0ZSkge1xuICB2YXIgeCA9IHRvLng7XG4gIHZhciB5ID0gdG8ueTtcblxuICBpZiAoc2VsZWN0ZWQpIHtcbiAgICB2YXIgZnJvbSA9IHsgeDogc2VsZWN0ZWQueCwgeTogc2VsZWN0ZWQueSB9O1xuXG4gICAgaWYgKHRoaXMuYm9hcmRbeV1beF0gIT09IHNlbGVjdGVkKSB7XG4gICAgICB2YXIgdmFsaWRNb3ZlcyA9IHNlbGVjdGVkLmdldFZhbGlkTW92ZXMoIXNpbXVsYXRlKTtcbiAgICAgIHZhciB2YWxpZE1vdmUgPSBudWxsO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbGlkTW92ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHZtID0gdmFsaWRNb3Zlc1tpXTtcbiAgICAgICAgaWYgKHZtLnggPT09IHggJiYgdm0ueSA9PT0geSkge1xuICAgICAgICAgIHZhbGlkTW92ZSA9IHZtO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghdmFsaWRNb3ZlKSByZXR1cm4gZmFsc2U7XG4gICAgICB2YXIgbW92ZVBpZWNlID0gdmFsaWRNb3ZlLm1vdmVQaWVjZTtcbiAgICAgIHZhciB0YWtlLCBwYXN0ZSwgcm9vaztcbiAgICAgIGlmIChtb3ZlUGllY2UpIHtcbiAgICAgICAgdGFrZSA9IG1vdmVQaWVjZS5mcm9tO1xuICAgICAgICBwYXN0ZSA9IG1vdmVQaWVjZS50bztcbiAgICAgICAgaWYgKHBhc3RlID09PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5ib2FyZFt0YWtlLnldW3Rha2UueF0gPSBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJvb2sgPSB0aGlzLmJvYXJkW3Rha2UueV1bdGFrZS54XTtcbiAgICAgICAgICB0aGlzLmJvYXJkW3Bhc3RlLnldW3Bhc3RlLnhdID0gcm9vaztcbiAgICAgICAgICByb29rLnggPSBwYXN0ZS54O1xuICAgICAgICAgIHJvb2sueSA9IHBhc3RlLnk7XG4gICAgICAgICAgdGhpcy5ib2FyZFt0YWtlLnldW3Rha2UueF0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBwaWVjZSA9IHRoaXMuYm9hcmRbeV1beF0gPyB0aGlzLmJvYXJkW3ldW3hdIDogbnVsbDtcbiAgICAgIG1vdmVQaWVjZSA9IG1vdmVQaWVjZSA/IHZhbGlkTW92ZS5tb3ZlUGllY2UgOiBudWxsO1xuICAgICAgdGhpcy50dXJuLnB1c2goe1xuICAgICAgICBmcm9tOiBmcm9tLFxuICAgICAgICB0bzogdG8sXG4gICAgICAgIGNvbG9yOiBzZWxlY3RlZC5jb2xvcixcbiAgICAgICAgdHlwZTogc2VsZWN0ZWQudHlwZSxcbiAgICAgICAgcGllY2U6IHBpZWNlLFxuICAgICAgICBtb3ZlUGllY2U6IG1vdmVQaWVjZVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuYm9hcmRbeV1beF0gPSBzZWxlY3RlZDtcbiAgICAgIHRoaXMuYm9hcmRbc2VsZWN0ZWQueV1bc2VsZWN0ZWQueF0gPSBudWxsO1xuICAgICAgdGhpcy5ib2FyZFt5XVt4XS54ID0geDtcbiAgICAgIHRoaXMuYm9hcmRbeV1beF0ueSA9IHk7XG5cbiAgICAgIHRoaXMuRkVOID0gdGhpcy5nYW1lVG9GRU4oKTtcbiAgICAgIHRoaXMuRkVOYm9hcmQgPSB0aGlzLmJvYXJkVG9GRU4oKTtcbiAgICAgIC8vIGNoZWNrIGZvciB0aHJlZWZvbGQgcmVwZXRpdGlvblxuXG4gICAgICB0aGlzLnRocmVlZm9sZC5wdXNoKHRoaXMuRkVOYm9hcmQpO1xuICAgICAgaWYgKHNlbGVjdGVkLnR5cGUgPT09ICdwYXduJyB8fCBwaWVjZSkgdGhpcy50aHJlZWZvbGQgPSBbXTtcbiAgICAgIGlmICh0aGlzLnRocmVlZm9sZENoZWNrKCkpIGNoZWNrbWF0ZUNhbGxiYWNrKCdEJyk7XG5cbiAgICAgIC8vIGNoZWNrIGZvciB0aGUgZmlmdHktbW92ZSBydWxlXG4gICAgICBpZiAodGhpcy5oYWxmbW92ZUNsb2NrKCkgPj0gNTApIGNoZWNrbWF0ZUNhbGxiYWNrKCdEJyk7XG5cbiAgICAgIC8vIGNoZWNrIGZvciBwYXduIHByb21vdGlvblxuICAgICAgaWYgKHNlbGVjdGVkLnR5cGUgPT09ICdwYXduJykge1xuICAgICAgICBpZiAoc2VsZWN0ZWQuY29sb3IgPT09ICdXJyAmJiB5ID09PSAwIHx8IHNlbGVjdGVkLmNvbG9yID09PSAnQicgJiYgeSA9PT0gNykge1xuICAgICAgICAgIGlmIChwcm9tb3Rpb25DYWxsYmFjaykge1xuICAgICAgICAgICAgaWYgKHBsYXlBZ2FpbnN0QUkgJiYgIXBsYXlBZ2FpbnN0QUkubW9kZSAmJiBwbGF5QWdhaW5zdEFJLmNvbWluZ0FJICYmIHNlbGVjdGVkLmNvbG9yID09PSAnQicpIHtcbiAgICAgICAgICAgICAgcGxheUFnYWluc3RBSS5jdXN0b21BSVByb21vdGlvbiA/IHBsYXlBZ2FpbnN0QUkuY3VzdG9tQUlQcm9tb3Rpb24oKSA6IHRoaXMucHJvbW90ZVBhd24oc2VsZWN0ZWQsIHgsIHksIHNlbGVjdGVkLmNvbG9yLCAncXVlZW4nKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHByb21vdGlvbkNhbGxiYWNrKHNlbGVjdGVkLCB4LCB5LCBzZWxlY3RlZC5jb2xvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB2YXIgY2hlY2ttYXRlQ29sb3IgPSBzZWxlY3RlZC5jb2xvciA9PT0gJ1cnID8gJ0InIDogJ1cnO1xuICAgICAgdmFyIGNoZWNrbWF0ZVZhbHVlID0gdGhpcy5jaGVja21hdGUoY2hlY2ttYXRlQ29sb3IpO1xuICAgICAgaWYgKGNoZWNrbWF0ZVZhbHVlKSBjaGVja21hdGVDYWxsYmFjayhjaGVja21hdGVWYWx1ZSk7XG5cbiAgICAgIC8vIFBsYXkgQUlcbiAgICAgIGlmIChwbGF5QWdhaW5zdEFJICYmIHBsYXlBZ2FpbnN0QUkubW9kZSAmJiBwbGF5QWdhaW5zdEFJLm1vdmUpIHtcbiAgICAgICAgaWYgKHBsYXlBZ2FpbnN0QUkuY3VzdG9tQUlNb3ZlbWVudCkge1xuICAgICAgICAgIHBsYXlBZ2FpbnN0QUkuY3VzdG9tQUlNb3ZlbWVudCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBiZXN0TW92ZSA9ICgwLCBfQUkyLmRlZmF1bHQpKHBsYXlBZ2FpbnN0QUkuZGVwdGgsIHRoaXMsIGZhbHNlKTtcbiAgICAgICAgICB0aGlzLm1vdmVTZWxlY3RlZCh0aGlzLmJvYXJkW2Jlc3RNb3ZlLmZyb20ueV1bYmVzdE1vdmUuZnJvbS54XSwgYmVzdE1vdmUudG8sIHByb21vdGlvbkNhbGxiYWNrLCBjaGVja21hdGVDYWxsYmFjaywgZmFsc2UsIHRydWUsIHNpbXVsYXRlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gZW5kXG4gICAgfVxuICAgIHNlbGVjdGVkID0gbnVsbDtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufTtcblxuR2FtZS5wcm90b3R5cGUucHJvbW90ZVBhd24gPSBmdW5jdGlvbiAocGF3biwgeCwgeSwgY29sb3IsIHR5cGUpIHtcbiAgdGhpcy5waWVjZSh0eXBlLCB4LCB5LCBjb2xvcik7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5zaW11bGF0ZUFuZEZpbHRlciA9IGZ1bmN0aW9uIChtb3ZlcywgcGllY2UpIHtcbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuXG4gIG1vdmVzLmZvckVhY2goZnVuY3Rpb24gKG1vdmUsIGkpIHtcbiAgICB2YXIgeSA9IG1vdmUueTtcbiAgICB2YXIgeCA9IG1vdmUueDtcbiAgICB2YXIgZnJvbSA9IHsgeDogcGllY2UueCwgeTogcGllY2UueSB9O1xuICAgIHZhciBtb3ZlUGllY2UgPSBib2FyZFt5XVt4XSA/IHtcbiAgICAgIHBpZWNlOiBib2FyZFt5XVt4XSxcbiAgICAgIGZyb206IHsgeDogeCwgeTogeSB9LFxuICAgICAgdG86IG51bGxcbiAgICB9IDogbnVsbDtcblxuICAgIGlmIChtb3ZlLm1vdmVQaWVjZSkgbW92ZVBpZWNlID0gbW92ZS5tb3ZlUGllY2U7XG4gICAgaWYgKG1vdmVQaWVjZSkgc2VsZi5zaW1wbGVNb3ZlUGllY2UobW92ZVBpZWNlLnBpZWNlLCBtb3ZlUGllY2UuZnJvbSwgbW92ZVBpZWNlLnRvKTtcblxuICAgIHNlbGYuc2ltcGxlTW92ZVBpZWNlKHBpZWNlLCBmcm9tLCB7IHg6IHgsIHk6IHkgfSk7XG4gICAgdmFyIHdhcm5pbmcgPSBzZWxmLndhcm5pbmcocGllY2UuY29sb3IpO1xuXG4gICAgLy8gUmV0dXJuIGtpbmdcbiAgICBzZWxmLnNpbXBsZU1vdmVQaWVjZShwaWVjZSwgeyB4OiB4LCB5OiB5IH0sIGZyb20pO1xuXG4gICAgLy8gcmV0dXJuIHRoZSBtb3ZlUGllY2Ugd2l0aCBzaW1wbGVNb3ZlUGllY2UoKSBtZXRob2RcbiAgICBpZiAobW92ZVBpZWNlKSBzZWxmLnNpbXBsZU1vdmVQaWVjZShtb3ZlUGllY2UucGllY2UsIG1vdmVQaWVjZS50bywgbW92ZVBpZWNlLmZyb20pO1xuXG4gICAgaWYgKCF3YXJuaW5nKSB2YWxpZE1vdmVzLnB1c2gobW92ZSk7XG4gIH0pO1xuICByZXR1cm4gdmFsaWRNb3Zlcztcbn07XG5cbkdhbWUucHJvdG90eXBlLmNoZWNrbWF0ZSA9IGZ1bmN0aW9uIChjb2xvcikge1xuICAvLyB1c2luZyBsZXQgd2lsbCBhbGxvdyB1cyB0byBtYWtlIHRoZSBjb2RlIGEgYml0IHNpbXBsZXJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDg7IGorKykge1xuICAgICAgaWYgKHRoaXMuYm9hcmRbaV1bal0gJiYgdGhpcy5ib2FyZFtpXVtqXS5jb2xvciA9PT0gY29sb3IgJiYgdGhpcy5ib2FyZFtpXVtqXS5nZXRWYWxpZE1vdmVzKHRydWUpLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBpZiAodGhpcy53YXJuaW5nKGNvbG9yKSkgcmV0dXJuIGNvbG9yO1xuICByZXR1cm4gJ0QnO1xufTtcblxuR2FtZS5wcm90b3R5cGUuc2ltcGxlTW92ZVBpZWNlID0gZnVuY3Rpb24gKHBpZWNlLCBmcm9tLCB0bykge1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuICBpZiAodG8pIHtcbiAgICBib2FyZFt0by55XVt0by54XSA9IHBpZWNlO1xuICAgIHBpZWNlLnggPSB0by54O1xuICAgIHBpZWNlLnkgPSB0by55O1xuICB9XG4gIGlmIChmcm9tKSBib2FyZFtmcm9tLnldW2Zyb20ueF0gPSBudWxsO1xufTtcblxuR2FtZS5wcm90b3R5cGUuc2ltcGxlTW92ZSA9IGZ1bmN0aW9uIChtb3ZlKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdmFyIGJvYXJkID0gc2VsZi5ib2FyZDtcbiAgdmFyIGZyb20gPSBtb3ZlLmZyb207XG4gIHZhciB0byA9IG1vdmUudG87XG4gIHZhciBwaWVjZSA9IGJvYXJkW2Zyb20ueV1bZnJvbS54XTtcbiAgdmFyIGNhcHR1cmVkUGllY2UgPSB0aGlzLmJvYXJkW3RvLnldW3RvLnhdID8gdGhpcy5ib2FyZFt0by55XVt0by54XSA6IG51bGw7XG4gIHZhciBtb3ZlUGllY2UgPSBib2FyZFt0by55XVt0by54XSA/IHtcbiAgICBwaWVjZTogYm9hcmRbdG8ueV1bdG8ueF0sXG4gICAgZnJvbTogeyB4OiB0by54LCB5OiB0by55IH0sXG4gICAgdG86IG51bGxcbiAgfSA6IG51bGw7XG5cbiAgdGhpcy50dXJuLnB1c2goe1xuICAgIGZyb206IGZyb20sXG4gICAgdG86IHsgeDogdG8ueCwgeTogdG8ueSB9LFxuICAgIGNvbG9yOiBtb3ZlLmNvbG9yLFxuICAgIHR5cGU6IHBpZWNlLnR5cGUsXG4gICAgcGllY2U6IGNhcHR1cmVkUGllY2UsXG4gICAgbW92ZVBpZWNlOiBtb3ZlUGllY2VcbiAgfSk7XG5cbiAgaWYgKHRvLm1vdmVQaWVjZSkgbW92ZVBpZWNlID0gdG8ubW92ZVBpZWNlO1xuICBpZiAobW92ZVBpZWNlKSBzZWxmLnNpbXBsZU1vdmVQaWVjZShtb3ZlUGllY2UucGllY2UsIG1vdmVQaWVjZS5mcm9tLCBtb3ZlUGllY2UudG8pO1xuICBzZWxmLnNpbXBsZU1vdmVQaWVjZShwaWVjZSwgZnJvbSwgeyB4OiB0by54LCB5OiB0by55IH0pO1xuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gcmV0dXJuIHRoZSBjdXJyZW50IG1vdmUgL2V2L1xuICAgIGlmIChtb3ZlUGllY2UpIHNlbGYuc2ltcGxlTW92ZVBpZWNlKG1vdmVQaWVjZS5waWVjZSwgbW92ZVBpZWNlLnRvLCBtb3ZlUGllY2UuZnJvbSk7XG4gICAgc2VsZi5zaW1wbGVNb3ZlUGllY2UocGllY2UsIHsgeDogdG8ueCwgeTogdG8ueSB9LCBmcm9tKTtcbiAgICBpZiAoY2FwdHVyZWRQaWVjZSkgYm9hcmRbdG8ueV1bdG8ueF0gPSBjYXB0dXJlZFBpZWNlO1xuICAgIHNlbGYudHVybi5wb3AoKTtcbiAgfTtcbn07XG5cbkdhbWUucHJvdG90eXBlLndhcm5pbmcgPSBmdW5jdGlvbiAoY29sb3IpIHtcbiAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuICB2YXIga2luZztcblxuICB0aGlzLmJvYXJkLmZvckVhY2goZnVuY3Rpb24gKHl5eSkge1xuICAgIHl5eS5mb3JFYWNoKGZ1bmN0aW9uICh4eHgpIHtcbiAgICAgIGlmICh4eHggJiYgeHh4LmNvbG9yID09PSBjb2xvciAmJiB4eHgudHlwZSA9PT0gJ2tpbmcnKSB7XG4gICAgICAgIGtpbmcgPSB4eHg7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRoaXMuYm9hcmQuZm9yRWFjaChmdW5jdGlvbiAoeXl5KSB7XG4gICAgeXl5LmZvckVhY2goZnVuY3Rpb24gKHh4eCkge1xuICAgICAgaWYgKHh4eCAmJiB4eHguY29sb3IgIT09IGNvbG9yKSB7XG4gICAgICAgIHh4eC5nZXRWYWxpZE1vdmVzKCkuZm9yRWFjaChmdW5jdGlvbiAobW1tKSB7XG4gICAgICAgICAgaWYgKG1tbS54ID09PSBraW5nLnggJiYgbW1tLnkgPT09IGtpbmcueSkgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuR2FtZS5wcm90b3R5cGUudGhyZWVmb2xkQ2hlY2sgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0aHJlZWZvbGQgPSB0aGlzLnRocmVlZm9sZDtcbiAgdmFyIGxlbmd0aCA9IHRocmVlZm9sZC5sZW5ndGg7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIC8vIHVzaW5nIGxldCB3aWxsIGFsbG93IHVzIHRvIG1ha2UgdGhlIGNvZGUgc2ltcGxlclxuICAgIHZhciBjb3VudCA9IDA7XG4gICAgZm9yICh2YXIgaiA9IGkgKyAxOyBqIDwgbGVuZ3RoOyBqKyspIHtcbiAgICAgIGlmICh0aHJlZWZvbGRbaV0gPT09IHRocmVlZm9sZFtqXSkgY291bnQgKz0gMTtcbiAgICB9XG4gICAgaWYgKGNvdW50ID49IDIpIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuR2FtZS5wcm90b3R5cGUucGllY2VUb0FOID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgdmFyIHhDaGFycyA9ICdhYmNkZWZnaCc7XG4gIHJldHVybiB4Q2hhcnMuY2hhckF0KHgpICsgKDggLSB5KTtcbn07XG5cbi8vIFN1cHBvcnQgRkVOIGZ1bmN0aW9ucyBpbiB0aGUgQVBJXG5HYW1lLnByb3RvdHlwZS5ib2FyZFRvRkVOID0gZnVuY3Rpb24gKCkge1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuXG4gIC8vIENvbnZlcnQgdGhlIGJvYXJkIGNvbmZpZ3VyYXRpb24gaW50byBGRU5cbiAgdmFyIEZFTmJvYXJkID0gJyc7XG4gIHZhciBtaXNzaW5nUGllY2VzID0gMDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDg7IGorKykge1xuICAgICAgaWYgKGJvYXJkW2ldW2pdKSB7XG4gICAgICAgIGlmIChtaXNzaW5nUGllY2VzKSBGRU5ib2FyZCArPSBtaXNzaW5nUGllY2VzO1xuICAgICAgICBtaXNzaW5nUGllY2VzID0gMDtcbiAgICAgICAgRkVOYm9hcmQgKz0gYm9hcmRbaV1bal0uRkVObmFtZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1pc3NpbmdQaWVjZXMrKztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1pc3NpbmdQaWVjZXMpIEZFTmJvYXJkICs9IG1pc3NpbmdQaWVjZXM7XG4gICAgbWlzc2luZ1BpZWNlcyA9IDA7XG4gICAgRkVOYm9hcmQgKz0gaSA8IDcgPyAnLycgOiAnJztcbiAgfVxuXG4gIHJldHVybiBGRU5ib2FyZDtcbn07XG5cbkdhbWUucHJvdG90eXBlLmhhbGZtb3ZlQ2xvY2sgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0dXJuID0gdGhpcy50dXJuO1xuICB2YXIgbGVuZ3RoID0gdHVybi5sZW5ndGg7XG4gIHZhciBjb3VudCA9IDA7XG4gIGlmICh0dXJuLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGNvdW50O1xuXG4gIHZhciBldiA9IHR1cm5bbGVuZ3RoIC0gMSAtIGNvdW50XTtcbiAgd2hpbGUgKGNvdW50IDw9IGxlbmd0aCAtIDEgJiYgZXYudHlwZSAhPT0gJ3Bhd24nICYmICFldi5waWVjZSkge1xuICAgIGNvdW50Kys7XG4gICAgZXYgPSB0dXJuW2xlbmd0aCAtIDEgLSBjb3VudF07XG4gIH1cblxuICByZXR1cm4gY291bnQ7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5hY3RpdmVDb2xvdXIgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0dXJuID0gdGhpcy50dXJuO1xuICB2YXIgYWN0aXZlQ29sb3IgPSB0dXJuLmxlbmd0aCAmJiB0dXJuW3R1cm4ubGVuZ3RoIC0gMV0uY29sb3IgPT09ICdXJyA/ICdiJyA6ICd3JztcblxuICByZXR1cm4gYWN0aXZlQ29sb3I7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5jYXN0bGluZ1RhcmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGJvYXJkID0gdGhpcy5ib2FyZDtcbiAgdmFyIHR1cm4gPSB0aGlzLnR1cm47XG4gIHZhciBwb3NzaWJsZUNhc3RsaW5nID0gJyc7XG5cbiAgdmFyIHdoaXRlS2luZ01vdmVkO1xuICB2YXIgYmxhY2tLaW5nTW92ZWQ7XG4gIHR1cm4uZm9yRWFjaChmdW5jdGlvbiAodHVybikge1xuICAgIHdoaXRlS2luZ01vdmVkID0gdHVybi50eXBlID09PSAna2luZycgJiYgdHVybi5jb2xvciA9PT0gJ1cnO1xuICAgIGJsYWNrS2luZ01vdmVkID0gdHVybi50eXBlID09PSAna2luZycgJiYgdHVybi5jb2xvciA9PT0gJ0InO1xuICB9KTtcblxuICBbWzcsIDBdLCBbMCwgMF0sIFs3LCA3XSwgWzAsIDddXS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHZhciByb29rWCA9IHByb3BzWzBdO1xuICAgIHZhciByb29rWSA9IHByb3BzWzFdO1xuICAgIHZhciByb29rID0gYm9hcmRbcm9va1ldW3Jvb2tYXTtcblxuICAgIGlmIChyb29rWSA9PT0gNyAmJiB3aGl0ZUtpbmdNb3ZlZCkgcmV0dXJuO1xuICAgIGlmIChyb29rWSA9PT0gMCAmJiBibGFja0tpbmdNb3ZlZCkgcmV0dXJuO1xuXG4gICAgLy8gQ2hlY2sgcm9vayBvbiBwb3NpdGlvblxuICAgIGlmICghcm9vayB8fCAhcm9vay50eXBlID09PSAncm9vaycpIHJldHVybjtcblxuICAgIC8vIENoZWNrIHJvb2sgaGFzbid0IG1vdmVkXG4gICAgaWYgKHR1cm4uc29tZShmdW5jdGlvbiAoZXYpIHtcbiAgICAgIGlmIChldi50eXBlICE9PSAncm9vaycpIHJldHVybiBmYWxzZTtcbiAgICAgIHJldHVybiBldi5mcm9tLnggPT09IHJvb2tYICYmIGV2LmZyb20ueSA9PT0gcm9va1k7XG4gICAgfSkpIHJldHVybjtcblxuICAgIHZhciBjYXN0bGluZ1NpZGUgPSByb29rWCA9PT0gMCA/ICdxJyA6ICdrJztcbiAgICBwb3NzaWJsZUNhc3RsaW5nICs9IHJvb2tZID09PSAwID8gY2FzdGxpbmdTaWRlLnRvVXBwZXJDYXNlKCkgOiBjYXN0bGluZ1NpZGU7XG4gIH0pO1xuXG4gIGlmICghcG9zc2libGVDYXN0bGluZykgcG9zc2libGVDYXN0bGluZyA9ICctJztcbiAgcmV0dXJuIHBvc3NpYmxlQ2FzdGxpbmc7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5lblBhc3NhbnRUYXJnZXQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0dXJuID0gdGhpcy50dXJuO1xuICB2YXIgZW5QYXNzYW50VGFyZ2V0ID0gJyc7XG5cbiAgaWYgKHR1cm4ubGVuZ3RoKSB7XG4gICAgdmFyIGV2ID0gdHVyblt0dXJuLmxlbmd0aCAtIDFdO1xuICAgIGlmIChldi5jb2xvciA9PT0gJ1cnICYmIGV2LnRvLnkgPT09IDQpIHtcbiAgICAgIGVuUGFzc2FudFRhcmdldCA9IHRoaXMucGllY2VUb0FOKGV2LnRvLngsIGV2LnRvLnkgKyAxKTtcbiAgICB9XG5cbiAgICBpZiAoZXYuY29sb3IgPT09ICdCJyAmJiBldi50by55ID09PSAzKSB7XG4gICAgICBlblBhc3NhbnRUYXJnZXQgPSB0aGlzLnBpZWNlVG9BTihldi50by54LCBldi50by55IC0gMSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFlblBhc3NhbnRUYXJnZXQpIGVuUGFzc2FudFRhcmdldCA9ICctJztcbiAgcmV0dXJuIGVuUGFzc2FudFRhcmdldDtcbn07XG5cbkdhbWUucHJvdG90eXBlLmZ1bGxtb3ZlQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBjb3VudCA9IDE7XG4gIHRoaXMudHVybi5mb3JFYWNoKGZ1bmN0aW9uIChldikge1xuICAgIGlmIChldi5jb2xvciA9PT0gJ0InKSBjb3VudCArPSAxO1xuICB9KTtcblxuICByZXR1cm4gY291bnQ7XG59O1xuXG5HYW1lLnByb3RvdHlwZS5nYW1lVG9GRU4gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBGRU4gPSAnJztcblxuICAvLyBDaGVjayB0aGUgYm9hcmQgY29uZmlndXJhdGlvblxuICBGRU4gKz0gdGhpcy5ib2FyZFRvRkVOKCk7XG5cbiAgLy8gRmluZCB0aGUgYWN0aXZlIGNvbG91clxuICBGRU4gKz0gJyAnICsgdGhpcy5hY3RpdmVDb2xvdXIoKTtcblxuICAvLyBDaGVjayBjYXN0bGluZyBhdmFpbGFiaWxpdHlcbiAgRkVOICs9ICcgJyArIHRoaXMuY2FzdGxpbmdUYXJnZXQoKTtcblxuICAvLyBDaGVjayB0aGUgRW4tcGFzc2FudCB0YXJnZXRcbiAgRkVOICs9ICcgJyArIHRoaXMuZW5QYXNzYW50VGFyZ2V0KCk7XG5cbiAgLy8gQWRkIHRoZSBoYWxmbW92ZSBjbG9ja1xuICBGRU4gKz0gJyAnICsgdGhpcy5oYWxmbW92ZUNsb2NrKCk7XG5cbiAgLy8gQWRkIHRoZSBmdWxsbW92ZSBudW1iZXJcbiAgRkVOICs9ICcgJyArIHRoaXMuZnVsbG1vdmVDb3VudCgpO1xuXG4gIC8qXHJcbiAgICBNb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBGRU4gbm90YXRpb246XHJcbiAgICBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Gb3JzeXRoJUUyJTgwJTkzRWR3YXJkc19Ob3RhdGlvblxyXG4gICAgaHR0cHM6Ly9jaGVzc3Byb2dyYW1taW5nLndpa2lzcGFjZXMuY29tL0ZvcnN5dGgtRWR3YXJkcytOb3RhdGlvblxyXG4gICovXG5cbiAgcmV0dXJuIEZFTjtcbn07XG5cbi8vIFNldCB1cCBkZWZhdWx0IGdhbWUgY29uZmlndXJhdGlvblxuR2FtZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBkZWZhdWx0R2FtZSA9IG5ldyBHYW1lKCk7XG5cbiAgLy8gUGF3bnM6XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgZGVmYXVsdEdhbWUucGllY2UoJ3Bhd24nLCBpLCA2LCAnVycpO1xuICAgIGRlZmF1bHRHYW1lLnBpZWNlKCdwYXduJywgaSwgMSwgJ0InKTtcbiAgfVxuXG4gIC8vIEJsYWNrIGZpZ3M6XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdyb29rJywgMCwgMCwgJ0InKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2tuaWdodCcsIDEsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdiaXNob3AnLCAyLCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgncXVlZW4nLCAzLCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna2luZycsIDQsIDAsICdCJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdiaXNob3AnLCA1LCAwLCAnQicpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna25pZ2h0JywgNiwgMCwgJ0InKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ3Jvb2snLCA3LCAwLCAnQicpO1xuXG4gIC8vIFdoaXRlIGZpZ3M6XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdyb29rJywgMCwgNywgJ1cnKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ2tuaWdodCcsIDEsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdiaXNob3AnLCAyLCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgncXVlZW4nLCAzLCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna2luZycsIDQsIDcsICdXJyk7XG4gIGRlZmF1bHRHYW1lLnBpZWNlKCdiaXNob3AnLCA1LCA3LCAnVycpO1xuICBkZWZhdWx0R2FtZS5waWVjZSgna25pZ2h0JywgNiwgNywgJ1cnKTtcbiAgZGVmYXVsdEdhbWUucGllY2UoJ3Jvb2snLCA3LCA3LCAnVycpO1xuXG4gIHJldHVybiBkZWZhdWx0R2FtZTtcbn07XG5cbkdhbWUucHJvdG90eXBlLmFsbE1vdmVzID0gZnVuY3Rpb24gKCkge1xuICB2YXIgYm9hcmQgPSB0aGlzLmJvYXJkO1xuICB2YXIgYWxsTW92ZXMgPSBbXTtcbiAgdmFyIGFjdGl2ZUNvbG91ciA9IHRoaXMuYWN0aXZlQ29sb3VyKCkudG9VcHBlckNhc2UoKTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICBpZiAoYm9hcmRbaV1bal0gJiYgYm9hcmRbaV1bal0uY29sb3IgPT09IGFjdGl2ZUNvbG91cikge1xuICAgICAgICB2YXIgdmFsaWRNb3ZlcyA9IGJvYXJkW2ldW2pdLmdldFZhbGlkTW92ZXModHJ1ZSk7XG4gICAgICAgIHZhbGlkTW92ZXMuZm9yRWFjaChmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICBhbGxNb3Zlcy5wdXNoKHtcbiAgICAgICAgICAgIGNvbG9yOiBib2FyZFtpXVtqXS5jb2xvcixcbiAgICAgICAgICAgIGZyb206IHsgeDogaiwgeTogaSB9LFxuICAgICAgICAgICAgdG86IGV2LFxuICAgICAgICAgICAgRkVObmFtZTogYm9hcmRbaV1bal0uRkVObmFtZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gYWxsTW92ZXM7XG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSBHYW1lO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8vXG4vLyBSU0cgQ2hlc3Ncbi8vIExpY2Vuc2VkIHVuZGVyIEFwYWNoZSAyLjAgTElDRU5TRVxuXG52YXIgUElFQ0VfQ0hBUlMgPSBleHBvcnRzLlBJRUNFX0NIQVJTID0ge1xuICBwYXduOiB7IFc6ICfimZknLCBCOiAn4pmfJyB9LFxuICByb29rOiB7IFc6ICfimZYnLCBCOiAn4pmcJyB9LFxuICBrbmlnaHQ6IHsgVzogJ+KZmCcsIEI6ICfimZ4nIH0sXG4gIGJpc2hvcDogeyBXOiAn4pmXJywgQjogJ+KZnScgfSxcbiAgcXVlZW46IHsgVzogJ+KZlScsIEI6ICfimZsnIH0sXG4gIGtpbmc6IHsgVzogJ+KZlCcsIEI6ICfimZonIH1cbn07XG5cbmZ1bmN0aW9uIFBpZWNlKHgsIHksIGNoYXJCYXNlLCBjb2xvciwgZ2FtZSwgdHlwZSkge1xuICBpZiAoY2hhckJhc2UpIHRoaXMuY2hhciA9IGNoYXJCYXNlW2NvbG9yXTtcbiAgdGhpcy5jb2xvciA9IGNvbG9yO1xuICB0aGlzLnggPSB4O1xuICB0aGlzLnkgPSB5O1xuICB0aGlzLmdhbWUgPSBnYW1lO1xuICB0aGlzLnR5cGUgPSB0eXBlO1xuICBpZiAodHlwZSkge1xuICAgIHZhciBGRU5uYW1lID0gdHlwZSA9PT0gJ2tuaWdodCcgPyAnbicgOiB0eXBlLmNoYXJBdCgwKTtcbiAgICBpZiAodGhpcy5jb2xvciA9PT0gJ1cnKSBGRU5uYW1lID0gRkVObmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgIHRoaXMuRkVObmFtZSA9IEZFTm5hbWU7XG4gIH1cbn1cblxuUGllY2UuZW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBuZXcgUGllY2UoKTtcbn07XG5cblBpZWNlLnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gW3sgeDogMCwgeTogMCB9LCB7IHg6IDcsIHk6IDcgfV07XG59O1xuXG5mdW5jdGlvbiBQYXduKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMucGF3biwgY29sb3IsIGdhbWUsICdwYXduJyk7XG59XG5cblBhd24ucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcblBhd24ucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoc2ltdWxhdGUpIHtcbiAgdmFyIGdhbWUgPSB0aGlzLmdhbWU7XG4gIHZhciBtb3ZlcyA9IFtdO1xuICAvKiBlc2xpbnQtZGlzYWJsZSAqL1xuICB2YXIgeSA9IHRoaXMueSxcbiAgICAgIHggPSB0aGlzLng7XG4gIHZhciBib2FyZCA9IGdhbWUuYm9hcmQsXG4gICAgICB0dXJuID0gZ2FtZS50dXJuLFxuICAgICAgbGVuZ3RoID0gdHVybi5sZW5ndGg7XG4gIHZhciBsYXN0LCB0dXJuVG8sIHR1cm5Gcm9tLCBmaWdYLCBwYXNzYW50TGFzdCwgcGFzc2FudEZpZztcbiAgdmFyIGNvbG9yWSA9IHRoaXMuY29sb3IgPT09ICdXJyA/IHkgLSAxIDogeSArIDE7XG4gIHZhciBjb2xvclkyID0gdGhpcy5jb2xvciA9PT0gJ1cnID8geSAtIDIgOiB5ICsgMjtcbiAgdmFyIHBhc3NhbnRZMiA9IHRoaXMuY29sb3IgPT09ICdXJyA/IDMgOiA0O1xuICB2YXIgZmlnWEFycmF5ID0gW3ggLSAxLCB4ICsgMV07XG4gIC8qIGVzbGludC1lbmFibGUgKi9cblxuICBpZiAoY29sb3JZIDwgOCAmJiBjb2xvclkgPj0gMCAmJiAhYm9hcmRbY29sb3JZXVt4XSkge1xuICAgIG1vdmVzLnB1c2goeyB4OiB4LCB5OiBjb2xvclkgfSk7XG4gICAgaWYgKCh5ID09PSAxIHx8IHkgPT09IDYpICYmIGNvbG9yWTIgPCA4ICYmIGNvbG9yWTIgPj0gMCAmJiAhZ2FtZS5ib2FyZFtjb2xvclkyXVt4XSkge1xuICAgICAgbW92ZXMucHVzaCh7IHg6IHgsIHk6IGNvbG9yWTIgfSk7XG4gICAgfVxuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCAyOyBpKyspIHtcbiAgICBmaWdYID0gZmlnWEFycmF5W2ldO1xuICAgIGlmIChjb2xvclkgPCA4ICYmIGNvbG9yWSA+PSAwICYmIGJvYXJkW2NvbG9yWV1bZmlnWF0gJiYgYm9hcmRbY29sb3JZXVtmaWdYXS5jb2xvciAhPT0gdGhpcy5jb2xvcikgbW92ZXMucHVzaCh7IHg6IGZpZ1gsIHk6IGNvbG9yWSB9KTtcbiAgfVxuXG4gIC8vIENoZWNrIGZvciBlbi1wYXNzYW50XG4gIGZvciAodmFyIF9pID0gMDsgX2kgPCAyOyBfaSsrKSB7XG4gICAgZmlnWCA9IGZpZ1hBcnJheVtfaV07XG4gICAgbGFzdCA9IHR1cm5bbGVuZ3RoIC0gMV07XG5cbiAgICBpZiAobGFzdCAmJiBsYXN0LnR5cGUgPT09ICdwYXduJyAmJiBsYXN0LnRvLnggPT09IGZpZ1ggJiYgbGFzdC50by55ID09PSB5ICYmIGxhc3QuY29sb3IgIT09IHRoaXMuY29sb3IgJiYgKGxhc3QuZnJvbS55ID09PSAxIHx8IGxhc3QuZnJvbS55ID09PSA2KSAmJiAoeSA9PT0gMyB8fCB5ID09PSA0KSkge1xuICAgICAgbW92ZXMucHVzaCh7XG4gICAgICAgIHg6IGZpZ1gsXG4gICAgICAgIHk6IGNvbG9yWSxcbiAgICAgICAgbW92ZVBpZWNlOiB7XG4gICAgICAgICAgcGllY2U6IGdhbWUuYm9hcmRbeV1bZmlnWF0sXG4gICAgICAgICAgZnJvbToge1xuICAgICAgICAgICAgeDogZmlnWCxcbiAgICAgICAgICAgIHk6IHlcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRvOiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHZhciB2YWxpZE1vdmVzID0gW107XG4gIGlmIChzaW11bGF0ZSkge1xuICAgIHZhbGlkTW92ZXMgPSBnYW1lLnNpbXVsYXRlQW5kRmlsdGVyKG1vdmVzLCB0aGlzKTtcbiAgfSBlbHNlIHtcbiAgICB2YWxpZE1vdmVzID0gbW92ZXM7XG4gIH1cblxuICByZXR1cm4gdmFsaWRNb3Zlcztcbn07XG5cblBpZWNlLnBhd24gPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBQYXduKHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbi8vIC8vXG5cbmZ1bmN0aW9uIFJvb2soeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgUGllY2UuY2FsbCh0aGlzLCB4LCB5LCBQSUVDRV9DSEFSUy5yb29rLCBjb2xvciwgZ2FtZSwgJ3Jvb2snKTtcbn1cblxuUm9vay5wcm90b3R5cGUgPSBQaWVjZS5lbXB0eSgpO1xuUm9vay5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIG1vdmVzID0gW107XG5cbiAgW1stMSwgMF0sIFsxLCAwXSwgWzAsIDFdLCBbMCwgLTFdXS5mb3JFYWNoKGZ1bmN0aW9uIChjb2VmKSB7XG4gICAgdmFyIGluZGV4LCB4LCB5LCBwaWVjZTtcbiAgICBmb3IgKGluZGV4ID0gMTs7IGluZGV4KyspIHtcbiAgICAgIHggPSB0aGlzLnggKyBjb2VmWzBdICogaW5kZXg7XG4gICAgICB5ID0gdGhpcy55ICsgY29lZlsxXSAqIGluZGV4O1xuICAgICAgaWYgKHkgPCAwIHx8IHkgPiA3IHx8IHggPCAwIHx8IHggPiA3KSBicmVhaztcblxuICAgICAgcGllY2UgPSBnYW1lLmJvYXJkW3ldW3hdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSB0aGlzLmNvbG9yKSBicmVhaztcblxuICAgICAgbW92ZXMucHVzaCh7IHg6IHgsIHk6IHkgfSk7XG4gICAgICBpZiAocGllY2UpIGJyZWFrO1xuICAgIH1cbiAgfSwgdGhpcyk7XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2Uucm9vayA9IGZ1bmN0aW9uICh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICByZXR1cm4gbmV3IFJvb2soeCwgeSwgY29sb3IsIGdhbWUpO1xufTtcblxuLy8gLy9cblxuZnVuY3Rpb24gS25pZ2h0KHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMua25pZ2h0LCBjb2xvciwgZ2FtZSwgJ2tuaWdodCcpO1xufVxuXG5LbmlnaHQucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcbktuaWdodC5wcm90b3R5cGUuZ2V0VmFsaWRNb3ZlcyA9IGZ1bmN0aW9uIChzaW11bGF0ZSkge1xuICB2YXIgZ2FtZSA9IHRoaXMuZ2FtZTtcbiAgdmFyIG1vdmVzID0gW107XG5cbiAgdmFyIGNvb3JkaW5hdGVzID0gW1syLCAxXSwgWy0yLCAxXSwgWzEsIDJdLCBbLTEsIDJdLCBbMiwgLTFdLCBbLTIsIC0xXSwgWzEsIC0yXSwgWy0xLCAtMl1dO1xuXG4gIHZhciBvbmUsIHR3bztcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb29yZGluYXRlcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBoZWxwID0gZmFsc2U7XG4gICAgdmFyIGJvYXJkUGllY2U7XG4gICAgb25lID0gY29vcmRpbmF0ZXNbaV1bMF07XG4gICAgdHdvID0gY29vcmRpbmF0ZXNbaV1bMV07XG5cbiAgICBpZiAodGhpcy54ICsgb25lIDwgOCAmJiB0aGlzLnggKyBvbmUgPj0gMCAmJiB0aGlzLnkgKyB0d28gPCA4ICYmIHRoaXMueSArIHR3byA+PSAwKSB7XG4gICAgICBib2FyZFBpZWNlID0gZ2FtZS5ib2FyZFt0aGlzLnkgKyB0d29dW3RoaXMueCArIG9uZV07XG4gICAgICBoZWxwID0gYm9hcmRQaWVjZSA/IGJvYXJkUGllY2UuY29sb3IgIT09IHRoaXMuY29sb3IgOiB0cnVlO1xuICAgIH1cblxuICAgIGlmIChoZWxwKSB7XG4gICAgICBtb3Zlcy5wdXNoKHsgeDogdGhpcy54ICsgb25lLCB5OiB0aGlzLnkgKyB0d28gfSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2Uua25pZ2h0ID0gZnVuY3Rpb24gKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIHJldHVybiBuZXcgS25pZ2h0KHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbi8vIC8vXG5cbmZ1bmN0aW9uIEJpc2hvcCh4LCB5LCBjb2xvciwgZ2FtZSkge1xuICBQaWVjZS5jYWxsKHRoaXMsIHgsIHksIFBJRUNFX0NIQVJTLmJpc2hvcCwgY29sb3IsIGdhbWUsICdiaXNob3AnKTtcbn1cblxuQmlzaG9wLnByb3RvdHlwZSA9IFBpZWNlLmVtcHR5KCk7XG5CaXNob3AucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoc2ltdWxhdGUpIHtcbiAgdmFyIGdhbWUgPSB0aGlzLmdhbWU7XG4gIHZhciBtb3ZlcyA9IFtdO1xuXG4gIFtbLTEsIC0xXSwgWzEsIDFdLCBbLTEsIDFdLCBbMSwgLTFdXS5mb3JFYWNoKGZ1bmN0aW9uIChjb2VmKSB7XG4gICAgdmFyIGluZGV4LCB4LCB5LCBwaWVjZTtcbiAgICBmb3IgKGluZGV4ID0gMTs7IGluZGV4KyspIHtcbiAgICAgIHggPSB0aGlzLnggKyBjb2VmWzBdICogaW5kZXg7XG4gICAgICB5ID0gdGhpcy55ICsgY29lZlsxXSAqIGluZGV4O1xuICAgICAgaWYgKHkgPCAwIHx8IHkgPiA3IHx8IHggPCAwIHx8IHggPiA3KSBicmVhaztcblxuICAgICAgcGllY2UgPSBnYW1lLmJvYXJkW3ldW3hdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSB0aGlzLmNvbG9yKSBicmVhaztcblxuICAgICAgbW92ZXMucHVzaCh7IHg6IHgsIHk6IHkgfSk7XG4gICAgICBpZiAocGllY2UpIGJyZWFrO1xuICAgIH1cbiAgfSwgdGhpcyk7XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2UuYmlzaG9wID0gZnVuY3Rpb24gKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIHJldHVybiBuZXcgQmlzaG9wKHgsIHksIGNvbG9yLCBnYW1lKTtcbn07XG5cbi8vIC8vXG5cbmZ1bmN0aW9uIFF1ZWVuKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMucXVlZW4sIGNvbG9yLCBnYW1lLCAncXVlZW4nKTtcbn1cblxuUXVlZW4ucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcblF1ZWVuLnByb3RvdHlwZS5nZXRWYWxpZE1vdmVzID0gZnVuY3Rpb24gKHNpbXVsYXRlKSB7XG4gIHZhciBnYW1lID0gdGhpcy5nYW1lO1xuICB2YXIgcm9va01vdmVzID0gUm9vay5wcm90b3R5cGUuZ2V0VmFsaWRNb3Zlcy5jYWxsKHRoaXMpO1xuICB2YXIgYmlzaG9wTW92ZXMgPSBCaXNob3AucHJvdG90eXBlLmdldFZhbGlkTW92ZXMuY2FsbCh0aGlzKTtcbiAgdmFyIG1vdmVzID0gcm9va01vdmVzLmNvbmNhdChiaXNob3BNb3Zlcyk7XG5cbiAgdmFyIHZhbGlkTW92ZXMgPSBbXTtcbiAgaWYgKHNpbXVsYXRlKSB7XG4gICAgdmFsaWRNb3ZlcyA9IGdhbWUuc2ltdWxhdGVBbmRGaWx0ZXIobW92ZXMsIHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkTW92ZXMgPSBtb3ZlcztcbiAgfVxuXG4gIHJldHVybiB2YWxpZE1vdmVzO1xufTtcblxuUGllY2UucXVlZW4gPSBmdW5jdGlvbiAoeCwgeSwgY29sb3IsIGdhbWUpIHtcbiAgcmV0dXJuIG5ldyBRdWVlbih4LCB5LCBjb2xvciwgZ2FtZSk7XG59O1xuXG4vLyAvL1xuXG5mdW5jdGlvbiBLaW5nKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIFBpZWNlLmNhbGwodGhpcywgeCwgeSwgUElFQ0VfQ0hBUlMua2luZywgY29sb3IsIGdhbWUsICdraW5nJyk7XG59XG5cbktpbmcucHJvdG90eXBlID0gUGllY2UuZW1wdHkoKTtcbktpbmcucHJvdG90eXBlLmdldFZhbGlkTW92ZXMgPSBmdW5jdGlvbiAoc2ltdWxhdGUpIHtcbiAgdmFyIG1vdmVzID0gW107XG4gIHZhciBjb29yZGluYXRlcyA9IFtbMCwgMV0sIFswLCAtMV0sIFsxLCAxXSwgWy0xLCAtMV0sIFsxLCAtMV0sIFstMSwgMV0sIFstMSwgMF0sIFsxLCAwXV07XG4gIHZhciB4ID0gdGhpcy54O1xuICB2YXIgeSA9IHRoaXMueTtcbiAgdmFyIGdhbWUgPSB0aGlzLmdhbWU7XG4gIHZhciB0dXJuID0gZ2FtZS50dXJuO1xuICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgY29vcmRpbmF0ZXMuZm9yRWFjaChmdW5jdGlvbiAoY29vcmQpIHtcbiAgICB2YXIgcGllY2U7XG4gICAgdmFyIHh4ID0geCArIGNvb3JkWzBdO1xuICAgIHZhciB5eSA9IHkgKyBjb29yZFsxXTtcblxuICAgIGlmICh4eCA8IDggJiYgeHggPj0gMCAmJiB5eSA8IDggJiYgeXkgPj0gMCkge1xuICAgICAgcGllY2UgPSBnYW1lLmJvYXJkW3l5XVt4eF07XG4gICAgICBpZiAoIXBpZWNlIHx8IHBpZWNlLmNvbG9yICE9PSBzZWxmLmNvbG9yKSB7XG4gICAgICAgIG1vdmVzLnB1c2goeyB4OiB4eCwgeTogeXkgfSk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICAvLyBDaGVjayBraW5nIGhhc24ndCBtb3ZlZFxuICB2YXIga2luZ01vdmVkID0gdHVybi5zb21lKGZ1bmN0aW9uICh0dXJuKSB7XG4gICAgcmV0dXJuIHR1cm4udHlwZSA9PT0gJ2tpbmcnICYmIHR1cm4uY29sb3IgPT09IHNlbGYuY29sb3I7XG4gIH0pO1xuXG4gIGlmICgha2luZ01vdmVkKSB7XG4gICAgW1swLCAyLCAtMV0sIFs3LCA2LCArMV1dLmZvckVhY2goZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgICB2YXIgcm9va1ggPSBwcm9wc1swXTtcbiAgICAgIHZhciBuZXdLaW5nWCA9IHByb3BzWzFdO1xuICAgICAgdmFyIGRpciA9IHByb3BzWzJdO1xuICAgICAgdmFyIHJvb2sgPSBnYW1lLmJvYXJkW3ldW3Jvb2tYXTtcblxuICAgICAgLy8gQ2hlY2sgcm9vayBvbiBwb3NpdGlvblxuICAgICAgaWYgKCFyb29rIHx8ICFyb29rLnR5cGUgPT09ICdyb29rJykgcmV0dXJuO1xuXG4gICAgICAvLyBDaGVjayByb29rIGhhc24ndCBtb3ZlZFxuICAgICAgaWYgKHR1cm4uc29tZShmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgcmV0dXJuIGV2LmZyb20ueCA9PT0gcm9va1ggJiYgZXYuZnJvbS55ID09PSB5O1xuICAgICAgfSkpIHJldHVybjtcblxuICAgICAgLy8gQ2hlY2sgc3F1YXJlcyBlbXB0eSBhbmQgc2FmZVxuICAgICAgZm9yICh2YXIgeHggPSB4ICsgZGlyOyB4eCAhPT0gcm9va1g7IHh4ICs9IGRpcikge1xuICAgICAgICBpZiAoZ2FtZS5ib2FyZFt5XVt4eF0pIHJldHVybjtcbiAgICAgICAgdmFyIHNhZmUgPSB0cnVlO1xuICAgICAgICBnYW1lLmJvYXJkLmZvckVhY2goZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgZXYuZm9yRWFjaChmdW5jdGlvbiAoZXZ2KSB7XG4gICAgICAgICAgICBpZiAoZXZ2ICYmIGV2di50eXBlICE9PSAna2luZycgJiYgZXZ2LmNvbG9yICE9PSBzZWxmLmNvbG9yKSB7XG4gICAgICAgICAgICAgIGV2di5nZXRWYWxpZE1vdmVzKCkuZm9yRWFjaChmdW5jdGlvbiAoZXZNb3ZlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV2TW92ZSAmJiBldk1vdmUueSA9PT0geSAmJiBldk1vdmUueCA9PT0geHgpIHNhZmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXNhZmUpIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHJvY2hhZGUgPSB7XG4gICAgICAgIHg6IG5ld0tpbmdYLFxuICAgICAgICB5OiB5LFxuICAgICAgICBtb3ZlUGllY2U6IHtcbiAgICAgICAgICBwaWVjZTogc2VsZi5nYW1lLmJvYXJkW3ldW3Jvb2tYXSxcbiAgICAgICAgICBmcm9tOiB7XG4gICAgICAgICAgICB4OiByb29rWCwgeTogeVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdG86IHtcbiAgICAgICAgICAgIHk6IHksIHg6IHggKyBkaXJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIG1vdmVzLnB1c2gocm9jaGFkZSk7XG4gICAgfSk7XG4gIH1cblxuICB2YXIgdmFsaWRNb3ZlcyA9IFtdO1xuICBpZiAoc2ltdWxhdGUpIHtcbiAgICB2YWxpZE1vdmVzID0gZ2FtZS5zaW11bGF0ZUFuZEZpbHRlcihtb3Zlcywgc2VsZik7XG4gIH0gZWxzZSB7XG4gICAgdmFsaWRNb3ZlcyA9IG1vdmVzO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkTW92ZXM7XG59O1xuXG5QaWVjZS5raW5nID0gZnVuY3Rpb24gKHgsIHksIGNvbG9yLCBnYW1lKSB7XG4gIHJldHVybiBuZXcgS2luZyh4LCB5LCBjb2xvciwgZ2FtZSk7XG59O1xuXG5leHBvcnRzLlBpZWNlID0gUGllY2U7XG5leHBvcnRzLlBhd24gPSBQYXduO1xuZXhwb3J0cy5Sb29rID0gUm9vaztcbmV4cG9ydHMuS25pZ2h0ID0gS25pZ2h0O1xuZXhwb3J0cy5CaXNob3AgPSBCaXNob3A7XG5leHBvcnRzLlF1ZWVuID0gUXVlZW47XG5leHBvcnRzLktpbmcgPSBLaW5nO1xuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9nYW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxudmFyIF9nYW1lMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dhbWUpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgQ2hlc3NBSSA9IGZ1bmN0aW9uIENoZXNzQUkoZGVwdGgsIGdhbWVTdGF0ZSwgaXNNYXhpbWlzaW5nUGxheWVyKSB7XG4gIC8vIENsb25lIHRoZSBnYW1lU3RhdGUgdG8gYWNjZXNzIGFsbCBnYW1lIGFzc29jaWF0ZWQgbWV0aG9kcy5cbiAgLy8gVGhpcyB1c3VhbGx5IGRvZXNuJ3QgbWFrZSBzZW5zZSwgYnV0IHNvbWV0aW1lcyB5b3UgY2Fubm90IHBvc3QgZnVuY3Rpb25zIHRvIGEgYmFja2VuZCBvciBhIHdlYi13b3JrZXJcbiAgLy8gYW5kIHRoYXQncyB3aHkgd2UncmUgdG91Y2hpbmcgdGhlIGdhbWUgbWV0aG9kcyBmcm9tIG5ldyBnYW1lIGNvbmZpZ3VyYXRpb24gaW50ZWFkIGZyb20gdGhlIHBhc3NlZCBhcmd1bWVudC5cbiAgLy8gU28gaWYgeW91IHBhc3Mge2JvYXJkOiBbbXlCb2FyZF0sIHR1cm46W215VHVybl0sLi4ufSBmb3IgdGhlIGdhbWUgYXJndW1lbnQgaXQgd2lsbCBhY3R1YWxseSB3b3JrIVxuICAvLyBBbHJlYWR5IGRlc2NyaWJlZCBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vUlNHLUdyb3VwL0NoZXNzL2lzc3Vlcy84I2lzc3VlY29tbWVudC0zODEyNDU3OTRcbiAgdmFyIGdhbWUgPSBfZ2FtZTIuZGVmYXVsdC5wcm90b3R5cGUuaW5pdGlhbGl6ZUdhbWUoKTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICBpZiAoZ2FtZVN0YXRlLmJvYXJkW2ldW2pdKSB7XG4gICAgICAgIHZhciBjdXJyZW50Q2VsbCA9IGdhbWVTdGF0ZS5ib2FyZFtpXVtqXTtcbiAgICAgICAgZ2FtZS5waWVjZShjdXJyZW50Q2VsbC50eXBlLCBqLCBpLCBjdXJyZW50Q2VsbC5jb2xvcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBnYW1lLmJvYXJkW2ldW2pdID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnYW1lLnR1cm4gPSBnYW1lU3RhdGUudHVybjtcbiAgZ2FtZS50aHJlZWZvbGQgPSBnYW1lU3RhdGUudGhyZWVmb2xkO1xuICBnYW1lLkZFTiA9IGdhbWVTdGF0ZS5GRU47XG4gIGdhbWUuRkVOYm9hcmQgPSBnYW1lU3RhdGUuRkVOYm9hcmQ7XG5cbiAgLy8gU3RhcnQgbG9vcGluZyBhbmQgc2ltdWxhdGluZyBhbGwgdmFsaWQgbW92ZXNcbiAgdmFyIGFsbE1vdmVzID0gZ2FtZS5hbGxNb3ZlcygpO1xuICB2YXIgYmVzdFZhbHVlID0gLTk5OTk7XG4gIHZhciBiZXN0TW92ZTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbE1vdmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIG5ld0dhbWVNb3ZlID0gYWxsTW92ZXNbaV07XG4gICAgdmFyIHVuZG8gPSBnYW1lLnNpbXBsZU1vdmUobmV3R2FtZU1vdmUpO1xuICAgIHZhciBib3JhZFZhbHVlID0gbWluaW1heChkZXB0aCAtIDEsIGdhbWUsIC0xMDAwMCwgMTAwMDAsICFpc01heGltaXNpbmdQbGF5ZXIpO1xuICAgIHVuZG8oKTtcbiAgICBpZiAoYm9yYWRWYWx1ZSA+PSBiZXN0VmFsdWUpIHtcbiAgICAgIGJlc3RWYWx1ZSA9IGJvcmFkVmFsdWU7XG4gICAgICBiZXN0TW92ZSA9IG5ld0dhbWVNb3ZlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gYmVzdE1vdmU7XG59OyAvL1xuLy8gUlNHIENoZXNzXG4vLyBMaWNlbnNlZCB1bmRlciBBcGFjaGUgMi4wIExJQ0VOU0VcblxudmFyIG1pbmltYXggPSBmdW5jdGlvbiBtaW5pbWF4KGRlcHRoLCBnYW1lLCBhbHBoYSwgYmV0YSwgaXNNYXhpbWlzaW5nUGxheWVyKSB7XG4gIGlmIChkZXB0aCA9PT0gMCkge1xuICAgIHJldHVybiAtZXZhbHVhdGVCb2FyZChnYW1lLmJvYXJkKTtcbiAgfVxuXG4gIHZhciBhbGxNb3ZlcyA9IGdhbWUuYWxsTW92ZXMoKTtcbiAgaWYgKGlzTWF4aW1pc2luZ1BsYXllcikge1xuICAgIHZhciBiZXN0VmFsdWUgPSAtOTk5OTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbE1vdmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdW5kbyA9IGdhbWUuc2ltcGxlTW92ZShhbGxNb3Zlc1tpXSk7XG4gICAgICBiZXN0VmFsdWUgPSBNYXRoLm1heChiZXN0VmFsdWUsIG1pbmltYXgoZGVwdGggLSAxLCBnYW1lLCBhbHBoYSwgYmV0YSwgIWlzTWF4aW1pc2luZ1BsYXllcikpO1xuICAgICAgdW5kbygpO1xuICAgICAgYWxwaGEgPSBNYXRoLm1heChhbHBoYSwgYmVzdFZhbHVlKTtcbiAgICAgIGlmIChiZXRhIDw9IGFscGhhKSB7XG4gICAgICAgIHJldHVybiBiZXN0VmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBiZXN0VmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgdmFyIF9iZXN0VmFsdWUgPSA5OTk5O1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhbGxNb3Zlcy5sZW5ndGg7IF9pKyspIHtcbiAgICAgIHZhciBfdW5kbyA9IGdhbWUuc2ltcGxlTW92ZShhbGxNb3Zlc1tfaV0pO1xuICAgICAgX2Jlc3RWYWx1ZSA9IE1hdGgubWluKF9iZXN0VmFsdWUsIG1pbmltYXgoZGVwdGggLSAxLCBnYW1lLCBhbHBoYSwgYmV0YSwgIWlzTWF4aW1pc2luZ1BsYXllcikpO1xuICAgICAgX3VuZG8oKTtcbiAgICAgIGJldGEgPSBNYXRoLm1pbihiZXRhLCBfYmVzdFZhbHVlKTtcbiAgICAgIGlmIChiZXRhIDw9IGFscGhhKSB7XG4gICAgICAgIHJldHVybiBfYmVzdFZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gX2Jlc3RWYWx1ZTtcbiAgfVxufTtcblxudmFyIGV2YWx1YXRlQm9hcmQgPSBmdW5jdGlvbiBldmFsdWF0ZUJvYXJkKGJvYXJkKSB7XG4gIHZhciB0b3RhbEV2YWx1YXRpb24gPSAwO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XG4gICAgICAvLyBjYWxjdWxhdGUgdGhlIGN1cnJlbnQgZXZhbHVhdGlvblxuICAgICAgdG90YWxFdmFsdWF0aW9uID0gdG90YWxFdmFsdWF0aW9uICsgZ2V0UGllY2VWYWx1ZShib2FyZFtpXVtqXSk7XG4gICAgfVxuICB9XG4gIC8vIHJldHVybiB0aGUgdG90YWwgZXZhbHVhdGlvblxuICByZXR1cm4gdG90YWxFdmFsdWF0aW9uO1xufTtcblxudmFyIGdldFBpZWNlVmFsdWUgPSBmdW5jdGlvbiBnZXRQaWVjZVZhbHVlKHBpZWNlKSB7XG4gIGlmIChwaWVjZSA9PT0gbnVsbCkge1xuICAgIHJldHVybiAwO1xuICB9XG5cbiAgLy8gZ2V0IHZhbHVlIGZvciBldmVyeSBwaWVjZSBvbiB0aGUgYm9hcmRcbiAgdmFyIGdldEFic29sdXRlVmFsdWUgPSBmdW5jdGlvbiBnZXRBYnNvbHV0ZVZhbHVlKHBpZWNlKSB7XG4gICAgaWYgKHBpZWNlLnR5cGUgPT09ICdwYXduJykge1xuICAgICAgcmV0dXJuIDEwO1xuICAgIH0gZWxzZSBpZiAocGllY2UudHlwZSA9PT0gJ3Jvb2snKSB7XG4gICAgICByZXR1cm4gNTA7XG4gICAgfSBlbHNlIGlmIChwaWVjZS50eXBlID09PSAna25pZ2h0Jykge1xuICAgICAgcmV0dXJuIDMwO1xuICAgIH0gZWxzZSBpZiAocGllY2UudHlwZSA9PT0gJ2Jpc2hvcCcpIHtcbiAgICAgIHJldHVybiAzMDtcbiAgICB9IGVsc2UgaWYgKHBpZWNlLnR5cGUgPT09ICdxdWVlbicpIHtcbiAgICAgIHJldHVybiA5MDtcbiAgICB9IGVsc2UgaWYgKHBpZWNlLnR5cGUgPT09ICdraW5nJykge1xuICAgICAgcmV0dXJuIDkwMDtcbiAgICB9XG4gIH07XG5cbiAgLy8gY2FsY3VsYXRlIHRoZSBhYnNvbHV0ZSB2YWx1ZSBhbmQgcmV0dXJuIGl0XG4gIHZhciBhYnNvbHV0ZVZhbHVlID0gZ2V0QWJzb2x1dGVWYWx1ZShwaWVjZSwgcGllY2UuY29sb3IgPT09ICdXJyk7XG4gIHJldHVybiBwaWVjZS5jb2xvciA9PT0gJ1cnID8gYWJzb2x1dGVWYWx1ZSA6IC1hYnNvbHV0ZVZhbHVlO1xufTtcblxuLy8gZXhwb3J0IHRoZSBhbGdvcml0aG1cbmV4cG9ydHMuZGVmYXVsdCA9IENoZXNzQUk7XG5cbi8vIFdyaXR0ZW4gYnkgUmFkaSBDaG9cbi8vIFJTRyBDaGVzcyAtIGJ5IFJTRyBHcm91cFxuXG4vKioqLyB9KSxcbi8qIDMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuQUkgPSBleHBvcnRzLlBpZWNlcyA9IGV4cG9ydHMuR2FtZSA9IHVuZGVmaW5lZDtcblxudmFyIF9nYW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxudmFyIF9nYW1lMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dhbWUpO1xuXG52YXIgX3BpZWNlcyA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cbnZhciBQaWVjZXMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfcGllY2VzKTtcblxudmFyIF9BSSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cbnZhciBfQUkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQUkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfVxuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vLyBBbmQgZXhwb3J0Li4uXG5leHBvcnRzLkdhbWUgPSBfZ2FtZTIuZGVmYXVsdDtcbmV4cG9ydHMuUGllY2VzID0gUGllY2VzO1xuZXhwb3J0cy5BSSA9IF9BSTIuZGVmYXVsdDsgLy8gTGV0J3MgaW1wb3J0Li4uXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvcnNnLWNoZXNzL2xpYi9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9